<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.15.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>BMCU370 Firmware: KlipperCLI Namespace Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="clipboard.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">BMCU370 Firmware
   </div>
   <div id="projectbrief">Modified BMCU-C 370 Hall firmware</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.15.0 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search/",'.html');
</script>
<script type="text/javascript">
$(function() { codefold.init(); });
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search',true);
  $(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(function(){initNavTree('namespace_klipper_c_l_i.html','',''); });
</script>
<div id="container">
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="headertitle"><div class="title">KlipperCLI Namespace Reference</div></div>
</div><!--header-->
<div class="contents">
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 id="header-func-members" class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a9ec392d53485800126189969c2c4981a" id="r_a9ec392d53485800126189969c2c4981a"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a9ec392d53485800126189969c2c4981a">SendResponse</a> (JsonDocument &amp;d)</td></tr>
<tr class="memdesc:a9ec392d53485800126189969c2c4981a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Serialize and send a JSON response.  <br /></td></tr>
<tr class="memitem:ad0e99d2fdcfd1c0690f850816ac1f67c" id="r_ad0e99d2fdcfd1c0690f850816ac1f67c"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ad0e99d2fdcfd1c0690f850816ac1f67c">SendError</a> (int id, const char *code, const char *msg)</td></tr>
<tr class="memdesc:ad0e99d2fdcfd1c0690f850816ac1f67c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Helper to send an Error response.  <br /></td></tr>
<tr class="memitem:a1d7d7986d99cb52ab4feb4826ffc4428" id="r_a1d7d7986d99cb52ab4feb4826ffc4428"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a1d7d7986d99cb52ab4feb4826ffc4428">SendOk</a> (int id, const char *code=nullptr, const char *msg=nullptr)</td></tr>
<tr class="memdesc:a1d7d7986d99cb52ab4feb4826ffc4428"><td class="mdescLeft">&#160;</td><td class="mdescRight">Helper to send a Success (OK) response.  <br /></td></tr>
<tr class="memitem:a81f1646e6adb42482d4109a33b9bb9c5" id="r_a81f1646e6adb42482d4109a33b9bb9c5"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a81f1646e6adb42482d4109a33b9bb9c5">HandlePing</a> (int id, JsonObject args)</td></tr>
<tr class="memdesc:a81f1646e6adb42482d4109a33b9bb9c5"><td class="mdescLeft">&#160;</td><td class="mdescRight">Handler for PING command.  <br /></td></tr>
<tr class="memitem:a8f239072c1896e64e9f6075edaaea515" id="r_a8f239072c1896e64e9f6075edaaea515"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a8f239072c1896e64e9f6075edaaea515">HandleStatus</a> (int id, JsonObject args)</td></tr>
<tr class="memdesc:a8f239072c1896e64e9f6075edaaea515"><td class="mdescLeft">&#160;</td><td class="mdescRight">Handler for STATUS command.  <br /></td></tr>
<tr class="memitem:ae13dcd8cc2528c12d0a241046fcc304e" id="r_ae13dcd8cc2528c12d0a241046fcc304e"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ae13dcd8cc2528c12d0a241046fcc304e">HandleGetSensors</a> (int id, JsonObject args)</td></tr>
<tr class="memdesc:ae13dcd8cc2528c12d0a241046fcc304e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Handler for GET_SENSORS command.  <br /></td></tr>
<tr class="memitem:a12cef4b97fbfa7cfb7bdb1540e626ae9" id="r_a12cef4b97fbfa7cfb7bdb1540e626ae9"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a12cef4b97fbfa7cfb7bdb1540e626ae9">HandleMove</a> (int id, JsonObject args)</td></tr>
<tr class="memdesc:a12cef4b97fbfa7cfb7bdb1540e626ae9"><td class="mdescLeft">&#160;</td><td class="mdescRight">Handler for MOVE command.  <br /></td></tr>
<tr class="memitem:a5bc1dda1e0b24dccb6fdc1c475930c88" id="r_a5bc1dda1e0b24dccb6fdc1c475930c88"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a5bc1dda1e0b24dccb6fdc1c475930c88">HandleStop</a> (int id, JsonObject args)</td></tr>
<tr class="memdesc:a5bc1dda1e0b24dccb6fdc1c475930c88"><td class="mdescLeft">&#160;</td><td class="mdescRight">Handler for STOP command.  <br /></td></tr>
<tr class="memitem:a685b6d688593b458b5edafda4adfd4d4" id="r_a685b6d688593b458b5edafda4adfd4d4"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a685b6d688593b458b5edafda4adfd4d4">HandleSelectLane</a> (int id, JsonObject args)</td></tr>
<tr class="memdesc:a685b6d688593b458b5edafda4adfd4d4"><td class="mdescLeft">&#160;</td><td class="mdescRight">Handler for SELECT_LANE command.  <br /></td></tr>
<tr class="memitem:a31ef4dae129916b85fdd8d1612553c77" id="r_a31ef4dae129916b85fdd8d1612553c77"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a31ef4dae129916b85fdd8d1612553c77">HandleSetAutoFeed</a> (int id, JsonObject args)</td></tr>
<tr class="memdesc:a31ef4dae129916b85fdd8d1612553c77"><td class="mdescLeft">&#160;</td><td class="mdescRight">Handler for SET_AUTO_FEED command.  <br /></td></tr>
<tr class="memitem:afeb304003d4b85010afd5e183e1bbf16" id="r_afeb304003d4b85010afd5e183e1bbf16"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#afeb304003d4b85010afd5e183e1bbf16">HandleGetFilamentInfo</a> (int id, JsonObject args)</td></tr>
<tr class="memdesc:afeb304003d4b85010afd5e183e1bbf16"><td class="mdescLeft">&#160;</td><td class="mdescRight">Handler for GET_FILAMENT_INFO command.  <br /></td></tr>
<tr class="memitem:a76547f35e246989843f1870c760ea514" id="r_a76547f35e246989843f1870c760ea514"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a76547f35e246989843f1870c760ea514">HandleSetFilamentInfo</a> (int id, JsonObject args)</td></tr>
<tr class="memdesc:a76547f35e246989843f1870c760ea514"><td class="mdescLeft">&#160;</td><td class="mdescRight">Handler for SET_FILAMENT_INFO command.  <br /></td></tr>
<tr class="memitem:a6089e6db2e7edddf19fdf095b9826c88" id="r_a6089e6db2e7edddf19fdf095b9826c88"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a6089e6db2e7edddf19fdf095b9826c88">ProcessPacket</a> (char *json_str)</td></tr>
<tr class="memdesc:a6089e6db2e7edddf19fdf095b9826c88"><td class="mdescLeft">&#160;</td><td class="mdescRight">Parse and Dispatch a JSON Packet.  <br /></td></tr>
<tr class="memitem:a5498861593ca8083d7be1d71c8373f29" id="r_a5498861593ca8083d7be1d71c8373f29"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a5498861593ca8083d7be1d71c8373f29">Init</a> ()</td></tr>
<tr class="memdesc:a5498861593ca8083d7be1d71c8373f29"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initialize Klipper CLI.  <br /></td></tr>
<tr class="memitem:afe96c8a3898aa7a50f68ab6d726860c3" id="r_afe96c8a3898aa7a50f68ab6d726860c3"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#afe96c8a3898aa7a50f68ab6d726860c3">Run</a> ()</td></tr>
<tr class="memdesc:afe96c8a3898aa7a50f68ab6d726860c3"><td class="mdescLeft">&#160;</td><td class="mdescRight">Main Execution Loop.  <br /></td></tr>
<tr class="memitem:a94936a207238747445fb8f43cdd4a2f4" id="r_a94936a207238747445fb8f43cdd4a2f4"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a94936a207238747445fb8f43cdd4a2f4">FeedByte</a> (uint8_t b)</td></tr>
<tr class="memdesc:a94936a207238747445fb8f43cdd4a2f4"><td class="mdescLeft">&#160;</td><td class="mdescRight">Feed a byte into the RX buffer.  <br /></td></tr>
<tr class="memitem:a64e906ee320307e1634a6bad079e2657" id="r_a64e906ee320307e1634a6bad079e2657"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a64e906ee320307e1634a6bad079e2657">IsConnected</a> ()</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 id="header-var-members" class="groupheader"><a id="var-members" name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:a5340c0df3b2af2c3a791cc11f143bbf2" id="r_a5340c0df3b2af2c3a791cc11f143bbf2"><td class="memItemLeft" align="right" valign="top">static char&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a5340c0df3b2af2c3a791cc11f143bbf2">rx_buffer</a> [1024]</td></tr>
<tr class="memitem:a932aad58ea2cbdf8a45a6835825b21a2" id="r_a932aad58ea2cbdf8a45a6835825b21a2"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a932aad58ea2cbdf8a45a6835825b21a2">rx_idx</a> = 0</td></tr>
<tr class="memitem:adf80752c24e066ed02f3864069ff9707" id="r_adf80752c24e066ed02f3864069ff9707"><td class="memItemLeft" align="right" valign="top">static JsonDocument&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#adf80752c24e066ed02f3864069ff9707">doc</a></td></tr>
<tr class="memitem:ad3e5a754ec9f201484a7aacea2f41961" id="r_ad3e5a754ec9f201484a7aacea2f41961"><td class="memItemLeft" align="right" valign="top">static volatile bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ad3e5a754ec9f201484a7aacea2f41961">packet_ready</a> = false</td></tr>
</table>
<a name="doc-func-members" id="doc-func-members"></a><h2 id="header-doc-func-members" class="groupheader">Function Documentation</h2>
<a id="a94936a207238747445fb8f43cdd4a2f4" name="a94936a207238747445fb8f43cdd4a2f4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a94936a207238747445fb8f43cdd4a2f4">&#9670;&#160;</a></span>FeedByte()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void KlipperCLI::FeedByte </td>
          <td>(</td>
          <td class="paramtype">uint8_t</td>          <td class="paramname"><span class="paramname"><em>b</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Feed a byte into the RX buffer. </p>
<p>Accumlates bytes until a newline is found.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">b</td><td>Byte to append. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="_klipper_c_l_i_8cpp_source.html#l00467">467</a> of file <a class="el" href="_klipper_c_l_i_8cpp_source.html">KlipperCLI.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  467</span>                             {</div>
<div class="line"><span class="lineno">  468</span>        <span class="comment">// Prevent buffer overrun</span></div>
<div class="line"><span class="lineno">  469</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="#ad3e5a754ec9f201484a7aacea2f41961">packet_ready</a>) <span class="keywordflow">return</span>; </div>
<div class="line"><span class="lineno">  470</span> </div>
<div class="line"><span class="lineno">  471</span>        <span class="keywordflow">if</span> (b == <span class="charliteral">&#39;\n&#39;</span> || b == <span class="charliteral">&#39;\r&#39;</span>) {</div>
<div class="line"><span class="lineno">  472</span>             <span class="keywordflow">if</span> (<a class="code hl_variable" href="#a932aad58ea2cbdf8a45a6835825b21a2">rx_idx</a> &gt; 0) {</div>
<div class="line"><span class="lineno">  473</span>                 <a class="code hl_variable" href="#a5340c0df3b2af2c3a791cc11f143bbf2">rx_buffer</a>[<a class="code hl_variable" href="#a932aad58ea2cbdf8a45a6835825b21a2">rx_idx</a>] = <span class="charliteral">&#39;\0&#39;</span>;</div>
<div class="line"><span class="lineno">  474</span>                 <a class="code hl_variable" href="#ad3e5a754ec9f201484a7aacea2f41961">packet_ready</a> = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno">  475</span>             }</div>
<div class="line"><span class="lineno">  476</span>             <span class="comment">// Ignore empty lines (e.g. \r then \n)</span></div>
<div class="line"><span class="lineno">  477</span>        } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  478</span>            <span class="keywordflow">if</span> (<a class="code hl_variable" href="#a932aad58ea2cbdf8a45a6835825b21a2">rx_idx</a> &lt; 1023) {</div>
<div class="line"><span class="lineno">  479</span>                <a class="code hl_variable" href="#a5340c0df3b2af2c3a791cc11f143bbf2">rx_buffer</a>[<a class="code hl_variable" href="#a932aad58ea2cbdf8a45a6835825b21a2">rx_idx</a>++] = (char)b;</div>
<div class="line"><span class="lineno">  480</span>            } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  481</span>                <a class="code hl_variable" href="#a932aad58ea2cbdf8a45a6835825b21a2">rx_idx</a> = 0; <span class="comment">// Overflow reset</span></div>
<div class="line"><span class="lineno">  482</span>            }</div>
<div class="line"><span class="lineno">  483</span>        }</div>
<div class="line"><span class="lineno">  484</span>    }</div>
<div class="ttc" id="anamespace_klipper_c_l_i_html_a5340c0df3b2af2c3a791cc11f143bbf2"><div class="ttname"><a href="#a5340c0df3b2af2c3a791cc11f143bbf2">KlipperCLI::rx_buffer</a></div><div class="ttdeci">static char rx_buffer[1024]</div><div class="ttdef"><b>Definition</b> <a href="_klipper_c_l_i_8cpp_source.html#l00019">KlipperCLI.cpp:19</a></div></div>
<div class="ttc" id="anamespace_klipper_c_l_i_html_a932aad58ea2cbdf8a45a6835825b21a2"><div class="ttname"><a href="#a932aad58ea2cbdf8a45a6835825b21a2">KlipperCLI::rx_idx</a></div><div class="ttdeci">static int rx_idx</div><div class="ttdef"><b>Definition</b> <a href="_klipper_c_l_i_8cpp_source.html#l00020">KlipperCLI.cpp:20</a></div></div>
<div class="ttc" id="anamespace_klipper_c_l_i_html_ad3e5a754ec9f201484a7aacea2f41961"><div class="ttname"><a href="#ad3e5a754ec9f201484a7aacea2f41961">KlipperCLI::packet_ready</a></div><div class="ttdeci">static volatile bool packet_ready</div><div class="ttdef"><b>Definition</b> <a href="_klipper_c_l_i_8cpp_source.html#l00431">KlipperCLI.cpp:431</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="_klipper_c_l_i_8cpp_source.html#l00431">packet_ready</a>, <a class="el" href="_klipper_c_l_i_8cpp_source.html#l00019">rx_buffer</a>, and <a class="el" href="_klipper_c_l_i_8cpp_source.html#l00020">rx_idx</a>.</p>

<p class="reference">Referenced by <a class="el" href="_command_router_8cpp_source.html#l00076">CommandRouter::Init()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespace_klipper_c_l_i_a94936a207238747445fb8f43cdd4a2f4_icgraph.png" border="0" usemap="#anamespace_klipper_c_l_i_a94936a207238747445fb8f43cdd4a2f4_icgraph" loading="lazy" alt=""/></div>
<map name="anamespace_klipper_c_l_i_a94936a207238747445fb8f43cdd4a2f4_icgraph" id="anamespace_klipper_c_l_i_a94936a207238747445fb8f43cdd4a2f4_icgraph">
<area shape="rect" title="Feed a byte into the RX buffer." alt="" coords="301,5,447,32"/>
<area shape="rect" href="namespace_command_router.html#a652cfc164ac7a2a2c016da37f341c42e" title="Initialize the Command Router and CLI subsystems." alt="" coords="107,5,253,32"/>
<area shape="poly" title=" " alt="" coords="283,19,253,21,253,16,288,19"/>
<area shape="rect" href="main_8cpp.html#a4fc01d736fe50cf5b977f755b675f11d" title="Arduino Setup Function." alt="" coords="5,5,59,32"/>
<area shape="poly" title=" " alt="" coords="89,19,59,21,59,16,94,18"/>
</map>
</div>

</div>
</div>
<a id="afeb304003d4b85010afd5e183e1bbf16" name="afeb304003d4b85010afd5e183e1bbf16"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afeb304003d4b85010afd5e183e1bbf16">&#9670;&#160;</a></span>HandleGetFilamentInfo()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void KlipperCLI::HandleGetFilamentInfo </td>
          <td>(</td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>id</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">JsonObject</td>          <td class="paramname"><span class="paramname"><em>args</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Handler for GET_FILAMENT_INFO command. </p>
<p>Returns metadata for a specific lane. </p>

<p class="definition">Definition at line <a class="el" href="_klipper_c_l_i_8cpp_source.html#l00305">305</a> of file <a class="el" href="_klipper_c_l_i_8cpp_source.html">KlipperCLI.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  305</span>                                                        {</div>
<div class="line"><span class="lineno">  306</span>         <span class="keywordflow">if</span>(!args[<span class="stringliteral">&quot;lane&quot;</span>].is&lt;int&gt;()) { <a class="code hl_function" href="#ad0e99d2fdcfd1c0690f850816ac1f67c">SendError</a>(<span class="keywordtype">id</span>, <span class="stringliteral">&quot;BAD_ARGS&quot;</span>, <span class="stringliteral">&quot;Missing lane&quot;</span>); <span class="keywordflow">return</span>; }</div>
<div class="line"><span class="lineno">  307</span>         <span class="keywordtype">int</span> lane = args[<span class="stringliteral">&quot;lane&quot;</span>];</div>
<div class="line"><span class="lineno">  308</span>         <span class="keywordflow">if</span>(lane &lt; 0 || lane &gt;= 4) { <a class="code hl_function" href="#ad0e99d2fdcfd1c0690f850816ac1f67c">SendError</a>(<span class="keywordtype">id</span>, <span class="stringliteral">&quot;BAD_ARGS&quot;</span>, <span class="stringliteral">&quot;Invalid lane&quot;</span>); <span class="keywordflow">return</span>; }</div>
<div class="line"><span class="lineno">  309</span>         </div>
<div class="line"><span class="lineno">  310</span>         FilamentState &amp;f = <a class="code hl_function" href="class_unit_state.html#a221a5d98d4e870c593e5bd5ee6621c4c">UnitState::GetFilament</a>(lane);</div>
<div class="line"><span class="lineno">  311</span>         </div>
<div class="line"><span class="lineno">  312</span>         <span class="keyword">static</span> <span class="keywordtype">char</span> output[1024];</div>
<div class="line"><span class="lineno">  313</span>         <span class="keywordtype">int</span> offset = 0;</div>
<div class="line"><span class="lineno">  314</span>         </div>
<div class="line"><span class="lineno">  315</span>         <span class="comment">// Safe Strings</span></div>
<div class="line"><span class="lineno">  316</span>         <span class="keywordtype">char</span> safe_id[9]; memcpy(safe_id, f.<a class="code hl_variable" href="struct_filament_info.html#a26e0e6218d4a40974be5086c2ac89087">ID</a>, 8); safe_id[8]=0;</div>
<div class="line"><span class="lineno">  317</span>         <span class="keywordtype">char</span> safe_name[21]; memcpy(safe_name, f.<a class="code hl_variable" href="struct_filament_info.html#a5bf1b8820cfc338a0e489064670e6672">name</a>, 20); safe_name[20]=0;</div>
<div class="line"><span class="lineno">  318</span>         </div>
<div class="line"><span class="lineno">  319</span>         <span class="comment">// Color</span></div>
<div class="line"><span class="lineno">  320</span>         <span class="keywordtype">int</span> r = f.<a class="code hl_variable" href="struct_filament_info.html#a49b75d4f9105d90760ca96138c8fcf45">color_R</a>;</div>
<div class="line"><span class="lineno">  321</span>         <span class="keywordtype">int</span> g = f.<a class="code hl_variable" href="struct_filament_info.html#a401880702bfbb50388082ccfc4da0ddd">color_G</a>;</div>
<div class="line"><span class="lineno">  322</span>         <span class="keywordtype">int</span> b = f.<a class="code hl_variable" href="struct_filament_info.html#ab1c9dff383b15c09a2fad0cf6d7e8714">color_B</a>;</div>
<div class="line"><span class="lineno">  323</span>         <span class="keywordtype">int</span> a = f.<a class="code hl_variable" href="struct_filament_info.html#a72997ce70a6852951aac4a8c907e24ac">color_A</a>;</div>
<div class="line"><span class="lineno">  324</span>         </div>
<div class="line"><span class="lineno">  325</span>         <span class="comment">// Manual Float</span></div>
<div class="line"><span class="lineno">  326</span>         <span class="keywordtype">int</span> m_int = (int)f.<a class="code hl_variable" href="struct_filament_state.html#aabba44628ec691809d7b13b94b8a507e">meters</a>;</div>
<div class="line"><span class="lineno">  327</span>         <span class="keywordtype">int</span> m_dec = (int)((f.meters - m_int) * 100);</div>
<div class="line"><span class="lineno">  328</span>         <span class="keywordflow">if</span>(m_dec&lt;0) m_dec = -m_dec;</div>
<div class="line"><span class="lineno">  329</span>         </div>
<div class="line"><span class="lineno">  330</span>         <span class="keywordtype">int</span> p_int = f.pressure / 1000;</div>
<div class="line"><span class="lineno">  331</span>         <span class="keywordtype">int</span> p_dec = f.pressure % 1000;</div>
<div class="line"><span class="lineno">  332</span>         </div>
<div class="line"><span class="lineno">  333</span>         offset += snprintf(output + offset, <span class="keyword">sizeof</span>(output) - offset,</div>
<div class="line"><span class="lineno">  334</span>             <span class="stringliteral">&quot;{\&quot;id\&quot;:%d,\&quot;cmd\&quot;:\&quot;GET_FILAMENT_INFO\&quot;,\&quot;ok\&quot;:true,\&quot;info\&quot;:{\&quot;lane\&quot;:%d,\&quot;id_str\&quot;:\&quot;%s\&quot;,\&quot;name\&quot;:\&quot;%s\&quot;,\&quot;temp_min\&quot;:%d,\&quot;temp_max\&quot;:%d,\&quot;meters\&quot;:%d.%02d,\&quot;pressure\&quot;:%d.%03d,\&quot;color\&quot;:[%d,%d,%d,%d]}}\r\n&quot;</span>,</div>
<div class="line"><span class="lineno">  335</span>             <span class="keywordtype">id</span>, lane, safe_id, safe_name, f.temperature_min, f.temperature_max, m_int, m_dec, p_int, p_dec, r,g,b,a </div>
<div class="line"><span class="lineno">  336</span>         );</div>
<div class="line"><span class="lineno">  337</span>         </div>
<div class="line"><span class="lineno">  338</span>         <a class="code hl_function" href="namespace_hardware.html#ad3ec7cad074d6d73508844a06a7bea50">Hardware::UART_Send</a>((<span class="keyword">const</span> uint8_t*)output, offset);</div>
<div class="line"><span class="lineno">  339</span>    }</div>
<div class="ttc" id="aclass_unit_state_html_a221a5d98d4e870c593e5bd5ee6621c4c"><div class="ttname"><a href="class_unit_state.html#a221a5d98d4e870c593e5bd5ee6621c4c">UnitState::GetFilament</a></div><div class="ttdeci">static FilamentState &amp; GetFilament(int index)</div><div class="ttdoc">Get the configuration specific to a filament index.</div><div class="ttdef"><b>Definition</b> <a href="_control_logic_8cpp_source.html#l00062">ControlLogic.cpp:62</a></div></div>
<div class="ttc" id="anamespace_hardware_html_ad3ec7cad074d6d73508844a06a7bea50"><div class="ttname"><a href="namespace_hardware.html#ad3ec7cad074d6d73508844a06a7bea50">Hardware::UART_Send</a></div><div class="ttdeci">void UART_Send(const uint8_t *data, uint16_t length)</div><div class="ttdoc">Send a buffer via UART1.</div><div class="ttdef"><b>Definition</b> <a href="_hardware_8cpp_source.html#l00261">Hardware.cpp:261</a></div></div>
<div class="ttc" id="anamespace_klipper_c_l_i_html_ad0e99d2fdcfd1c0690f850816ac1f67c"><div class="ttname"><a href="#ad0e99d2fdcfd1c0690f850816ac1f67c">KlipperCLI::SendError</a></div><div class="ttdeci">void SendError(int id, const char *code, const char *msg)</div><div class="ttdoc">Helper to send an Error response.</div><div class="ttdef"><b>Definition</b> <a href="_klipper_c_l_i_8cpp_source.html#l00056">KlipperCLI.cpp:56</a></div></div>
<div class="ttc" id="astruct_filament_info_html_a26e0e6218d4a40974be5086c2ac89087"><div class="ttname"><a href="struct_filament_info.html#a26e0e6218d4a40974be5086c2ac89087">FilamentInfo::ID</a></div><div class="ttdeci">char ID[8]</div><div class="ttdef"><b>Definition</b> <a href="_unit_state_8h_source.html#l00013">UnitState.h:13</a></div></div>
<div class="ttc" id="astruct_filament_info_html_a401880702bfbb50388082ccfc4da0ddd"><div class="ttname"><a href="struct_filament_info.html#a401880702bfbb50388082ccfc4da0ddd">FilamentInfo::color_G</a></div><div class="ttdeci">uint8_t color_G</div><div class="ttdef"><b>Definition</b> <a href="_unit_state_8h_source.html#l00015">UnitState.h:15</a></div></div>
<div class="ttc" id="astruct_filament_info_html_a49b75d4f9105d90760ca96138c8fcf45"><div class="ttname"><a href="struct_filament_info.html#a49b75d4f9105d90760ca96138c8fcf45">FilamentInfo::color_R</a></div><div class="ttdeci">uint8_t color_R</div><div class="ttdef"><b>Definition</b> <a href="_unit_state_8h_source.html#l00014">UnitState.h:14</a></div></div>
<div class="ttc" id="astruct_filament_info_html_a5bf1b8820cfc338a0e489064670e6672"><div class="ttname"><a href="struct_filament_info.html#a5bf1b8820cfc338a0e489064670e6672">FilamentInfo::name</a></div><div class="ttdeci">char name[20]</div><div class="ttdef"><b>Definition</b> <a href="_unit_state_8h_source.html#l00020">UnitState.h:20</a></div></div>
<div class="ttc" id="astruct_filament_info_html_a72997ce70a6852951aac4a8c907e24ac"><div class="ttname"><a href="struct_filament_info.html#a72997ce70a6852951aac4a8c907e24ac">FilamentInfo::color_A</a></div><div class="ttdeci">uint8_t color_A</div><div class="ttdef"><b>Definition</b> <a href="_unit_state_8h_source.html#l00017">UnitState.h:17</a></div></div>
<div class="ttc" id="astruct_filament_info_html_ab1c9dff383b15c09a2fad0cf6d7e8714"><div class="ttname"><a href="struct_filament_info.html#ab1c9dff383b15c09a2fad0cf6d7e8714">FilamentInfo::color_B</a></div><div class="ttdeci">uint8_t color_B</div><div class="ttdef"><b>Definition</b> <a href="_unit_state_8h_source.html#l00016">UnitState.h:16</a></div></div>
<div class="ttc" id="astruct_filament_state_html_aabba44628ec691809d7b13b94b8a507e"><div class="ttname"><a href="struct_filament_state.html#aabba44628ec691809d7b13b94b8a507e">FilamentState::meters</a></div><div class="ttdeci">float meters</div><div class="ttdef"><b>Definition</b> <a href="_unit_state_8h_source.html#l00047">UnitState.h:47</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="_unit_state_8h_source.html#l00017">FilamentInfo::color_A</a>, <a class="el" href="_unit_state_8h_source.html#l00016">FilamentInfo::color_B</a>, <a class="el" href="_unit_state_8h_source.html#l00015">FilamentInfo::color_G</a>, <a class="el" href="_unit_state_8h_source.html#l00014">FilamentInfo::color_R</a>, <a class="el" href="_control_logic_8cpp_source.html#l00062">UnitState::GetFilament()</a>, <a class="el" href="_unit_state_8h_source.html#l00013">FilamentInfo::ID</a>, <a class="el" href="_unit_state_8h_source.html#l00047">FilamentState::meters</a>, <a class="el" href="_unit_state_8h_source.html#l00020">FilamentInfo::name</a>, <a class="el" href="_unit_state_8h_source.html#l00051">FilamentState::pressure</a>, <a class="el" href="_klipper_c_l_i_8cpp_source.html#l00056">SendError()</a>, <a class="el" href="_unit_state_8h_source.html#l00019">FilamentInfo::temperature_max</a>, <a class="el" href="_unit_state_8h_source.html#l00018">FilamentInfo::temperature_min</a>, and <a class="el" href="_hardware_8cpp_source.html#l00261">Hardware::UART_Send()</a>.</p>

<p class="reference">Referenced by <a class="el" href="_klipper_c_l_i_8cpp_source.html#l00400">ProcessPacket()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespace_klipper_c_l_i_afeb304003d4b85010afd5e183e1bbf16_cgraph.png" border="0" usemap="#anamespace_klipper_c_l_i_afeb304003d4b85010afd5e183e1bbf16_cgraph" loading="lazy" alt=""/></div>
<map name="anamespace_klipper_c_l_i_afeb304003d4b85010afd5e183e1bbf16_cgraph" id="anamespace_klipper_c_l_i_afeb304003d4b85010afd5e183e1bbf16_cgraph">
<area shape="rect" title="Handler for GET_FILAMENT_INFO command." alt="" coords="5,56,230,83"/>
<area shape="rect" href="class_unit_state.html#a221a5d98d4e870c593e5bd5ee6621c4c" title="Get the configuration specific to a filament index." alt="" coords="278,5,433,32"/>
<area shape="poly" title=" " alt="" coords="183,53,277,35,272,37,184,58"/>
<area shape="rect" href="namespace_klipper_c_l_i.html#ad0e99d2fdcfd1c0690f850816ac1f67c" title="Helper to send an Error response." alt="" coords="281,56,430,83"/>
<area shape="poly" title=" " alt="" coords="230,67,268,69,263,70,231,72"/>
<area shape="rect" href="namespace_hardware.html#ad3ec7cad074d6d73508844a06a7bea50" title="Send a buffer via UART1." alt="" coords="708,81,867,108"/>
<area shape="poly" title=" " alt="" coords="191,81,278,92,389,98,501,100,696,99,690,99,501,105,389,103,277,97,191,86"/>
<area shape="rect" href="namespace_klipper_c_l_i.html#a9ec392d53485800126189969c2c4981a" title="Serialize and send a JSON response." alt="" coords="481,56,660,83"/>
<area shape="poly" title=" " alt="" coords="430,67,468,69,463,70,430,72"/>
<area shape="poly" title=" " alt="" coords="661,77,695,84,690,84,661,83"/>
<area shape="rect" href="namespace_hardware.html#a0ada30189b8e1d1dbec145140849b778" title="Microsecond Delay." alt="" coords="1148,81,1286,108"/>
<area shape="poly" title=" " alt="" coords="867,92,1135,95,1130,95,867,97"/>
<area shape="rect" href="namespace_hardware.html#aaaf02ef3df5811e2ba28dd009eadfaae" title="Send a single byte blocking." alt="" coords="915,107,1100,133"/>
<area shape="poly" title=" " alt="" coords="867,101,902,108,896,107,867,106"/>
<area shape="poly" title=" " alt="" coords="1100,106,1130,105,1136,105,1100,111"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespace_klipper_c_l_i_afeb304003d4b85010afd5e183e1bbf16_icgraph.png" border="0" usemap="#anamespace_klipper_c_l_i_afeb304003d4b85010afd5e183e1bbf16_icgraph" loading="lazy" alt=""/></div>
<map name="anamespace_klipper_c_l_i_afeb304003d4b85010afd5e183e1bbf16_icgraph" id="anamespace_klipper_c_l_i_afeb304003d4b85010afd5e183e1bbf16_icgraph">
<area shape="rect" title="Handler for GET_FILAMENT_INFO command." alt="" coords="1084,13,1309,40"/>
<area shape="rect" href="namespace_klipper_c_l_i.html#a6089e6db2e7edddf19fdf095b9826c88" title="Parse and Dispatch a JSON Packet." alt="" coords="857,13,1036,40"/>
<area shape="poly" title=" " alt="" coords="1066,27,1037,29,1037,24,1071,27"/>
<area shape="rect" href="namespace_klipper_c_l_i.html#afe96c8a3898aa7a50f68ab6d726860c3" title="Main Execution Loop." alt="" coords="695,13,809,40"/>
<area shape="poly" title=" " alt="" coords="839,27,809,29,809,24,844,27"/>
<area shape="rect" href="namespace_command_router.html#a96ff3718682e9322a64815a3d41d001b" title="Main execution loop for the Router." alt="" coords="494,13,647,40"/>
<area shape="poly" title=" " alt="" coords="677,27,647,29,647,24,682,27"/>
<area shape="rect" href="main_8cpp.html#afe461d27b9c48d5921c00d521181f12f" title="Arduino Main Loop." alt="" coords="401,13,446,40"/>
<area shape="poly" title=" " alt="" coords="476,27,447,29,447,24,481,27"/>
<area shape="rect" href="class_adafruit___neo_pixel.html#a4bcda7a15591065570d3598cbf970be7" title="将RAM中的像素数据传输到NeoPixels。" alt="" coords="188,13,353,40"/>
<area shape="poly" title=" " alt="" coords="383,27,353,29,353,24,388,27"/>
<area shape="rect" href="class_adafruit___neo_pixel.html#a61b1bd003a291520a367ab1712d6265c" title="释放Adafruit_NeoPixel对象，将数据引脚恢复为输入模式。" alt="" coords="5,5,140,48"/>
<area shape="poly" title=" " alt="" coords="170,27,140,29,140,24,175,26"/>
</map>
</div>

</div>
</div>
<a id="ae13dcd8cc2528c12d0a241046fcc304e" name="ae13dcd8cc2528c12d0a241046fcc304e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae13dcd8cc2528c12d0a241046fcc304e">&#9670;&#160;</a></span>HandleGetSensors()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void KlipperCLI::HandleGetSensors </td>
          <td>(</td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>id</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">JsonObject</td>          <td class="paramname"><span class="paramname"><em>args</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Handler for GET_SENSORS command. </p>
<p>Returns a simple list of booleans indicating filament presence. </p>

<p class="definition">Definition at line <a class="el" href="_klipper_c_l_i_8cpp_source.html#l00185">185</a> of file <a class="el" href="_klipper_c_l_i_8cpp_source.html">KlipperCLI.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  185</span>                                                   {</div>
<div class="line"><span class="lineno">  186</span>         <a class="code hl_variable" href="#adf80752c24e066ed02f3864069ff9707">doc</a>.clear();</div>
<div class="line"><span class="lineno">  187</span>         <a class="code hl_variable" href="#adf80752c24e066ed02f3864069ff9707">doc</a>[<span class="stringliteral">&quot;id&quot;</span>] = id;</div>
<div class="line"><span class="lineno">  188</span>         <a class="code hl_variable" href="#adf80752c24e066ed02f3864069ff9707">doc</a>[<span class="stringliteral">&quot;cmd&quot;</span>] = <span class="stringliteral">&quot;GET_SENSORS&quot;</span>;</div>
<div class="line"><span class="lineno">  189</span>         </div>
<div class="line"><span class="lineno">  190</span>         uint16_t state = <a class="code hl_function" href="namespace_control_logic.html#a4428a845041ff986ccbf2555a62d0656">ControlLogic::GetSensorState</a>();</div>
<div class="line"><span class="lineno">  191</span>         JsonArray lanes = <a class="code hl_variable" href="#adf80752c24e066ed02f3864069ff9707">doc</a>[<span class="stringliteral">&quot;lane&quot;</span>].to&lt;JsonArray&gt;();</div>
<div class="line"><span class="lineno">  192</span>         <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0; i&lt;4; i++) {</div>
<div class="line"><span class="lineno">  193</span>             lanes.add((state &amp; (1&lt;&lt;i)) ? 1 : 0);</div>
<div class="line"><span class="lineno">  194</span>         }</div>
<div class="line"><span class="lineno">  195</span>         <a class="code hl_function" href="#a9ec392d53485800126189969c2c4981a">SendResponse</a>(<a class="code hl_variable" href="#adf80752c24e066ed02f3864069ff9707">doc</a>);</div>
<div class="line"><span class="lineno">  196</span>    }</div>
<div class="ttc" id="anamespace_control_logic_html_a4428a845041ff986ccbf2555a62d0656"><div class="ttname"><a href="namespace_control_logic.html#a4428a845041ff986ccbf2555a62d0656">ControlLogic::GetSensorState</a></div><div class="ttdeci">uint16_t GetSensorState()</div><div class="ttdoc">Get a bitmask of sensor states.</div><div class="ttdef"><b>Definition</b> <a href="_control_logic_8cpp_source.html#l00662">ControlLogic.cpp:662</a></div></div>
<div class="ttc" id="anamespace_klipper_c_l_i_html_a9ec392d53485800126189969c2c4981a"><div class="ttname"><a href="#a9ec392d53485800126189969c2c4981a">KlipperCLI::SendResponse</a></div><div class="ttdeci">void SendResponse(JsonDocument &amp;d)</div><div class="ttdoc">Serialize and send a JSON response.</div><div class="ttdef"><b>Definition</b> <a href="_klipper_c_l_i_8cpp_source.html#l00035">KlipperCLI.cpp:35</a></div></div>
<div class="ttc" id="anamespace_klipper_c_l_i_html_adf80752c24e066ed02f3864069ff9707"><div class="ttname"><a href="#adf80752c24e066ed02f3864069ff9707">KlipperCLI::doc</a></div><div class="ttdeci">static JsonDocument doc</div><div class="ttdef"><b>Definition</b> <a href="_klipper_c_l_i_8cpp_source.html#l00024">KlipperCLI.cpp:24</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="_klipper_c_l_i_8cpp_source.html#l00024">doc</a>, <a class="el" href="_control_logic_8cpp_source.html#l00662">ControlLogic::GetSensorState()</a>, and <a class="el" href="_klipper_c_l_i_8cpp_source.html#l00035">SendResponse()</a>.</p>

<p class="reference">Referenced by <a class="el" href="_klipper_c_l_i_8cpp_source.html#l00400">ProcessPacket()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespace_klipper_c_l_i_ae13dcd8cc2528c12d0a241046fcc304e_cgraph.png" border="0" usemap="#anamespace_klipper_c_l_i_ae13dcd8cc2528c12d0a241046fcc304e_cgraph" loading="lazy" alt=""/></div>
<map name="anamespace_klipper_c_l_i_ae13dcd8cc2528c12d0a241046fcc304e_cgraph" id="anamespace_klipper_c_l_i_ae13dcd8cc2528c12d0a241046fcc304e_cgraph">
<area shape="rect" title="Handler for GET_SENSORS command." alt="" coords="5,31,206,57"/>
<area shape="rect" href="namespace_control_logic.html#a4428a845041ff986ccbf2555a62d0656" title="Get a bitmask of sensor states." alt="" coords="254,5,449,32"/>
<area shape="poly" title=" " alt="" coords="206,31,241,30,235,31,207,36"/>
<area shape="rect" href="namespace_klipper_c_l_i.html#a9ec392d53485800126189969c2c4981a" title="Serialize and send a JSON response." alt="" coords="262,56,441,83"/>
<area shape="poly" title=" " alt="" coords="206,52,249,58,244,59,206,57"/>
<area shape="rect" href="namespace_hardware.html#ad3ec7cad074d6d73508844a06a7bea50" title="Send a buffer via UART1." alt="" coords="497,56,655,83"/>
<area shape="poly" title=" " alt="" coords="441,67,484,69,478,69,441,72"/>
<area shape="rect" href="namespace_hardware.html#a0ada30189b8e1d1dbec145140849b778" title="Microsecond Delay." alt="" coords="937,56,1075,83"/>
<area shape="poly" title=" " alt="" coords="656,67,924,69,918,69,656,72"/>
<area shape="rect" href="namespace_hardware.html#aaaf02ef3df5811e2ba28dd009eadfaae" title="Send a single byte blocking." alt="" coords="703,81,889,108"/>
<area shape="poly" title=" " alt="" coords="656,76,690,82,685,82,656,81"/>
<area shape="poly" title=" " alt="" coords="889,81,919,80,924,79,889,86"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespace_klipper_c_l_i_ae13dcd8cc2528c12d0a241046fcc304e_icgraph.png" border="0" usemap="#anamespace_klipper_c_l_i_ae13dcd8cc2528c12d0a241046fcc304e_icgraph" loading="lazy" alt=""/></div>
<map name="anamespace_klipper_c_l_i_ae13dcd8cc2528c12d0a241046fcc304e_icgraph" id="anamespace_klipper_c_l_i_ae13dcd8cc2528c12d0a241046fcc304e_icgraph">
<area shape="rect" title="Handler for GET_SENSORS command." alt="" coords="1084,13,1285,40"/>
<area shape="rect" href="namespace_klipper_c_l_i.html#a6089e6db2e7edddf19fdf095b9826c88" title="Parse and Dispatch a JSON Packet." alt="" coords="857,13,1036,40"/>
<area shape="poly" title=" " alt="" coords="1066,27,1037,29,1037,24,1071,27"/>
<area shape="rect" href="namespace_klipper_c_l_i.html#afe96c8a3898aa7a50f68ab6d726860c3" title="Main Execution Loop." alt="" coords="695,13,809,40"/>
<area shape="poly" title=" " alt="" coords="839,27,809,29,809,24,844,27"/>
<area shape="rect" href="namespace_command_router.html#a96ff3718682e9322a64815a3d41d001b" title="Main execution loop for the Router." alt="" coords="494,13,647,40"/>
<area shape="poly" title=" " alt="" coords="677,27,647,29,647,24,682,27"/>
<area shape="rect" href="main_8cpp.html#afe461d27b9c48d5921c00d521181f12f" title="Arduino Main Loop." alt="" coords="401,13,446,40"/>
<area shape="poly" title=" " alt="" coords="476,27,447,29,447,24,481,27"/>
<area shape="rect" href="class_adafruit___neo_pixel.html#a4bcda7a15591065570d3598cbf970be7" title="将RAM中的像素数据传输到NeoPixels。" alt="" coords="188,13,353,40"/>
<area shape="poly" title=" " alt="" coords="383,27,353,29,353,24,388,27"/>
<area shape="rect" href="class_adafruit___neo_pixel.html#a61b1bd003a291520a367ab1712d6265c" title="释放Adafruit_NeoPixel对象，将数据引脚恢复为输入模式。" alt="" coords="5,5,140,48"/>
<area shape="poly" title=" " alt="" coords="170,27,140,29,140,24,175,26"/>
</map>
</div>

</div>
</div>
<a id="a12cef4b97fbfa7cfb7bdb1540e626ae9" name="a12cef4b97fbfa7cfb7bdb1540e626ae9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a12cef4b97fbfa7cfb7bdb1540e626ae9">&#9670;&#160;</a></span>HandleMove()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void KlipperCLI::HandleMove </td>
          <td>(</td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>id</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">JsonObject</td>          <td class="paramname"><span class="paramname"><em>args</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Handler for MOVE command. </p>
<p>Initiates a velocity-controlled movement on a specific axis.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">axis</td><td>"FEED", "SELECTOR", or "0"-"3". </td></tr>
    <tr><td class="paramname">dist_mm</td><td>Distance to move (always positive). </td></tr>
    <tr><td class="paramname">speed</td><td>Velocity in mm/s (mapped to motor units). </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="_klipper_c_l_i_8cpp_source.html#l00208">208</a> of file <a class="el" href="_klipper_c_l_i_8cpp_source.html">KlipperCLI.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  208</span>                                             {</div>
<div class="line"><span class="lineno">  209</span>        <span class="comment">// Args extracted before clearing doc</span></div>
<div class="line"><span class="lineno">  210</span>        <span class="comment">// BUT wait, &#39;args&#39; is a reference to &#39;doc&#39; internals (if passed from ProcessPacket).</span></div>
<div class="line"><span class="lineno">  211</span>        <span class="comment">// If we clear &#39;doc&#39; inside HandleMove, &#39;args&#39; becomes invalid!</span></div>
<div class="line"><span class="lineno">  212</span>        <span class="comment">// CRITICAL BUG: accessing &#39;args&#39; after doc.clear() would crash.</span></div>
<div class="line"><span class="lineno">  213</span>        <span class="comment">// We MUST extract args BEFORE clearing doc.</span></div>
<div class="line"><span class="lineno">  214</span>        </div>
<div class="line"><span class="lineno">  215</span>        <span class="comment">// However, we need to send OK/Error.</span></div>
<div class="line"><span class="lineno">  216</span>        <span class="comment">// Option 1: Copy args.</span></div>
<div class="line"><span class="lineno">  217</span>        <span class="comment">// Option 2: Use a SECOND static doc for Response?</span></div>
<div class="line"><span class="lineno">  218</span>        <span class="comment">// Or Option 3: Use &#39;SendOk/SendError&#39; which clears doc, AFTER using args.</span></div>
<div class="line"><span class="lineno">  219</span>        </div>
<div class="line"><span class="lineno">  220</span>        <span class="keywordflow">if</span>(!args[<span class="stringliteral">&quot;axis&quot;</span>].is&lt;const char*&gt;() || !args[<span class="stringliteral">&quot;dist_mm&quot;</span>].is&lt;float&gt;() || !args[<span class="stringliteral">&quot;speed&quot;</span>].is&lt;float&gt;()) {</div>
<div class="line"><span class="lineno">  221</span>             <a class="code hl_function" href="#ad0e99d2fdcfd1c0690f850816ac1f67c">SendError</a>(<span class="keywordtype">id</span>, <span class="stringliteral">&quot;BAD_ARGS&quot;</span>, <span class="stringliteral">&quot;Missing axis, dist, or speed&quot;</span>); <span class="comment">// Clears doc</span></div>
<div class="line"><span class="lineno">  222</span>             <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno">  223</span>        }</div>
<div class="line"><span class="lineno">  224</span>        </div>
<div class="line"><span class="lineno">  225</span>        <span class="comment">// Copy values to stack variables</span></div>
<div class="line"><span class="lineno">  226</span>        <span class="keywordtype">char</span> axis[16]; strncpy(axis, args[<span class="stringliteral">&quot;axis&quot;</span>], 15); axis[15]=0;</div>
<div class="line"><span class="lineno">  227</span>        <span class="keywordtype">float</span> dist = args[<span class="stringliteral">&quot;dist_mm&quot;</span>];</div>
<div class="line"><span class="lineno">  228</span>        <span class="keywordtype">float</span> speed = args[<span class="stringliteral">&quot;speed&quot;</span>];</div>
<div class="line"><span class="lineno">  229</span>        </div>
<div class="line"><span class="lineno">  230</span>        <span class="comment">// Now safe to use logic that might call SendOk/SendError (clearing doc)</span></div>
<div class="line"><span class="lineno">  231</span>        </div>
<div class="line"><span class="lineno">  232</span>        <span class="keywordtype">int</span> motor_idx = -1;</div>
<div class="line"><span class="lineno">  233</span>        <span class="keywordflow">if</span>(strcmp(axis, <span class="stringliteral">&quot;FEED&quot;</span>) == 0) {</div>
<div class="line"><span class="lineno">  234</span>            motor_idx = <a class="code hl_function" href="class_unit_state.html#a4833e917e0069069c7f455a24e28a516">UnitState::GetCurrentFilamentIndex</a>();</div>
<div class="line"><span class="lineno">  235</span>        } <span class="keywordflow">else</span> <span class="keywordflow">if</span>(strcmp(axis, <span class="stringliteral">&quot;SELECTOR&quot;</span>) == 0) {</div>
<div class="line"><span class="lineno">  236</span>        } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (strncmp(axis, <span class="stringliteral">&quot;SPOOL&quot;</span>, 5) == 0) {</div>
<div class="line"><span class="lineno">  237</span>        } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (isdigit(axis[0])) {</div>
<div class="line"><span class="lineno">  238</span>             motor_idx = atoi(axis);</div>
<div class="line"><span class="lineno">  239</span>        }</div>
<div class="line"><span class="lineno">  240</span>        </div>
<div class="line"><span class="lineno">  241</span>        <span class="keywordflow">if</span> (motor_idx &gt;= 0 &amp;&amp; motor_idx &lt; 4) {</div>
<div class="line"><span class="lineno">  242</span>             <a class="code hl_function" href="namespace_control_logic.html#a484eadc314267f8bc9aa0f025c1137d9">ControlLogic::MoveAxis</a>(motor_idx, dist, speed);</div>
<div class="line"><span class="lineno">  243</span>             <a class="code hl_function" href="#a1d7d7986d99cb52ab4feb4826ffc4428">SendOk</a>(<span class="keywordtype">id</span>, <span class="stringliteral">&quot;MOVING&quot;</span>, <span class="stringliteral">&quot;Motion started&quot;</span>);</div>
<div class="line"><span class="lineno">  244</span>        } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  245</span>             <a class="code hl_function" href="#ad0e99d2fdcfd1c0690f850816ac1f67c">SendError</a>(<span class="keywordtype">id</span>, <span class="stringliteral">&quot;BAD_AXIS&quot;</span>, <span class="stringliteral">&quot;Invalid or unknown axis&quot;</span>);</div>
<div class="line"><span class="lineno">  246</span>        }</div>
<div class="line"><span class="lineno">  247</span>    }</div>
<div class="ttc" id="aclass_unit_state_html_a4833e917e0069069c7f455a24e28a516"><div class="ttname"><a href="class_unit_state.html#a4833e917e0069069c7f455a24e28a516">UnitState::GetCurrentFilamentIndex</a></div><div class="ttdeci">static int GetCurrentFilamentIndex()</div><div class="ttdoc">Get the currently active filament index.</div><div class="ttdef"><b>Definition</b> <a href="_control_logic_8cpp_source.html#l00072">ControlLogic.cpp:72</a></div></div>
<div class="ttc" id="anamespace_control_logic_html_a484eadc314267f8bc9aa0f025c1137d9"><div class="ttname"><a href="namespace_control_logic.html#a484eadc314267f8bc9aa0f025c1137d9">ControlLogic::MoveAxis</a></div><div class="ttdeci">void MoveAxis(int axis, float dist_mm, float speed)</div><div class="ttdoc">Manually move an axis (Klipper Primitive).</div><div class="ttdef"><b>Definition</b> <a href="_control_logic_8cpp_source.html#l00616">ControlLogic.cpp:616</a></div></div>
<div class="ttc" id="anamespace_klipper_c_l_i_html_a1d7d7986d99cb52ab4feb4826ffc4428"><div class="ttname"><a href="#a1d7d7986d99cb52ab4feb4826ffc4428">KlipperCLI::SendOk</a></div><div class="ttdeci">void SendOk(int id, const char *code=nullptr, const char *msg=nullptr)</div><div class="ttdoc">Helper to send a Success (OK) response.</div><div class="ttdef"><b>Definition</b> <a href="_klipper_c_l_i_8cpp_source.html#l00073">KlipperCLI.cpp:73</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="_control_logic_8cpp_source.html#l00072">UnitState::GetCurrentFilamentIndex()</a>, <a class="el" href="_control_logic_8cpp_source.html#l00616">ControlLogic::MoveAxis()</a>, <a class="el" href="_klipper_c_l_i_8cpp_source.html#l00056">SendError()</a>, and <a class="el" href="_klipper_c_l_i_8cpp_source.html#l00073">SendOk()</a>.</p>

<p class="reference">Referenced by <a class="el" href="_klipper_c_l_i_8cpp_source.html#l00400">ProcessPacket()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespace_klipper_c_l_i_a12cef4b97fbfa7cfb7bdb1540e626ae9_cgraph.png" border="0" usemap="#anamespace_klipper_c_l_i_a12cef4b97fbfa7cfb7bdb1540e626ae9_cgraph" loading="lazy" alt=""/></div>
<map name="anamespace_klipper_c_l_i_a12cef4b97fbfa7cfb7bdb1540e626ae9_cgraph" id="anamespace_klipper_c_l_i_a12cef4b97fbfa7cfb7bdb1540e626ae9_cgraph">
<area shape="rect" title="Handler for MOVE command." alt="" coords="5,97,169,124"/>
<area shape="rect" href="class_unit_state.html#a4833e917e0069069c7f455a24e28a516" title="Get the currently active filament index." alt="" coords="217,5,415,48"/>
<area shape="poly" title=" " alt="" coords="121,94,216,58,237,52,232,55,218,62,124,99"/>
<area shape="rect" href="namespace_control_logic.html#a484eadc314267f8bc9aa0f025c1137d9" title="Manually move an axis (Klipper Primitive)." alt="" coords="236,72,396,99"/>
<area shape="poly" title=" " alt="" coords="168,99,223,95,218,97,169,104"/>
<area shape="rect" href="namespace_klipper_c_l_i.html#ad0e99d2fdcfd1c0690f850816ac1f67c" title="Helper to send an Error response." alt="" coords="242,123,390,149"/>
<area shape="poly" title=" " alt="" coords="169,117,229,125,224,127,169,122"/>
<area shape="rect" href="namespace_klipper_c_l_i.html#a1d7d7986d99cb52ab4feb4826ffc4428" title="Helper to send a Success (OK) response." alt="" coords="247,173,384,200"/>
<area shape="poly" title=" " alt="" coords="121,122,218,159,244,169,238,169,216,164,120,127"/>
<area shape="rect" href="namespace_klipper_c_l_i.html#a9ec392d53485800126189969c2c4981a" title="Serialize and send a JSON response." alt="" coords="463,148,642,175"/>
<area shape="poly" title=" " alt="" coords="391,141,450,150,445,150,391,147"/>
<area shape="rect" href="namespace_hardware.html#ad3ec7cad074d6d73508844a06a7bea50" title="Send a buffer via UART1." alt="" coords="690,148,849,175"/>
<area shape="poly" title=" " alt="" coords="643,159,677,161,672,161,643,164"/>
<area shape="rect" href="namespace_hardware.html#a0ada30189b8e1d1dbec145140849b778" title="Microsecond Delay." alt="" coords="1130,148,1268,175"/>
<area shape="poly" title=" " alt="" coords="849,159,1117,161,1112,161,849,164"/>
<area shape="rect" href="namespace_hardware.html#aaaf02ef3df5811e2ba28dd009eadfaae" title="Send a single byte blocking." alt="" coords="897,173,1082,200"/>
<area shape="poly" title=" " alt="" coords="849,168,884,174,878,174,849,173"/>
<area shape="poly" title=" " alt="" coords="1082,173,1112,172,1118,171,1082,178"/>
<area shape="poly" title=" " alt="" coords="385,177,444,173,450,172,385,182"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespace_klipper_c_l_i_a12cef4b97fbfa7cfb7bdb1540e626ae9_icgraph.png" border="0" usemap="#anamespace_klipper_c_l_i_a12cef4b97fbfa7cfb7bdb1540e626ae9_icgraph" loading="lazy" alt=""/></div>
<map name="anamespace_klipper_c_l_i_a12cef4b97fbfa7cfb7bdb1540e626ae9_icgraph" id="anamespace_klipper_c_l_i_a12cef4b97fbfa7cfb7bdb1540e626ae9_icgraph">
<area shape="rect" title="Handler for MOVE command." alt="" coords="1084,13,1248,40"/>
<area shape="rect" href="namespace_klipper_c_l_i.html#a6089e6db2e7edddf19fdf095b9826c88" title="Parse and Dispatch a JSON Packet." alt="" coords="857,13,1036,40"/>
<area shape="poly" title=" " alt="" coords="1066,27,1037,29,1037,24,1072,27"/>
<area shape="rect" href="namespace_klipper_c_l_i.html#afe96c8a3898aa7a50f68ab6d726860c3" title="Main Execution Loop." alt="" coords="695,13,809,40"/>
<area shape="poly" title=" " alt="" coords="839,27,809,29,809,24,844,27"/>
<area shape="rect" href="namespace_command_router.html#a96ff3718682e9322a64815a3d41d001b" title="Main execution loop for the Router." alt="" coords="494,13,647,40"/>
<area shape="poly" title=" " alt="" coords="677,27,647,29,647,24,682,27"/>
<area shape="rect" href="main_8cpp.html#afe461d27b9c48d5921c00d521181f12f" title="Arduino Main Loop." alt="" coords="401,13,446,40"/>
<area shape="poly" title=" " alt="" coords="476,27,447,29,447,24,481,27"/>
<area shape="rect" href="class_adafruit___neo_pixel.html#a4bcda7a15591065570d3598cbf970be7" title="将RAM中的像素数据传输到NeoPixels。" alt="" coords="188,13,353,40"/>
<area shape="poly" title=" " alt="" coords="383,27,353,29,353,24,388,27"/>
<area shape="rect" href="class_adafruit___neo_pixel.html#a61b1bd003a291520a367ab1712d6265c" title="释放Adafruit_NeoPixel对象，将数据引脚恢复为输入模式。" alt="" coords="5,5,140,48"/>
<area shape="poly" title=" " alt="" coords="170,27,140,29,140,24,175,26"/>
</map>
</div>

</div>
</div>
<a id="a81f1646e6adb42482d4109a33b9bb9c5" name="a81f1646e6adb42482d4109a33b9bb9c5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a81f1646e6adb42482d4109a33b9bb9c5">&#9670;&#160;</a></span>HandlePing()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void KlipperCLI::HandlePing </td>
          <td>(</td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>id</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">JsonObject</td>          <td class="paramname"><span class="paramname"><em>args</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Handler for PING command. </p>
<p>Returns telemetry (version, uptime). </p>

<p class="definition">Definition at line <a class="el" href="_klipper_c_l_i_8cpp_source.html#l00090">90</a> of file <a class="el" href="_klipper_c_l_i_8cpp_source.html">KlipperCLI.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   90</span>                                             {</div>
<div class="line"><span class="lineno">   91</span>        <a class="code hl_variable" href="#adf80752c24e066ed02f3864069ff9707">doc</a>.clear();</div>
<div class="line"><span class="lineno">   92</span>        <a class="code hl_variable" href="#adf80752c24e066ed02f3864069ff9707">doc</a>[<span class="stringliteral">&quot;id&quot;</span>] = id;</div>
<div class="line"><span class="lineno">   93</span>        <a class="code hl_variable" href="#adf80752c24e066ed02f3864069ff9707">doc</a>[<span class="stringliteral">&quot;cmd&quot;</span>] = <span class="stringliteral">&quot;PING&quot;</span>;</div>
<div class="line"><span class="lineno">   94</span>        <a class="code hl_variable" href="#adf80752c24e066ed02f3864069ff9707">doc</a>[<span class="stringliteral">&quot;result&quot;</span>] = <span class="stringliteral">&quot;ok&quot;</span>;</div>
<div class="line"><span class="lineno">   95</span>        </div>
<div class="line"><span class="lineno">   96</span>        JsonObject t = <a class="code hl_variable" href="#adf80752c24e066ed02f3864069ff9707">doc</a>[<span class="stringliteral">&quot;telemetry&quot;</span>].to&lt;JsonObject&gt;();</div>
<div class="line"><span class="lineno">   97</span>        t[<span class="stringliteral">&quot;version&quot;</span>] = <a class="code hl_function" href="class_unit_state.html#a745286b33e7a2805f9045e22fc0a49ac">UnitState::GetVersion</a>();</div>
<div class="line"><span class="lineno">   98</span>        t[<span class="stringliteral">&quot;uptime&quot;</span>] = <a class="code hl_function" href="namespace_hardware.html#a8ea28b07408691bc126683a81aa220f3">Hardware::GetTime</a>();</div>
<div class="line"><span class="lineno">   99</span>        </div>
<div class="line"><span class="lineno">  100</span>        <a class="code hl_function" href="#a9ec392d53485800126189969c2c4981a">SendResponse</a>(<a class="code hl_variable" href="#adf80752c24e066ed02f3864069ff9707">doc</a>);</div>
<div class="line"><span class="lineno">  101</span>    }</div>
<div class="ttc" id="aclass_unit_state_html_a745286b33e7a2805f9045e22fc0a49ac"><div class="ttname"><a href="class_unit_state.html#a745286b33e7a2805f9045e22fc0a49ac">UnitState::GetVersion</a></div><div class="ttdeci">static const char * GetVersion()</div><div class="ttdef"><b>Definition</b> <a href="_control_logic_8cpp_source.html#l00125">ControlLogic.cpp:125</a></div></div>
<div class="ttc" id="anamespace_hardware_html_a8ea28b07408691bc126683a81aa220f3"><div class="ttname"><a href="namespace_hardware.html#a8ea28b07408691bc126683a81aa220f3">Hardware::GetTime</a></div><div class="ttdeci">uint64_t GetTime()</div><div class="ttdoc">Get System Time in Milliseconds.</div><div class="ttdef"><b>Definition</b> <a href="_hardware_8cpp_source.html#l00115">Hardware.cpp:115</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="_klipper_c_l_i_8cpp_source.html#l00024">doc</a>, <a class="el" href="_hardware_8cpp_source.html#l00115">Hardware::GetTime()</a>, <a class="el" href="_control_logic_8cpp_source.html#l00125">UnitState::GetVersion()</a>, and <a class="el" href="_klipper_c_l_i_8cpp_source.html#l00035">SendResponse()</a>.</p>

<p class="reference">Referenced by <a class="el" href="_klipper_c_l_i_8cpp_source.html#l00400">ProcessPacket()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespace_klipper_c_l_i_a81f1646e6adb42482d4109a33b9bb9c5_cgraph.png" border="0" usemap="#anamespace_klipper_c_l_i_a81f1646e6adb42482d4109a33b9bb9c5_cgraph" loading="lazy" alt=""/></div>
<map name="anamespace_klipper_c_l_i_a81f1646e6adb42482d4109a33b9bb9c5_cgraph" id="anamespace_klipper_c_l_i_a81f1646e6adb42482d4109a33b9bb9c5_cgraph">
<area shape="rect" title="Handler for PING command." alt="" coords="5,56,163,83"/>
<area shape="rect" href="namespace_hardware.html#a8ea28b07408691bc126683a81aa220f3" title="Get System Time in Milliseconds." alt="" coords="233,5,368,32"/>
<area shape="poly" title=" " alt="" coords="143,53,228,35,223,38,145,58"/>
<area shape="rect" href="class_unit_state.html#a745286b33e7a2805f9045e22fc0a49ac" title=" " alt="" coords="226,56,374,83"/>
<area shape="poly" title=" " alt="" coords="163,67,213,68,208,70,164,72"/>
<area shape="rect" href="namespace_klipper_c_l_i.html#a9ec392d53485800126189969c2c4981a" title="Serialize and send a JSON response." alt="" coords="211,107,390,133"/>
<area shape="poly" title=" " alt="" coords="144,81,228,102,223,104,144,86"/>
<area shape="rect" href="time64_8cpp.html#a146d483f58902ba0184ce16f728edfb0" title="Get 64&#45;bit System Time in Milliseconds." alt="" coords="474,5,560,32"/>
<area shape="poly" title=" " alt="" coords="368,16,462,18,456,19,369,21"/>
<area shape="rect" href="namespace_hardware.html#ad3ec7cad074d6d73508844a06a7bea50" title="Send a buffer via UART1." alt="" coords="438,107,596,133"/>
<area shape="poly" title=" " alt="" coords="391,117,425,120,420,120,391,123"/>
<area shape="rect" href="namespace_hardware.html#a0ada30189b8e1d1dbec145140849b778" title="Microsecond Delay." alt="" coords="878,107,1016,133"/>
<area shape="poly" title=" " alt="" coords="597,117,865,120,859,120,597,123"/>
<area shape="rect" href="namespace_hardware.html#aaaf02ef3df5811e2ba28dd009eadfaae" title="Send a single byte blocking." alt="" coords="644,132,830,159"/>
<area shape="poly" title=" " alt="" coords="597,126,631,133,626,133,597,132"/>
<area shape="poly" title=" " alt="" coords="830,131,860,130,865,130,830,137"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespace_klipper_c_l_i_a81f1646e6adb42482d4109a33b9bb9c5_icgraph.png" border="0" usemap="#anamespace_klipper_c_l_i_a81f1646e6adb42482d4109a33b9bb9c5_icgraph" loading="lazy" alt=""/></div>
<map name="anamespace_klipper_c_l_i_a81f1646e6adb42482d4109a33b9bb9c5_icgraph" id="anamespace_klipper_c_l_i_a81f1646e6adb42482d4109a33b9bb9c5_icgraph">
<area shape="rect" title="Handler for PING command." alt="" coords="1084,13,1242,40"/>
<area shape="rect" href="namespace_klipper_c_l_i.html#a6089e6db2e7edddf19fdf095b9826c88" title="Parse and Dispatch a JSON Packet." alt="" coords="857,13,1036,40"/>
<area shape="poly" title=" " alt="" coords="1066,27,1037,29,1037,24,1071,27"/>
<area shape="rect" href="namespace_klipper_c_l_i.html#afe96c8a3898aa7a50f68ab6d726860c3" title="Main Execution Loop." alt="" coords="695,13,809,40"/>
<area shape="poly" title=" " alt="" coords="839,27,809,29,809,24,844,27"/>
<area shape="rect" href="namespace_command_router.html#a96ff3718682e9322a64815a3d41d001b" title="Main execution loop for the Router." alt="" coords="494,13,647,40"/>
<area shape="poly" title=" " alt="" coords="677,27,647,29,647,24,682,27"/>
<area shape="rect" href="main_8cpp.html#afe461d27b9c48d5921c00d521181f12f" title="Arduino Main Loop." alt="" coords="401,13,446,40"/>
<area shape="poly" title=" " alt="" coords="476,27,447,29,447,24,481,27"/>
<area shape="rect" href="class_adafruit___neo_pixel.html#a4bcda7a15591065570d3598cbf970be7" title="将RAM中的像素数据传输到NeoPixels。" alt="" coords="188,13,353,40"/>
<area shape="poly" title=" " alt="" coords="383,27,353,29,353,24,388,27"/>
<area shape="rect" href="class_adafruit___neo_pixel.html#a61b1bd003a291520a367ab1712d6265c" title="释放Adafruit_NeoPixel对象，将数据引脚恢复为输入模式。" alt="" coords="5,5,140,48"/>
<area shape="poly" title=" " alt="" coords="170,27,140,29,140,24,175,26"/>
</map>
</div>

</div>
</div>
<a id="a685b6d688593b458b5edafda4adfd4d4" name="a685b6d688593b458b5edafda4adfd4d4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a685b6d688593b458b5edafda4adfd4d4">&#9670;&#160;</a></span>HandleSelectLane()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void KlipperCLI::HandleSelectLane </td>
          <td>(</td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>id</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">JsonObject</td>          <td class="paramname"><span class="paramname"><em>args</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Handler for SELECT_LANE command. </p>
<p>Sets the active lane index.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">lane</td><td>Lane index (0-3). </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="_klipper_c_l_i_8cpp_source.html#l00268">268</a> of file <a class="el" href="_klipper_c_l_i_8cpp_source.html">KlipperCLI.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  268</span>                                                   {</div>
<div class="line"><span class="lineno">  269</span>        <span class="keywordflow">if</span>(!args[<span class="stringliteral">&quot;lane&quot;</span>].is&lt;int&gt;()) {</div>
<div class="line"><span class="lineno">  270</span>            <a class="code hl_function" href="#ad0e99d2fdcfd1c0690f850816ac1f67c">SendError</a>(<span class="keywordtype">id</span>, <span class="stringliteral">&quot;BAD_ARGS&quot;</span>, <span class="stringliteral">&quot;Missing lane&quot;</span>);</div>
<div class="line"><span class="lineno">  271</span>            <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno">  272</span>        }</div>
<div class="line"><span class="lineno">  273</span>        <span class="keywordtype">int</span> lane = args[<span class="stringliteral">&quot;lane&quot;</span>];</div>
<div class="line"><span class="lineno">  274</span>        <span class="keywordflow">if</span>(lane &lt; 0 || lane &gt;= 4) {</div>
<div class="line"><span class="lineno">  275</span>            <a class="code hl_function" href="#ad0e99d2fdcfd1c0690f850816ac1f67c">SendError</a>(<span class="keywordtype">id</span>, <span class="stringliteral">&quot;BAD_LANE&quot;</span>, <span class="stringliteral">&quot;Lane must be 0-3&quot;</span>);</div>
<div class="line"><span class="lineno">  276</span>            <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno">  277</span>        }</div>
<div class="line"><span class="lineno">  278</span>        <a class="code hl_function" href="class_unit_state.html#a07223951eecac60709753ce07290477d">UnitState::SetCurrentFilamentIndex</a>(lane);</div>
<div class="line"><span class="lineno">  279</span>        <a class="code hl_function" href="#a1d7d7986d99cb52ab4feb4826ffc4428">SendOk</a>(<span class="keywordtype">id</span>);</div>
<div class="line"><span class="lineno">  280</span>    }</div>
<div class="ttc" id="aclass_unit_state_html_a07223951eecac60709753ce07290477d"><div class="ttname"><a href="class_unit_state.html#a07223951eecac60709753ce07290477d">UnitState::SetCurrentFilamentIndex</a></div><div class="ttdeci">static void SetCurrentFilamentIndex(int index)</div><div class="ttdoc">Set the currently active filament index.</div><div class="ttdef"><b>Definition</b> <a href="_control_logic_8cpp_source.html#l00081">ControlLogic.cpp:81</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="_klipper_c_l_i_8cpp_source.html#l00056">SendError()</a>, <a class="el" href="_klipper_c_l_i_8cpp_source.html#l00073">SendOk()</a>, and <a class="el" href="_control_logic_8cpp_source.html#l00081">UnitState::SetCurrentFilamentIndex()</a>.</p>

<p class="reference">Referenced by <a class="el" href="_klipper_c_l_i_8cpp_source.html#l00400">ProcessPacket()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespace_klipper_c_l_i_a685b6d688593b458b5edafda4adfd4d4_cgraph.png" border="0" usemap="#anamespace_klipper_c_l_i_a685b6d688593b458b5edafda4adfd4d4_cgraph" loading="lazy" alt=""/></div>
<map name="anamespace_klipper_c_l_i_a685b6d688593b458b5edafda4adfd4d4_cgraph" id="anamespace_klipper_c_l_i_a685b6d688593b458b5edafda4adfd4d4_cgraph">
<area shape="rect" title="Handler for SELECT_LANE command." alt="" coords="5,56,202,83"/>
<area shape="rect" href="namespace_klipper_c_l_i.html#ad0e99d2fdcfd1c0690f850816ac1f67c" title="Helper to send an Error response." alt="" coords="274,5,422,32"/>
<area shape="poly" title=" " alt="" coords="171,53,268,34,263,37,172,58"/>
<area shape="rect" href="namespace_klipper_c_l_i.html#a1d7d7986d99cb52ab4feb4826ffc4428" title="Helper to send a Success (OK) response." alt="" coords="280,56,417,83"/>
<area shape="poly" title=" " alt="" coords="202,67,267,69,262,70,203,72"/>
<area shape="rect" href="class_unit_state.html#a07223951eecac60709753ce07290477d" title="Set the currently active filament index." alt="" coords="250,107,447,149"/>
<area shape="poly" title=" " alt="" coords="162,81,244,102,239,103,162,86"/>
<area shape="rect" href="namespace_klipper_c_l_i.html#a9ec392d53485800126189969c2c4981a" title="Serialize and send a JSON response." alt="" coords="495,31,674,57"/>
<area shape="poly" title=" " alt="" coords="423,24,482,32,477,33,423,29"/>
<area shape="rect" href="namespace_hardware.html#ad3ec7cad074d6d73508844a06a7bea50" title="Send a buffer via UART1." alt="" coords="722,31,881,57"/>
<area shape="poly" title=" " alt="" coords="675,41,709,44,704,44,675,47"/>
<area shape="rect" href="namespace_hardware.html#a0ada30189b8e1d1dbec145140849b778" title="Microsecond Delay." alt="" coords="1162,31,1300,57"/>
<area shape="poly" title=" " alt="" coords="881,41,1149,44,1144,44,881,47"/>
<area shape="rect" href="namespace_hardware.html#aaaf02ef3df5811e2ba28dd009eadfaae" title="Send a single byte blocking." alt="" coords="929,56,1114,83"/>
<area shape="poly" title=" " alt="" coords="881,50,916,57,910,57,881,56"/>
<area shape="poly" title=" " alt="" coords="1114,55,1144,54,1150,54,1114,61"/>
<area shape="poly" title=" " alt="" coords="417,59,482,55,477,56,418,65"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespace_klipper_c_l_i_a685b6d688593b458b5edafda4adfd4d4_icgraph.png" border="0" usemap="#anamespace_klipper_c_l_i_a685b6d688593b458b5edafda4adfd4d4_icgraph" loading="lazy" alt=""/></div>
<map name="anamespace_klipper_c_l_i_a685b6d688593b458b5edafda4adfd4d4_icgraph" id="anamespace_klipper_c_l_i_a685b6d688593b458b5edafda4adfd4d4_icgraph">
<area shape="rect" title="Handler for SELECT_LANE command." alt="" coords="1084,13,1281,40"/>
<area shape="rect" href="namespace_klipper_c_l_i.html#a6089e6db2e7edddf19fdf095b9826c88" title="Parse and Dispatch a JSON Packet." alt="" coords="857,13,1036,40"/>
<area shape="poly" title=" " alt="" coords="1066,27,1037,29,1037,24,1072,27"/>
<area shape="rect" href="namespace_klipper_c_l_i.html#afe96c8a3898aa7a50f68ab6d726860c3" title="Main Execution Loop." alt="" coords="695,13,809,40"/>
<area shape="poly" title=" " alt="" coords="839,27,809,29,809,24,844,27"/>
<area shape="rect" href="namespace_command_router.html#a96ff3718682e9322a64815a3d41d001b" title="Main execution loop for the Router." alt="" coords="494,13,647,40"/>
<area shape="poly" title=" " alt="" coords="677,27,647,29,647,24,682,27"/>
<area shape="rect" href="main_8cpp.html#afe461d27b9c48d5921c00d521181f12f" title="Arduino Main Loop." alt="" coords="401,13,446,40"/>
<area shape="poly" title=" " alt="" coords="476,27,447,29,447,24,481,27"/>
<area shape="rect" href="class_adafruit___neo_pixel.html#a4bcda7a15591065570d3598cbf970be7" title="将RAM中的像素数据传输到NeoPixels。" alt="" coords="188,13,353,40"/>
<area shape="poly" title=" " alt="" coords="383,27,353,29,353,24,388,27"/>
<area shape="rect" href="class_adafruit___neo_pixel.html#a61b1bd003a291520a367ab1712d6265c" title="释放Adafruit_NeoPixel对象，将数据引脚恢复为输入模式。" alt="" coords="5,5,140,48"/>
<area shape="poly" title=" " alt="" coords="170,27,140,29,140,24,175,26"/>
</map>
</div>

</div>
</div>
<a id="a31ef4dae129916b85fdd8d1612553c77" name="a31ef4dae129916b85fdd8d1612553c77"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a31ef4dae129916b85fdd8d1612553c77">&#9670;&#160;</a></span>HandleSetAutoFeed()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void KlipperCLI::HandleSetAutoFeed </td>
          <td>(</td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>id</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">JsonObject</td>          <td class="paramname"><span class="paramname"><em>args</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Handler for SET_AUTO_FEED command. </p>
<p>Enables automatic pressure control (feeding/holding) for a lane. </p>

<p class="definition">Definition at line <a class="el" href="_klipper_c_l_i_8cpp_source.html#l00288">288</a> of file <a class="el" href="_klipper_c_l_i_8cpp_source.html">KlipperCLI.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  288</span>                                                    {</div>
<div class="line"><span class="lineno">  289</span>        <span class="keywordflow">if</span>(!args[<span class="stringliteral">&quot;lane&quot;</span>].is&lt;int&gt;() || !args[<span class="stringliteral">&quot;enable&quot;</span>].is&lt;bool&gt;()) {</div>
<div class="line"><span class="lineno">  290</span>             <a class="code hl_function" href="#ad0e99d2fdcfd1c0690f850816ac1f67c">SendError</a>(<span class="keywordtype">id</span>, <span class="stringliteral">&quot;BAD_ARGS&quot;</span>, <span class="stringliteral">&quot;Missing lane or enable&quot;</span>);</div>
<div class="line"><span class="lineno">  291</span>             <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno">  292</span>        }</div>
<div class="line"><span class="lineno">  293</span>        <span class="keywordtype">int</span> lane = args[<span class="stringliteral">&quot;lane&quot;</span>];</div>
<div class="line"><span class="lineno">  294</span>        <span class="keywordtype">bool</span> enable = args[<span class="stringliteral">&quot;enable&quot;</span>];</div>
<div class="line"><span class="lineno">  295</span>        <a class="code hl_function" href="namespace_control_logic.html#a9db355302a1c9d608e6dd5341151336e">ControlLogic::SetAutoFeed</a>(lane, enable);</div>
<div class="line"><span class="lineno">  296</span>        <a class="code hl_function" href="#a1d7d7986d99cb52ab4feb4826ffc4428">SendOk</a>(<span class="keywordtype">id</span>);</div>
<div class="line"><span class="lineno">  297</span>    }</div>
<div class="ttc" id="anamespace_control_logic_html_a9db355302a1c9d608e6dd5341151336e"><div class="ttname"><a href="namespace_control_logic.html#a9db355302a1c9d608e6dd5341151336e">ControlLogic::SetAutoFeed</a></div><div class="ttdeci">void SetAutoFeed(int lane, bool enable)</div><div class="ttdoc">Enable/Disable Auto-Feed (Pressure Control) for a lane.</div><div class="ttdef"><b>Definition</b> <a href="_control_logic_8cpp_source.html#l00643">ControlLogic.cpp:643</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="_klipper_c_l_i_8cpp_source.html#l00056">SendError()</a>, <a class="el" href="_klipper_c_l_i_8cpp_source.html#l00073">SendOk()</a>, and <a class="el" href="_control_logic_8cpp_source.html#l00643">ControlLogic::SetAutoFeed()</a>.</p>

<p class="reference">Referenced by <a class="el" href="_klipper_c_l_i_8cpp_source.html#l00400">ProcessPacket()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespace_klipper_c_l_i_a31ef4dae129916b85fdd8d1612553c77_cgraph.png" border="0" usemap="#anamespace_klipper_c_l_i_a31ef4dae129916b85fdd8d1612553c77_cgraph" loading="lazy" alt=""/></div>
<map name="anamespace_klipper_c_l_i_a31ef4dae129916b85fdd8d1612553c77_cgraph" id="anamespace_klipper_c_l_i_a31ef4dae129916b85fdd8d1612553c77_cgraph">
<area shape="rect" title="Handler for SET_AUTO_FEED command." alt="" coords="5,56,213,83"/>
<area shape="rect" href="namespace_klipper_c_l_i.html#ad0e99d2fdcfd1c0690f850816ac1f67c" title="Helper to send an Error response." alt="" coords="276,5,424,32"/>
<area shape="poly" title=" " alt="" coords="175,53,271,35,266,37,177,58"/>
<area shape="rect" href="namespace_klipper_c_l_i.html#a1d7d7986d99cb52ab4feb4826ffc4428" title="Helper to send a Success (OK) response." alt="" coords="281,56,418,83"/>
<area shape="poly" title=" " alt="" coords="213,67,268,69,263,70,213,72"/>
<area shape="rect" href="namespace_control_logic.html#a9db355302a1c9d608e6dd5341151336e" title="Enable/Disable Auto&#45;Feed (Pressure Control) for a lane." alt="" coords="261,107,439,133"/>
<area shape="poly" title=" " alt="" coords="176,81,271,102,266,104,176,86"/>
<area shape="rect" href="namespace_klipper_c_l_i.html#a9ec392d53485800126189969c2c4981a" title="Serialize and send a JSON response." alt="" coords="487,31,666,57"/>
<area shape="poly" title=" " alt="" coords="424,24,474,32,469,32,425,30"/>
<area shape="rect" href="namespace_hardware.html#ad3ec7cad074d6d73508844a06a7bea50" title="Send a buffer via UART1." alt="" coords="714,31,873,57"/>
<area shape="poly" title=" " alt="" coords="667,41,701,44,696,44,667,47"/>
<area shape="rect" href="namespace_hardware.html#a0ada30189b8e1d1dbec145140849b778" title="Microsecond Delay." alt="" coords="1154,31,1292,57"/>
<area shape="poly" title=" " alt="" coords="873,41,1141,44,1136,44,873,47"/>
<area shape="rect" href="namespace_hardware.html#aaaf02ef3df5811e2ba28dd009eadfaae" title="Send a single byte blocking." alt="" coords="921,56,1106,83"/>
<area shape="poly" title=" " alt="" coords="873,50,908,57,902,57,873,56"/>
<area shape="poly" title=" " alt="" coords="1106,55,1136,54,1142,54,1106,61"/>
<area shape="poly" title=" " alt="" coords="419,59,474,55,469,56,419,64"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespace_klipper_c_l_i_a31ef4dae129916b85fdd8d1612553c77_icgraph.png" border="0" usemap="#anamespace_klipper_c_l_i_a31ef4dae129916b85fdd8d1612553c77_icgraph" loading="lazy" alt=""/></div>
<map name="anamespace_klipper_c_l_i_a31ef4dae129916b85fdd8d1612553c77_icgraph" id="anamespace_klipper_c_l_i_a31ef4dae129916b85fdd8d1612553c77_icgraph">
<area shape="rect" title="Handler for SET_AUTO_FEED command." alt="" coords="1084,13,1292,40"/>
<area shape="rect" href="namespace_klipper_c_l_i.html#a6089e6db2e7edddf19fdf095b9826c88" title="Parse and Dispatch a JSON Packet." alt="" coords="857,13,1036,40"/>
<area shape="poly" title=" " alt="" coords="1066,27,1037,29,1037,24,1071,27"/>
<area shape="rect" href="namespace_klipper_c_l_i.html#afe96c8a3898aa7a50f68ab6d726860c3" title="Main Execution Loop." alt="" coords="695,13,809,40"/>
<area shape="poly" title=" " alt="" coords="839,27,809,29,809,24,844,27"/>
<area shape="rect" href="namespace_command_router.html#a96ff3718682e9322a64815a3d41d001b" title="Main execution loop for the Router." alt="" coords="494,13,647,40"/>
<area shape="poly" title=" " alt="" coords="677,27,647,29,647,24,682,27"/>
<area shape="rect" href="main_8cpp.html#afe461d27b9c48d5921c00d521181f12f" title="Arduino Main Loop." alt="" coords="401,13,446,40"/>
<area shape="poly" title=" " alt="" coords="476,27,447,29,447,24,481,27"/>
<area shape="rect" href="class_adafruit___neo_pixel.html#a4bcda7a15591065570d3598cbf970be7" title="将RAM中的像素数据传输到NeoPixels。" alt="" coords="188,13,353,40"/>
<area shape="poly" title=" " alt="" coords="383,27,353,29,353,24,388,27"/>
<area shape="rect" href="class_adafruit___neo_pixel.html#a61b1bd003a291520a367ab1712d6265c" title="释放Adafruit_NeoPixel对象，将数据引脚恢复为输入模式。" alt="" coords="5,5,140,48"/>
<area shape="poly" title=" " alt="" coords="170,27,140,29,140,24,175,26"/>
</map>
</div>

</div>
</div>
<a id="a76547f35e246989843f1870c760ea514" name="a76547f35e246989843f1870c760ea514"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a76547f35e246989843f1870c760ea514">&#9670;&#160;</a></span>HandleSetFilamentInfo()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void KlipperCLI::HandleSetFilamentInfo </td>
          <td>(</td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>id</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">JsonObject</td>          <td class="paramname"><span class="paramname"><em>args</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Handler for SET_FILAMENT_INFO command. </p>
<p>Updates metadata for a specific lane. Supports partial updates. </p>

<p class="definition">Definition at line <a class="el" href="_klipper_c_l_i_8cpp_source.html#l00347">347</a> of file <a class="el" href="_klipper_c_l_i_8cpp_source.html">KlipperCLI.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  347</span>                                                        {</div>
<div class="line"><span class="lineno">  348</span>         <span class="comment">// Need to extract ALL args to stack/struct before clearing doc</span></div>
<div class="line"><span class="lineno">  349</span>         <span class="comment">// This is tricky for complex objects like Color array.</span></div>
<div class="line"><span class="lineno">  350</span>         <span class="comment">// Actually, do we assume ProcessPacket uses the SAME &#39;doc&#39;?</span></div>
<div class="line"><span class="lineno">  351</span>         <span class="comment">// YES. ProcessPacket uses &#39;doc&#39;. &#39;args&#39; points to inside &#39;doc&#39;.</span></div>
<div class="line"><span class="lineno">  352</span>         <span class="comment">// So we MUST NOT clear &#39;doc&#39; until we are done reading &#39;args&#39;.</span></div>
<div class="line"><span class="lineno">  353</span>         </div>
<div class="line"><span class="lineno">  354</span>         <span class="comment">// Solution: Create a temporary FilamentInfo struct on stack</span></div>
<div class="line"><span class="lineno">  355</span>         </div>
<div class="line"><span class="lineno">  356</span>         <span class="keywordflow">if</span>(!args[<span class="stringliteral">&quot;lane&quot;</span>].is&lt;int&gt;()) { <a class="code hl_function" href="#ad0e99d2fdcfd1c0690f850816ac1f67c">SendError</a>(<span class="keywordtype">id</span>, <span class="stringliteral">&quot;BAD_ARGS&quot;</span>, <span class="stringliteral">&quot;Missing lane&quot;</span>); <span class="keywordflow">return</span>; }</div>
<div class="line"><span class="lineno">  357</span>         <span class="keywordtype">int</span> lane = args[<span class="stringliteral">&quot;lane&quot;</span>];</div>
<div class="line"><span class="lineno">  358</span>         </div>
<div class="line"><span class="lineno">  359</span>         <span class="comment">// ... (Logic to read args into stack vars)</span></div>
<div class="line"><span class="lineno">  360</span>         <a class="code hl_struct" href="struct_filament_info.html">FilamentInfo</a> info;</div>
<div class="line"><span class="lineno">  361</span>         <a class="code hl_struct" href="struct_filament_state.html">FilamentState</a> &amp;current = <a class="code hl_function" href="class_unit_state.html#a221a5d98d4e870c593e5bd5ee6621c4c">UnitState::GetFilament</a>(lane);</div>
<div class="line"><span class="lineno">  362</span>         memcpy(info.<a class="code hl_variable" href="struct_filament_info.html#a26e0e6218d4a40974be5086c2ac89087">ID</a>, current.<a class="code hl_variable" href="struct_filament_info.html#a26e0e6218d4a40974be5086c2ac89087">ID</a>, <span class="keyword">sizeof</span>(info.<a class="code hl_variable" href="struct_filament_info.html#a26e0e6218d4a40974be5086c2ac89087">ID</a>));</div>
<div class="line"><span class="lineno">  363</span>         memcpy(info.<a class="code hl_variable" href="struct_filament_info.html#a5bf1b8820cfc338a0e489064670e6672">name</a>, current.<a class="code hl_variable" href="struct_filament_info.html#a5bf1b8820cfc338a0e489064670e6672">name</a>, <span class="keyword">sizeof</span>(info.<a class="code hl_variable" href="struct_filament_info.html#a5bf1b8820cfc338a0e489064670e6672">name</a>));</div>
<div class="line"><span class="lineno">  364</span>         info.<a class="code hl_variable" href="struct_filament_info.html#a49b75d4f9105d90760ca96138c8fcf45">color_R</a> = current.<a class="code hl_variable" href="struct_filament_info.html#a49b75d4f9105d90760ca96138c8fcf45">color_R</a>;</div>
<div class="line"><span class="lineno">  365</span>         info.<a class="code hl_variable" href="struct_filament_info.html#a401880702bfbb50388082ccfc4da0ddd">color_G</a> = current.<a class="code hl_variable" href="struct_filament_info.html#a401880702bfbb50388082ccfc4da0ddd">color_G</a>;</div>
<div class="line"><span class="lineno">  366</span>         info.<a class="code hl_variable" href="struct_filament_info.html#ab1c9dff383b15c09a2fad0cf6d7e8714">color_B</a> = current.<a class="code hl_variable" href="struct_filament_info.html#ab1c9dff383b15c09a2fad0cf6d7e8714">color_B</a>;</div>
<div class="line"><span class="lineno">  367</span>         info.<a class="code hl_variable" href="struct_filament_info.html#a72997ce70a6852951aac4a8c907e24ac">color_A</a> = current.<a class="code hl_variable" href="struct_filament_info.html#a72997ce70a6852951aac4a8c907e24ac">color_A</a>;</div>
<div class="line"><span class="lineno">  368</span>         info.<a class="code hl_variable" href="struct_filament_info.html#a5868192ee8a9087a32bc1b242024aa72">temperature_min</a> = current.<a class="code hl_variable" href="struct_filament_info.html#a5868192ee8a9087a32bc1b242024aa72">temperature_min</a>;</div>
<div class="line"><span class="lineno">  369</span>         info.<a class="code hl_variable" href="struct_filament_info.html#a45dff2f7e9e7b3794d9ff6469f50113f">temperature_max</a> = current.<a class="code hl_variable" href="struct_filament_info.html#a45dff2f7e9e7b3794d9ff6469f50113f">temperature_max</a>;</div>
<div class="line"><span class="lineno">  370</span> </div>
<div class="line"><span class="lineno">  371</span>         <span class="keywordflow">if</span>(args[<span class="stringliteral">&quot;id_str&quot;</span>].is&lt;const char*&gt;()) info.<a class="code hl_function" href="struct_filament_info.html#ac821cbe379c5f19ac753f91adef53851">SetID</a>(args[<span class="stringliteral">&quot;id_str&quot;</span>]);</div>
<div class="line"><span class="lineno">  372</span>         <span class="keywordflow">if</span>(args[<span class="stringliteral">&quot;name&quot;</span>].is&lt;const char*&gt;()) info.<a class="code hl_function" href="struct_filament_info.html#a6bb1d50ec33de9366132999b3a84ff3c">SetName</a>(args[<span class="stringliteral">&quot;name&quot;</span>]);</div>
<div class="line"><span class="lineno">  373</span>         <span class="keywordflow">if</span>(args[<span class="stringliteral">&quot;temp_min&quot;</span>].is&lt;int&gt;()) info.<a class="code hl_variable" href="struct_filament_info.html#a5868192ee8a9087a32bc1b242024aa72">temperature_min</a> = args[<span class="stringliteral">&quot;temp_min&quot;</span>];</div>
<div class="line"><span class="lineno">  374</span>         <span class="keywordflow">if</span>(args[<span class="stringliteral">&quot;temp_max&quot;</span>].is&lt;int&gt;()) info.<a class="code hl_variable" href="struct_filament_info.html#a45dff2f7e9e7b3794d9ff6469f50113f">temperature_max</a> = args[<span class="stringliteral">&quot;temp_max&quot;</span>];</div>
<div class="line"><span class="lineno">  375</span>         </div>
<div class="line"><span class="lineno">  376</span>         <span class="keywordflow">if</span>(args[<span class="stringliteral">&quot;color&quot;</span>].is&lt;JsonArray&gt;()) {</div>
<div class="line"><span class="lineno">  377</span>             JsonArray c = args[<span class="stringliteral">&quot;color&quot;</span>];</div>
<div class="line"><span class="lineno">  378</span>             <span class="keywordflow">if</span>(c.size() &gt;= 3) {</div>
<div class="line"><span class="lineno">  379</span>                 info.<a class="code hl_variable" href="struct_filament_info.html#a49b75d4f9105d90760ca96138c8fcf45">color_R</a> = c[0]; info.<a class="code hl_variable" href="struct_filament_info.html#a401880702bfbb50388082ccfc4da0ddd">color_G</a> = c[1]; info.<a class="code hl_variable" href="struct_filament_info.html#ab1c9dff383b15c09a2fad0cf6d7e8714">color_B</a> = c[2];</div>
<div class="line"><span class="lineno">  380</span>                 <span class="keywordflow">if</span>(c.size() &gt; 3) info.<a class="code hl_variable" href="struct_filament_info.html#a72997ce70a6852951aac4a8c907e24ac">color_A</a> = c[3]; <span class="keywordflow">else</span> info.<a class="code hl_variable" href="struct_filament_info.html#a72997ce70a6852951aac4a8c907e24ac">color_A</a> = 255;</div>
<div class="line"><span class="lineno">  381</span>             }</div>
<div class="line"><span class="lineno">  382</span>         }</div>
<div class="line"><span class="lineno">  383</span>         </div>
<div class="line"><span class="lineno">  384</span>         <span class="keywordtype">float</span> meters = -1.0f;</div>
<div class="line"><span class="lineno">  385</span>         <span class="keywordflow">if</span>(args[<span class="stringliteral">&quot;meters&quot;</span>].is&lt;float&gt;()) meters = args[<span class="stringliteral">&quot;meters&quot;</span>];</div>
<div class="line"><span class="lineno">  386</span>         </div>
<div class="line"><span class="lineno">  387</span>         <span class="comment">// Now we are done with args.</span></div>
<div class="line"><span class="lineno">  388</span>         <a class="code hl_function" href="namespace_control_logic.html#a3aed4ef4cb26632467a000c0130b11b4">ControlLogic::SetFilamentInfoAction</a>(lane, info, meters);</div>
<div class="line"><span class="lineno">  389</span>         <a class="code hl_function" href="#a1d7d7986d99cb52ab4feb4826ffc4428">SendOk</a>(<span class="keywordtype">id</span>);</div>
<div class="line"><span class="lineno">  390</span>    }</div>
<div class="ttc" id="anamespace_control_logic_html_a3aed4ef4cb26632467a000c0130b11b4"><div class="ttname"><a href="namespace_control_logic.html#a3aed4ef4cb26632467a000c0130b11b4">ControlLogic::SetFilamentInfoAction</a></div><div class="ttdeci">void SetFilamentInfoAction(int id, const FilamentInfo &amp;info, float meters)</div><div class="ttdoc">Action helper to update filament metadata.</div><div class="ttdef"><b>Definition</b> <a href="_control_logic_8cpp_source.html#l01401">ControlLogic.cpp:1401</a></div></div>
<div class="ttc" id="astruct_filament_info_html"><div class="ttname"><a href="struct_filament_info.html">FilamentInfo</a></div><div class="ttdef"><b>Definition</b> <a href="_unit_state_8h_source.html#l00012">UnitState.h:12</a></div></div>
<div class="ttc" id="astruct_filament_info_html_a45dff2f7e9e7b3794d9ff6469f50113f"><div class="ttname"><a href="struct_filament_info.html#a45dff2f7e9e7b3794d9ff6469f50113f">FilamentInfo::temperature_max</a></div><div class="ttdeci">int16_t temperature_max</div><div class="ttdef"><b>Definition</b> <a href="_unit_state_8h_source.html#l00019">UnitState.h:19</a></div></div>
<div class="ttc" id="astruct_filament_info_html_a5868192ee8a9087a32bc1b242024aa72"><div class="ttname"><a href="struct_filament_info.html#a5868192ee8a9087a32bc1b242024aa72">FilamentInfo::temperature_min</a></div><div class="ttdeci">int16_t temperature_min</div><div class="ttdef"><b>Definition</b> <a href="_unit_state_8h_source.html#l00018">UnitState.h:18</a></div></div>
<div class="ttc" id="astruct_filament_info_html_a6bb1d50ec33de9366132999b3a84ff3c"><div class="ttname"><a href="struct_filament_info.html#a6bb1d50ec33de9366132999b3a84ff3c">FilamentInfo::SetName</a></div><div class="ttdeci">void SetName(const char *new_name)</div><div class="ttdoc">Set the Name of the filament.</div><div class="ttdef"><b>Definition</b> <a href="_control_logic_8cpp_source.html#l00148">ControlLogic.cpp:148</a></div></div>
<div class="ttc" id="astruct_filament_info_html_ac821cbe379c5f19ac753f91adef53851"><div class="ttname"><a href="struct_filament_info.html#ac821cbe379c5f19ac753f91adef53851">FilamentInfo::SetID</a></div><div class="ttdeci">void SetID(const char *new_id)</div><div class="ttdoc">Set the RFID/ID of the filament.</div><div class="ttdef"><b>Definition</b> <a href="_control_logic_8cpp_source.html#l00136">ControlLogic.cpp:136</a></div></div>
<div class="ttc" id="astruct_filament_state_html"><div class="ttname"><a href="struct_filament_state.html">FilamentState</a></div><div class="ttdef"><b>Definition</b> <a href="_unit_state_8h_source.html#l00044">UnitState.h:44</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="_unit_state_8h_source.html#l00017">FilamentInfo::color_A</a>, <a class="el" href="_unit_state_8h_source.html#l00016">FilamentInfo::color_B</a>, <a class="el" href="_unit_state_8h_source.html#l00015">FilamentInfo::color_G</a>, <a class="el" href="_unit_state_8h_source.html#l00014">FilamentInfo::color_R</a>, <a class="el" href="_control_logic_8cpp_source.html#l00062">UnitState::GetFilament()</a>, <a class="el" href="_unit_state_8h_source.html#l00013">FilamentInfo::ID</a>, <a class="el" href="_unit_state_8h_source.html#l00020">FilamentInfo::name</a>, <a class="el" href="_klipper_c_l_i_8cpp_source.html#l00056">SendError()</a>, <a class="el" href="_klipper_c_l_i_8cpp_source.html#l00073">SendOk()</a>, <a class="el" href="_control_logic_8cpp_source.html#l01401">ControlLogic::SetFilamentInfoAction()</a>, <a class="el" href="_control_logic_8cpp_source.html#l00136">FilamentInfo::SetID()</a>, <a class="el" href="_control_logic_8cpp_source.html#l00148">FilamentInfo::SetName()</a>, <a class="el" href="_unit_state_8h_source.html#l00019">FilamentInfo::temperature_max</a>, and <a class="el" href="_unit_state_8h_source.html#l00018">FilamentInfo::temperature_min</a>.</p>

<p class="reference">Referenced by <a class="el" href="_klipper_c_l_i_8cpp_source.html#l00400">ProcessPacket()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespace_klipper_c_l_i_a76547f35e246989843f1870c760ea514_cgraph.png" border="0" usemap="#anamespace_klipper_c_l_i_a76547f35e246989843f1870c760ea514_cgraph" loading="lazy" alt=""/></div>
<map name="anamespace_klipper_c_l_i_a76547f35e246989843f1870c760ea514_cgraph" id="anamespace_klipper_c_l_i_a76547f35e246989843f1870c760ea514_cgraph">
<area shape="rect" title="Handler for SET_FILAMENT_INFO command." alt="" coords="5,136,229,163"/>
<area shape="rect" href="class_unit_state.html#a221a5d98d4e870c593e5bd5ee6621c4c" title="Get the configuration specific to a filament index." alt="" coords="285,5,440,32"/>
<area shape="poly" title=" " alt="" coords="134,133,194,89,234,64,276,42,294,36,290,39,278,46,237,68,197,93,137,138"/>
<area shape="rect" href="namespace_klipper_c_l_i.html#ad0e99d2fdcfd1c0690f850816ac1f67c" title="Helper to send an Error response." alt="" coords="289,56,437,83"/>
<area shape="poly" title=" " alt="" coords="156,133,276,92,301,86,297,89,277,97,158,138"/>
<area shape="rect" href="namespace_klipper_c_l_i.html#a1d7d7986d99cb52ab4feb4826ffc4428" title="Helper to send a Success (OK) response." alt="" coords="294,107,432,133"/>
<area shape="poly" title=" " alt="" coords="228,133,281,129,276,131,230,138"/>
<area shape="rect" href="namespace_control_logic.html#a3aed4ef4cb26632467a000c0130b11b4" title="Action helper to update filament metadata." alt="" coords="277,157,449,200"/>
<area shape="poly" title=" " alt="" coords="229,160,264,166,258,167,230,165"/>
<area shape="rect" href="struct_filament_info.html#ac821cbe379c5f19ac753f91adef53851" title="Set the RFID/ID of the filament." alt="" coords="295,224,430,251"/>
<area shape="poly" title=" " alt="" coords="151,160,278,209,300,219,295,219,276,215,150,166"/>
<area shape="rect" href="struct_filament_info.html#a6bb1d50ec33de9366132999b3a84ff3c" title="Set the Name of the filament." alt="" coords="285,275,441,301"/>
<area shape="poly" title=" " alt="" coords="135,161,196,209,235,236,278,260,294,269,288,269,275,265,233,241,192,213,133,166"/>
<area shape="rect" href="namespace_klipper_c_l_i.html#a9ec392d53485800126189969c2c4981a" title="Serialize and send a JSON response." alt="" coords="506,84,685,111"/>
<area shape="poly" title=" " alt="" coords="437,76,493,84,488,85,438,81"/>
<area shape="rect" href="namespace_hardware.html#ad3ec7cad074d6d73508844a06a7bea50" title="Send a buffer via UART1." alt="" coords="742,84,901,111"/>
<area shape="poly" title=" " alt="" coords="685,95,729,97,724,98,686,100"/>
<area shape="rect" href="namespace_hardware.html#a0ada30189b8e1d1dbec145140849b778" title="Microsecond Delay." alt="" coords="1182,85,1320,112"/>
<area shape="poly" title=" " alt="" coords="901,95,1169,98,1164,99,901,100"/>
<area shape="rect" href="namespace_hardware.html#aaaf02ef3df5811e2ba28dd009eadfaae" title="Send a single byte blocking." alt="" coords="949,111,1134,137"/>
<area shape="poly" title=" " alt="" coords="901,104,936,111,930,111,901,110"/>
<area shape="poly" title=" " alt="" coords="1134,110,1170,108,1164,109,1135,115"/>
<area shape="poly" title=" " alt="" coords="431,111,493,107,488,108,433,116"/>
<area shape="rect" href="namespace_control_logic.html#afe90d7f284c20f90f74787274f01c51b" title="Flag that settings need to be saved." alt="" coords="497,165,694,192"/>
<area shape="poly" title=" " alt="" coords="449,176,484,178,479,179,450,181"/>
<area shape="rect" href="namespace_hardware.html#a8ea28b07408691bc126683a81aa220f3" title="Get System Time in Milliseconds." alt="" coords="754,165,889,192"/>
<area shape="poly" title=" " alt="" coords="695,176,741,178,736,179,695,181"/>
<area shape="rect" href="time64_8cpp.html#a146d483f58902ba0184ce16f728edfb0" title="Get 64&#45;bit System Time in Milliseconds." alt="" coords="999,165,1084,192"/>
<area shape="poly" title=" " alt="" coords="890,176,986,178,980,179,890,181"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespace_klipper_c_l_i_a76547f35e246989843f1870c760ea514_icgraph.png" border="0" usemap="#anamespace_klipper_c_l_i_a76547f35e246989843f1870c760ea514_icgraph" loading="lazy" alt=""/></div>
<map name="anamespace_klipper_c_l_i_a76547f35e246989843f1870c760ea514_icgraph" id="anamespace_klipper_c_l_i_a76547f35e246989843f1870c760ea514_icgraph">
<area shape="rect" title="Handler for SET_FILAMENT_INFO command." alt="" coords="1084,13,1308,40"/>
<area shape="rect" href="namespace_klipper_c_l_i.html#a6089e6db2e7edddf19fdf095b9826c88" title="Parse and Dispatch a JSON Packet." alt="" coords="857,13,1036,40"/>
<area shape="poly" title=" " alt="" coords="1066,27,1037,29,1037,24,1071,27"/>
<area shape="rect" href="namespace_klipper_c_l_i.html#afe96c8a3898aa7a50f68ab6d726860c3" title="Main Execution Loop." alt="" coords="695,13,809,40"/>
<area shape="poly" title=" " alt="" coords="839,27,809,29,809,24,844,27"/>
<area shape="rect" href="namespace_command_router.html#a96ff3718682e9322a64815a3d41d001b" title="Main execution loop for the Router." alt="" coords="494,13,647,40"/>
<area shape="poly" title=" " alt="" coords="677,27,647,29,647,24,682,27"/>
<area shape="rect" href="main_8cpp.html#afe461d27b9c48d5921c00d521181f12f" title="Arduino Main Loop." alt="" coords="401,13,446,40"/>
<area shape="poly" title=" " alt="" coords="476,27,447,29,447,24,481,27"/>
<area shape="rect" href="class_adafruit___neo_pixel.html#a4bcda7a15591065570d3598cbf970be7" title="将RAM中的像素数据传输到NeoPixels。" alt="" coords="188,13,353,40"/>
<area shape="poly" title=" " alt="" coords="383,27,353,29,353,24,388,27"/>
<area shape="rect" href="class_adafruit___neo_pixel.html#a61b1bd003a291520a367ab1712d6265c" title="释放Adafruit_NeoPixel对象，将数据引脚恢复为输入模式。" alt="" coords="5,5,140,48"/>
<area shape="poly" title=" " alt="" coords="170,27,140,29,140,24,175,26"/>
</map>
</div>

</div>
</div>
<a id="a8f239072c1896e64e9f6075edaaea515" name="a8f239072c1896e64e9f6075edaaea515"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8f239072c1896e64e9f6075edaaea515">&#9670;&#160;</a></span>HandleStatus()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void KlipperCLI::HandleStatus </td>
          <td>(</td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>id</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">JsonObject</td>          <td class="paramname"><span class="paramname"><em>args</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Handler for STATUS command. </p>
<p>Returns a comprehensive state of all 4 lanes, including motion state, filament sensors, odometer meters, pressure, and filament metadata. Uses manual string construction to avoid heap memory issues with large JSON. </p>

<p class="definition">Definition at line <a class="el" href="_klipper_c_l_i_8cpp_source.html#l00111">111</a> of file <a class="el" href="_klipper_c_l_i_8cpp_source.html">KlipperCLI.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  111</span>                                               {</div>
<div class="line"><span class="lineno">  112</span>         <span class="comment">// Manual JSON construction to avoid Heap Fragmentation/Overflow</span></div>
<div class="line"><span class="lineno">  113</span>         <span class="comment">// 2048 bytes static buffer for full status</span></div>
<div class="line"><span class="lineno">  114</span>         <span class="keyword">static</span> <span class="keywordtype">char</span> output[2048]; </div>
<div class="line"><span class="lineno">  115</span>         <span class="keywordtype">int</span> offset = 0;</div>
<div class="line"><span class="lineno">  116</span>         </div>
<div class="line"><span class="lineno">  117</span>         <span class="comment">// Header</span></div>
<div class="line"><span class="lineno">  118</span>         offset += snprintf(output + offset, <span class="keyword">sizeof</span>(output) - offset, </div>
<div class="line"><span class="lineno">  119</span>             <span class="stringliteral">&quot;{\&quot;id\&quot;:%d,\&quot;cmd\&quot;:\&quot;STATUS\&quot;,\&quot;ok\&quot;:true,\&quot;lanes\&quot;:[&quot;</span>, <span class="keywordtype">id</span>);</div>
<div class="line"><span class="lineno">  120</span>             </div>
<div class="line"><span class="lineno">  121</span>         uint16_t sensors = <a class="code hl_function" href="namespace_control_logic.html#a4428a845041ff986ccbf2555a62d0656">ControlLogic::GetSensorState</a>();</div>
<div class="line"><span class="lineno">  122</span>         </div>
<div class="line"><span class="lineno">  123</span>         <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0; i&lt;4; i++) {</div>
<div class="line"><span class="lineno">  124</span>            <span class="comment">// Separator</span></div>
<div class="line"><span class="lineno">  125</span>            <span class="keywordflow">if</span>(i &gt; 0) offset += snprintf(output + offset, <span class="keyword">sizeof</span>(output) - offset, <span class="stringliteral">&quot;,&quot;</span>);</div>
<div class="line"><span class="lineno">  126</span>            </div>
<div class="line"><span class="lineno">  127</span>            <span class="keywordtype">int</span> m_val = <a class="code hl_function" href="namespace_control_logic.html#a77da31cf0baa8e886a438b2a9e73a573">ControlLogic::GetLaneMotion</a>(i);</div>
<div class="line"><span class="lineno">  128</span>            <span class="keyword">const</span> <span class="keywordtype">char</span>* m_str = <span class="stringliteral">&quot;Idle&quot;</span>;</div>
<div class="line"><span class="lineno">  129</span>            <span class="keywordflow">switch</span>(m_val) {</div>
<div class="line"><span class="lineno">  130</span>                <span class="keywordflow">case</span> 0: m_str = <span class="stringliteral">&quot;Idle&quot;</span>; <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  131</span>                <span class="keywordflow">case</span> 1: m_str = <span class="stringliteral">&quot;Feed&quot;</span>; <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  132</span>                <span class="keywordflow">case</span> 2: m_str = <span class="stringliteral">&quot;Retract&quot;</span>; <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  133</span>                <span class="keywordflow">case</span> 3: m_str = <span class="stringliteral">&quot;SlowFeed&quot;</span>; <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  134</span>                <span class="keywordflow">case</span> 5: m_str = <span class="stringliteral">&quot;AutoFeed&quot;</span>; <span class="keywordflow">break</span>; </div>
<div class="line"><span class="lineno">  135</span>                <span class="keywordflow">case</span> 7: m_str = <span class="stringliteral">&quot;VelCtrl&quot;</span>; <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  136</span>                <span class="keywordflow">default</span>: m_str = <span class="stringliteral">&quot;Idle&quot;</span>; <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  137</span>            }</div>
<div class="line"><span class="lineno">  138</span>            </div>
<div class="line"><span class="lineno">  139</span>            </div>
<div class="line"><span class="lineno">  140</span>            <a class="code hl_struct" href="struct_filament_state.html">FilamentState</a> &amp;f = <a class="code hl_function" href="class_unit_state.html#a221a5d98d4e870c593e5bd5ee6621c4c">UnitState::GetFilament</a>(i);</div>
<div class="line"><span class="lineno">  141</span>            </div>
<div class="line"><span class="lineno">  142</span>            <span class="comment">// Safe Strings (Null-terminated)</span></div>
<div class="line"><span class="lineno">  143</span>            <span class="keywordtype">char</span> safe_id[9]; memcpy(safe_id, f.<a class="code hl_variable" href="struct_filament_info.html#a26e0e6218d4a40974be5086c2ac89087">ID</a>, 8); safe_id[8]=0;</div>
<div class="line"><span class="lineno">  144</span>            <span class="keywordtype">char</span> safe_name[21]; memcpy(safe_name, f.<a class="code hl_variable" href="struct_filament_info.html#a5bf1b8820cfc338a0e489064670e6672">name</a>, 20); safe_name[20]=0;</div>
<div class="line"><span class="lineno">  145</span>            </div>
<div class="line"><span class="lineno">  146</span>            <span class="comment">// Manual Float formatting (printf %f not supported)</span></div>
<div class="line"><span class="lineno">  147</span>            <span class="keywordtype">int</span> m_int = (int)f.<a class="code hl_variable" href="struct_filament_state.html#aabba44628ec691809d7b13b94b8a507e">meters</a>;</div>
<div class="line"><span class="lineno">  148</span>            <span class="keywordtype">int</span> m_dec = (int)((f.meters - m_int) * 100); </div>
<div class="line"><span class="lineno">  149</span>            <span class="keywordflow">if</span>(m_dec &lt; 0) m_dec = -m_dec; <span class="comment">// Handle negative decimal part if any</span></div>
<div class="line"><span class="lineno">  150</span>            </div>
<div class="line"><span class="lineno">  151</span>            <span class="keywordtype">int</span> p_int = f.pressure / 1000;</div>
<div class="line"><span class="lineno">  152</span>            <span class="keywordtype">int</span> p_dec = f.pressure % 1000;</div>
<div class="line"><span class="lineno">  153</span>            </div>
<div class="line"><span class="lineno">  154</span>            offset += snprintf(output + offset, <span class="keyword">sizeof</span>(output) - offset, </div>
<div class="line"><span class="lineno">  155</span>                <span class="stringliteral">&quot;{\&quot;id\&quot;:%d,\&quot;present\&quot;:%s,\&quot;motion\&quot;:\&quot;%s\&quot;,\&quot;meters\&quot;:%d.%02d,\&quot;pressure\&quot;:%d.%03d,\&quot;rfid\&quot;:\&quot;%s\&quot;,\&quot;name\&quot;:\&quot;%s\&quot;,\&quot;temp_min\&quot;:%d,\&quot;temp_max\&quot;:%d,\&quot;color\&quot;:[%d,%d,%d,%d]}&quot;</span>,</div>
<div class="line"><span class="lineno">  156</span>                i, </div>
<div class="line"><span class="lineno">  157</span>                (sensors &amp; (1&lt;&lt;i)) ? <span class="stringliteral">&quot;true&quot;</span> : <span class="stringliteral">&quot;false&quot;</span>,</div>
<div class="line"><span class="lineno">  158</span>                m_str,</div>
<div class="line"><span class="lineno">  159</span>                m_int, m_dec,</div>
<div class="line"><span class="lineno">  160</span>                p_int, p_dec,</div>
<div class="line"><span class="lineno">  161</span>                safe_id,</div>
<div class="line"><span class="lineno">  162</span>                safe_name,</div>
<div class="line"><span class="lineno">  163</span>                f.temperature_min,</div>
<div class="line"><span class="lineno">  164</span>                f.temperature_max,</div>
<div class="line"><span class="lineno">  165</span>                f.color_R, f.color_G, f.color_B, f.color_A</div>
<div class="line"><span class="lineno">  166</span>            );</div>
<div class="line"><span class="lineno">  167</span>            </div>
<div class="line"><span class="lineno">  168</span>            <span class="comment">// Safety break</span></div>
<div class="line"><span class="lineno">  169</span>            <span class="keywordflow">if</span> (offset &gt;= (<span class="keywordtype">int</span>)<span class="keyword">sizeof</span>(output) - 100) <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  170</span>         }</div>
<div class="line"><span class="lineno">  171</span>         </div>
<div class="line"><span class="lineno">  172</span>         <span class="comment">// Footer</span></div>
<div class="line"><span class="lineno">  173</span>         offset += snprintf(output + offset, <span class="keyword">sizeof</span>(output) - offset, <span class="stringliteral">&quot;]}\r\n&quot;</span>);</div>
<div class="line"><span class="lineno">  174</span>         </div>
<div class="line"><span class="lineno">  175</span>         <span class="comment">// Send</span></div>
<div class="line"><span class="lineno">  176</span>         <a class="code hl_function" href="namespace_hardware.html#ad3ec7cad074d6d73508844a06a7bea50">Hardware::UART_Send</a>((<span class="keyword">const</span> uint8_t*)output, offset);</div>
<div class="line"><span class="lineno">  177</span>    }</div>
<div class="ttc" id="anamespace_control_logic_html_a77da31cf0baa8e886a438b2a9e73a573"><div class="ttname"><a href="namespace_control_logic.html#a77da31cf0baa8e886a438b2a9e73a573">ControlLogic::GetLaneMotion</a></div><div class="ttdeci">int GetLaneMotion(int lane)</div><div class="ttdoc">Get the current motion state of a lane.</div><div class="ttdef"><b>Definition</b> <a href="_control_logic_8cpp_source.html#l00679">ControlLogic.cpp:679</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="_unit_state_8h_source.html#l00017">FilamentInfo::color_A</a>, <a class="el" href="_unit_state_8h_source.html#l00016">FilamentInfo::color_B</a>, <a class="el" href="_unit_state_8h_source.html#l00015">FilamentInfo::color_G</a>, <a class="el" href="_unit_state_8h_source.html#l00014">FilamentInfo::color_R</a>, <a class="el" href="_control_logic_8cpp_source.html#l00062">UnitState::GetFilament()</a>, <a class="el" href="_control_logic_8cpp_source.html#l00679">ControlLogic::GetLaneMotion()</a>, <a class="el" href="_control_logic_8cpp_source.html#l00662">ControlLogic::GetSensorState()</a>, <a class="el" href="_unit_state_8h_source.html#l00013">FilamentInfo::ID</a>, <a class="el" href="_unit_state_8h_source.html#l00047">FilamentState::meters</a>, <a class="el" href="_unit_state_8h_source.html#l00020">FilamentInfo::name</a>, <a class="el" href="_unit_state_8h_source.html#l00051">FilamentState::pressure</a>, <a class="el" href="_unit_state_8h_source.html#l00019">FilamentInfo::temperature_max</a>, <a class="el" href="_unit_state_8h_source.html#l00018">FilamentInfo::temperature_min</a>, and <a class="el" href="_hardware_8cpp_source.html#l00261">Hardware::UART_Send()</a>.</p>

<p class="reference">Referenced by <a class="el" href="_klipper_c_l_i_8cpp_source.html#l00400">ProcessPacket()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespace_klipper_c_l_i_a8f239072c1896e64e9f6075edaaea515_cgraph.png" border="0" usemap="#anamespace_klipper_c_l_i_a8f239072c1896e64e9f6075edaaea515_cgraph" loading="lazy" alt=""/></div>
<map name="anamespace_klipper_c_l_i_a8f239072c1896e64e9f6075edaaea515_cgraph" id="anamespace_klipper_c_l_i_a8f239072c1896e64e9f6075edaaea515_cgraph">
<area shape="rect" title="Handler for STATUS command." alt="" coords="5,81,175,108"/>
<area shape="rect" href="class_unit_state.html#a221a5d98d4e870c593e5bd5ee6621c4c" title="Get the configuration specific to a filament index." alt="" coords="243,5,398,32"/>
<area shape="poly" title=" " alt="" coords="123,78,222,41,249,35,245,38,224,47,126,83"/>
<area shape="rect" href="namespace_control_logic.html#a77da31cf0baa8e886a438b2a9e73a573" title="Get the current motion state of a lane." alt="" coords="225,56,416,83"/>
<area shape="poly" title=" " alt="" coords="174,83,212,80,207,83,176,88"/>
<area shape="rect" href="namespace_control_logic.html#a4428a845041ff986ccbf2555a62d0656" title="Get a bitmask of sensor states." alt="" coords="223,107,418,133"/>
<area shape="poly" title=" " alt="" coords="174,101,209,107,204,108,175,107"/>
<area shape="rect" href="namespace_hardware.html#ad3ec7cad074d6d73508844a06a7bea50" title="Send a buffer via UART1." alt="" coords="241,157,400,184"/>
<area shape="poly" title=" " alt="" coords="125,106,224,143,250,153,244,153,222,148,124,111"/>
<area shape="rect" href="namespace_hardware.html#a0ada30189b8e1d1dbec145140849b778" title="Microsecond Delay." alt="" coords="699,157,838,184"/>
<area shape="poly" title=" " alt="" coords="400,168,686,170,681,171,400,173"/>
<area shape="rect" href="namespace_hardware.html#aaaf02ef3df5811e2ba28dd009eadfaae" title="Send a single byte blocking." alt="" coords="466,183,651,209"/>
<area shape="poly" title=" " alt="" coords="400,176,454,185,448,185,400,182"/>
<area shape="poly" title=" " alt="" coords="651,182,682,181,687,181,652,187"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespace_klipper_c_l_i_a8f239072c1896e64e9f6075edaaea515_icgraph.png" border="0" usemap="#anamespace_klipper_c_l_i_a8f239072c1896e64e9f6075edaaea515_icgraph" loading="lazy" alt=""/></div>
<map name="anamespace_klipper_c_l_i_a8f239072c1896e64e9f6075edaaea515_icgraph" id="anamespace_klipper_c_l_i_a8f239072c1896e64e9f6075edaaea515_icgraph">
<area shape="rect" title="Handler for STATUS command." alt="" coords="1084,13,1254,40"/>
<area shape="rect" href="namespace_klipper_c_l_i.html#a6089e6db2e7edddf19fdf095b9826c88" title="Parse and Dispatch a JSON Packet." alt="" coords="857,13,1036,40"/>
<area shape="poly" title=" " alt="" coords="1066,27,1037,29,1037,24,1071,27"/>
<area shape="rect" href="namespace_klipper_c_l_i.html#afe96c8a3898aa7a50f68ab6d726860c3" title="Main Execution Loop." alt="" coords="695,13,809,40"/>
<area shape="poly" title=" " alt="" coords="839,27,809,29,809,24,844,27"/>
<area shape="rect" href="namespace_command_router.html#a96ff3718682e9322a64815a3d41d001b" title="Main execution loop for the Router." alt="" coords="494,13,647,40"/>
<area shape="poly" title=" " alt="" coords="677,27,647,29,647,24,682,27"/>
<area shape="rect" href="main_8cpp.html#afe461d27b9c48d5921c00d521181f12f" title="Arduino Main Loop." alt="" coords="401,13,446,40"/>
<area shape="poly" title=" " alt="" coords="476,27,447,29,447,24,481,27"/>
<area shape="rect" href="class_adafruit___neo_pixel.html#a4bcda7a15591065570d3598cbf970be7" title="将RAM中的像素数据传输到NeoPixels。" alt="" coords="188,13,353,40"/>
<area shape="poly" title=" " alt="" coords="383,27,353,29,353,24,388,27"/>
<area shape="rect" href="class_adafruit___neo_pixel.html#a61b1bd003a291520a367ab1712d6265c" title="释放Adafruit_NeoPixel对象，将数据引脚恢复为输入模式。" alt="" coords="5,5,140,48"/>
<area shape="poly" title=" " alt="" coords="170,27,140,29,140,24,175,26"/>
</map>
</div>

</div>
</div>
<a id="a5bc1dda1e0b24dccb6fdc1c475930c88" name="a5bc1dda1e0b24dccb6fdc1c475930c88"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5bc1dda1e0b24dccb6fdc1c475930c88">&#9670;&#160;</a></span>HandleStop()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void KlipperCLI::HandleStop </td>
          <td>(</td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>id</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">JsonObject</td>          <td class="paramname"><span class="paramname"><em>args</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Handler for STOP command. </p>
<p>Cancels all motion immediately. </p>

<p class="definition">Definition at line <a class="el" href="_klipper_c_l_i_8cpp_source.html#l00255">255</a> of file <a class="el" href="_klipper_c_l_i_8cpp_source.html">KlipperCLI.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  255</span>                                             {</div>
<div class="line"><span class="lineno">  256</span>        <a class="code hl_function" href="namespace_control_logic.html#af084200798d6b89c1b448bf41b105d62">ControlLogic::StopAll</a>();</div>
<div class="line"><span class="lineno">  257</span>        <a class="code hl_function" href="#a1d7d7986d99cb52ab4feb4826ffc4428">SendOk</a>(<span class="keywordtype">id</span>, <span class="stringliteral">&quot;STOPPED&quot;</span>, <span class="stringliteral">&quot;All motion stopped&quot;</span>);</div>
<div class="line"><span class="lineno">  258</span>    }</div>
<div class="ttc" id="anamespace_control_logic_html_af084200798d6b89c1b448bf41b105d62"><div class="ttname"><a href="namespace_control_logic.html#af084200798d6b89c1b448bf41b105d62">ControlLogic::StopAll</a></div><div class="ttdeci">void StopAll()</div><div class="ttdoc">Stop all motors.</div><div class="ttdef"><b>Definition</b> <a href="_control_logic_8cpp_source.html#l00629">ControlLogic.cpp:629</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="_klipper_c_l_i_8cpp_source.html#l00073">SendOk()</a>, and <a class="el" href="_control_logic_8cpp_source.html#l00629">ControlLogic::StopAll()</a>.</p>

<p class="reference">Referenced by <a class="el" href="_klipper_c_l_i_8cpp_source.html#l00400">ProcessPacket()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespace_klipper_c_l_i_a5bc1dda1e0b24dccb6fdc1c475930c88_cgraph.png" border="0" usemap="#anamespace_klipper_c_l_i_a5bc1dda1e0b24dccb6fdc1c475930c88_cgraph" loading="lazy" alt=""/></div>
<map name="anamespace_klipper_c_l_i_a5bc1dda1e0b24dccb6fdc1c475930c88_cgraph" id="anamespace_klipper_c_l_i_a5bc1dda1e0b24dccb6fdc1c475930c88_cgraph">
<area shape="rect" title="Handler for STOP command." alt="" coords="5,31,164,57"/>
<area shape="rect" href="namespace_klipper_c_l_i.html#a1d7d7986d99cb52ab4feb4826ffc4428" title="Helper to send a Success (OK) response." alt="" coords="215,5,352,32"/>
<area shape="poly" title=" " alt="" coords="164,31,202,29,197,30,165,37"/>
<area shape="rect" href="namespace_control_logic.html#af084200798d6b89c1b448bf41b105d62" title="Stop all motors." alt="" coords="212,56,356,83"/>
<area shape="poly" title=" " alt="" coords="164,51,199,58,194,58,164,57"/>
<area shape="rect" href="namespace_klipper_c_l_i.html#a9ec392d53485800126189969c2c4981a" title="Serialize and send a JSON response." alt="" coords="404,5,583,32"/>
<area shape="poly" title=" " alt="" coords="353,16,391,18,386,19,353,21"/>
<area shape="rect" href="namespace_hardware.html#ad3ec7cad074d6d73508844a06a7bea50" title="Send a buffer via UART1." alt="" coords="631,5,790,32"/>
<area shape="poly" title=" " alt="" coords="584,16,618,19,613,19,584,21"/>
<area shape="rect" href="namespace_hardware.html#a0ada30189b8e1d1dbec145140849b778" title="Microsecond Delay." alt="" coords="1071,5,1209,32"/>
<area shape="poly" title=" " alt="" coords="790,16,1058,19,1053,19,790,21"/>
<area shape="rect" href="namespace_hardware.html#aaaf02ef3df5811e2ba28dd009eadfaae" title="Send a single byte blocking." alt="" coords="838,31,1023,57"/>
<area shape="poly" title=" " alt="" coords="790,25,825,32,819,31,790,30"/>
<area shape="poly" title=" " alt="" coords="1023,30,1053,29,1059,29,1023,35"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespace_klipper_c_l_i_a5bc1dda1e0b24dccb6fdc1c475930c88_icgraph.png" border="0" usemap="#anamespace_klipper_c_l_i_a5bc1dda1e0b24dccb6fdc1c475930c88_icgraph" loading="lazy" alt=""/></div>
<map name="anamespace_klipper_c_l_i_a5bc1dda1e0b24dccb6fdc1c475930c88_icgraph" id="anamespace_klipper_c_l_i_a5bc1dda1e0b24dccb6fdc1c475930c88_icgraph">
<area shape="rect" title="Handler for STOP command." alt="" coords="1084,13,1243,40"/>
<area shape="rect" href="namespace_klipper_c_l_i.html#a6089e6db2e7edddf19fdf095b9826c88" title="Parse and Dispatch a JSON Packet." alt="" coords="857,13,1036,40"/>
<area shape="poly" title=" " alt="" coords="1067,27,1037,29,1037,24,1072,27"/>
<area shape="rect" href="namespace_klipper_c_l_i.html#afe96c8a3898aa7a50f68ab6d726860c3" title="Main Execution Loop." alt="" coords="695,13,809,40"/>
<area shape="poly" title=" " alt="" coords="839,27,809,29,809,24,844,27"/>
<area shape="rect" href="namespace_command_router.html#a96ff3718682e9322a64815a3d41d001b" title="Main execution loop for the Router." alt="" coords="494,13,647,40"/>
<area shape="poly" title=" " alt="" coords="677,27,647,29,647,24,682,27"/>
<area shape="rect" href="main_8cpp.html#afe461d27b9c48d5921c00d521181f12f" title="Arduino Main Loop." alt="" coords="401,13,446,40"/>
<area shape="poly" title=" " alt="" coords="476,27,447,29,447,24,481,27"/>
<area shape="rect" href="class_adafruit___neo_pixel.html#a4bcda7a15591065570d3598cbf970be7" title="将RAM中的像素数据传输到NeoPixels。" alt="" coords="188,13,353,40"/>
<area shape="poly" title=" " alt="" coords="383,27,353,29,353,24,388,27"/>
<area shape="rect" href="class_adafruit___neo_pixel.html#a61b1bd003a291520a367ab1712d6265c" title="释放Adafruit_NeoPixel对象，将数据引脚恢复为输入模式。" alt="" coords="5,5,140,48"/>
<area shape="poly" title=" " alt="" coords="170,27,140,29,140,24,175,26"/>
</map>
</div>

</div>
</div>
<a id="a5498861593ca8083d7be1d71c8373f29" name="a5498861593ca8083d7be1d71c8373f29"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5498861593ca8083d7be1d71c8373f29">&#9670;&#160;</a></span>Init()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void KlipperCLI::Init </td>
          <td>(</td>
          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Initialize Klipper CLI. </p>
<p>Sends a startup message. </p>

<p class="definition">Definition at line <a class="el" href="_klipper_c_l_i_8cpp_source.html#l00439">439</a> of file <a class="el" href="_klipper_c_l_i_8cpp_source.html">KlipperCLI.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  439</span>                {</div>
<div class="line"><span class="lineno">  440</span>        <a class="code hl_function" href="namespace_hardware.html#ad3ec7cad074d6d73508844a06a7bea50">Hardware::UART_Send</a>((<span class="keyword">const</span> uint8_t*)<span class="stringliteral">&quot;{\&quot;event\&quot;:\&quot;STARTUP\&quot;,\&quot;msg\&quot;:\&quot;KlipperCLI Ready\&quot;}\r\n&quot;</span>, 52);</div>
<div class="line"><span class="lineno">  441</span>    }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="_hardware_8cpp_source.html#l00261">Hardware::UART_Send()</a>.</p>

<p class="reference">Referenced by <a class="el" href="_command_router_8cpp_source.html#l00076">CommandRouter::Init()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespace_klipper_c_l_i_a5498861593ca8083d7be1d71c8373f29_cgraph.png" border="0" usemap="#anamespace_klipper_c_l_i_a5498861593ca8083d7be1d71c8373f29_cgraph" loading="lazy" alt=""/></div>
<map name="anamespace_klipper_c_l_i_a5498861593ca8083d7be1d71c8373f29_cgraph" id="anamespace_klipper_c_l_i_a5498861593ca8083d7be1d71c8373f29_cgraph">
<area shape="rect" title="Initialize Klipper CLI." alt="" coords="5,5,114,32"/>
<area shape="rect" href="namespace_hardware.html#ad3ec7cad074d6d73508844a06a7bea50" title="Send a buffer via UART1." alt="" coords="162,5,320,32"/>
<area shape="poly" title=" " alt="" coords="114,16,149,18,144,19,114,21"/>
<area shape="rect" href="namespace_hardware.html#a0ada30189b8e1d1dbec145140849b778" title="Microsecond Delay." alt="" coords="601,5,740,32"/>
<area shape="poly" title=" " alt="" coords="320,16,588,18,583,20,321,21"/>
<area shape="rect" href="namespace_hardware.html#aaaf02ef3df5811e2ba28dd009eadfaae" title="Send a single byte blocking." alt="" coords="368,31,553,57"/>
<area shape="poly" title=" " alt="" coords="321,25,355,32,350,32,320,30"/>
<area shape="poly" title=" " alt="" coords="553,30,584,29,589,29,554,35"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespace_klipper_c_l_i_a5498861593ca8083d7be1d71c8373f29_icgraph.png" border="0" usemap="#anamespace_klipper_c_l_i_a5498861593ca8083d7be1d71c8373f29_icgraph" loading="lazy" alt=""/></div>
<map name="anamespace_klipper_c_l_i_a5498861593ca8083d7be1d71c8373f29_icgraph" id="anamespace_klipper_c_l_i_a5498861593ca8083d7be1d71c8373f29_icgraph">
<area shape="rect" title="Initialize Klipper CLI." alt="" coords="301,5,409,32"/>
<area shape="rect" href="namespace_command_router.html#a652cfc164ac7a2a2c016da37f341c42e" title="Initialize the Command Router and CLI subsystems." alt="" coords="107,5,253,32"/>
<area shape="poly" title=" " alt="" coords="283,19,254,21,254,16,288,19"/>
<area shape="rect" href="main_8cpp.html#a4fc01d736fe50cf5b977f755b675f11d" title="Arduino Setup Function." alt="" coords="5,5,59,32"/>
<area shape="poly" title=" " alt="" coords="89,19,59,21,59,16,94,18"/>
</map>
</div>

</div>
</div>
<a id="a64e906ee320307e1634a6bad079e2657" name="a64e906ee320307e1634a6bad079e2657"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a64e906ee320307e1634a6bad079e2657">&#9670;&#160;</a></span>IsConnected()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool KlipperCLI::IsConnected </td>
          <td>(</td>
          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a6089e6db2e7edddf19fdf095b9826c88" name="a6089e6db2e7edddf19fdf095b9826c88"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6089e6db2e7edddf19fdf095b9826c88">&#9670;&#160;</a></span>ProcessPacket()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void KlipperCLI::ProcessPacket </td>
          <td>(</td>
          <td class="paramtype">char *</td>          <td class="paramname"><span class="paramname"><em>json_str</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Parse and Dispatch a JSON Packet. </p>
<p>Deserializes the buffer and routes to the appropriate handler based on "cmd". </p>

<p class="definition">Definition at line <a class="el" href="_klipper_c_l_i_8cpp_source.html#l00400">400</a> of file <a class="el" href="_klipper_c_l_i_8cpp_source.html">KlipperCLI.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  400</span>                                       {</div>
<div class="line"><span class="lineno">  401</span>        <a class="code hl_variable" href="#adf80752c24e066ed02f3864069ff9707">doc</a>.clear();</div>
<div class="line"><span class="lineno">  402</span>        DeserializationError error = deserializeJson(<a class="code hl_variable" href="#adf80752c24e066ed02f3864069ff9707">doc</a>, json_str);</div>
<div class="line"><span class="lineno">  403</span> </div>
<div class="line"><span class="lineno">  404</span>        <span class="keywordflow">if</span> (error) {</div>
<div class="line"><span class="lineno">  405</span>            <span class="comment">// Malformed JSON, maybe echo back error if possible, or ignore</span></div>
<div class="line"><span class="lineno">  406</span>            <span class="keyword">const</span> <span class="keywordtype">char</span>* err_msg = <span class="stringliteral">&quot;{\&quot;ok\&quot;:false,\&quot;msg\&quot;:\&quot;JSON Parse Error\&quot;}\n&quot;</span>;</div>
<div class="line"><span class="lineno">  407</span>            <a class="code hl_function" href="namespace_hardware.html#ad3ec7cad074d6d73508844a06a7bea50">Hardware::UART_Send</a>((<span class="keyword">const</span> uint8_t*)err_msg, strlen(err_msg));</div>
<div class="line"><span class="lineno">  408</span>            <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno">  409</span>        }</div>
<div class="line"><span class="lineno">  410</span> </div>
<div class="line"><span class="lineno">  411</span>        <span class="keywordtype">int</span> <span class="keywordtype">id</span> = <a class="code hl_variable" href="#adf80752c24e066ed02f3864069ff9707">doc</a>[<span class="stringliteral">&quot;id&quot;</span>] | 0;</div>
<div class="line"><span class="lineno">  412</span>        <span class="keyword">const</span> <span class="keywordtype">char</span>* cmd = <a class="code hl_variable" href="#adf80752c24e066ed02f3864069ff9707">doc</a>[<span class="stringliteral">&quot;cmd&quot;</span>];</div>
<div class="line"><span class="lineno">  413</span>        JsonObject args = <a class="code hl_variable" href="#adf80752c24e066ed02f3864069ff9707">doc</a>[<span class="stringliteral">&quot;args&quot;</span>];</div>
<div class="line"><span class="lineno">  414</span> </div>
<div class="line"><span class="lineno">  415</span>        <span class="keywordflow">if</span> (!cmd) <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno">  416</span> </div>
<div class="line"><span class="lineno">  417</span>        <span class="keywordflow">if</span> (strcmp(cmd, <span class="stringliteral">&quot;PING&quot;</span>) == 0) <a class="code hl_function" href="#a81f1646e6adb42482d4109a33b9bb9c5">HandlePing</a>(<span class="keywordtype">id</span>, args);</div>
<div class="line"><span class="lineno">  418</span>        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (strcmp(cmd, <span class="stringliteral">&quot;STATUS&quot;</span>) == 0) <a class="code hl_function" href="#a8f239072c1896e64e9f6075edaaea515">HandleStatus</a>(<span class="keywordtype">id</span>, args);</div>
<div class="line"><span class="lineno">  419</span>        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (strcmp(cmd, <span class="stringliteral">&quot;GET_SENSORS&quot;</span>) == 0) <a class="code hl_function" href="#ae13dcd8cc2528c12d0a241046fcc304e">HandleGetSensors</a>(<span class="keywordtype">id</span>, args);</div>
<div class="line"><span class="lineno">  420</span>        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (strcmp(cmd, <span class="stringliteral">&quot;MOVE&quot;</span>) == 0) <a class="code hl_function" href="#a12cef4b97fbfa7cfb7bdb1540e626ae9">HandleMove</a>(<span class="keywordtype">id</span>, args);</div>
<div class="line"><span class="lineno">  421</span>        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (strcmp(cmd, <span class="stringliteral">&quot;STOP&quot;</span>) == 0) <a class="code hl_function" href="#a5bc1dda1e0b24dccb6fdc1c475930c88">HandleStop</a>(<span class="keywordtype">id</span>, args);</div>
<div class="line"><span class="lineno">  422</span>        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (strcmp(cmd, <span class="stringliteral">&quot;SELECT_LANE&quot;</span>) == 0) <a class="code hl_function" href="#a685b6d688593b458b5edafda4adfd4d4">HandleSelectLane</a>(<span class="keywordtype">id</span>, args);</div>
<div class="line"><span class="lineno">  423</span>        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (strcmp(cmd, <span class="stringliteral">&quot;SET_AUTO_FEED&quot;</span>) == 0) <a class="code hl_function" href="#a31ef4dae129916b85fdd8d1612553c77">HandleSetAutoFeed</a>(<span class="keywordtype">id</span>, args);</div>
<div class="line"><span class="lineno">  424</span>        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (strcmp(cmd, <span class="stringliteral">&quot;GET_FILAMENT_INFO&quot;</span>) == 0) <a class="code hl_function" href="#afeb304003d4b85010afd5e183e1bbf16">HandleGetFilamentInfo</a>(<span class="keywordtype">id</span>, args);</div>
<div class="line"><span class="lineno">  425</span>        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (strcmp(cmd, <span class="stringliteral">&quot;SET_FILAMENT_INFO&quot;</span>) == 0) <a class="code hl_function" href="#a76547f35e246989843f1870c760ea514">HandleSetFilamentInfo</a>(<span class="keywordtype">id</span>, args);</div>
<div class="line"><span class="lineno">  426</span>        <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  427</span>            <a class="code hl_function" href="#ad0e99d2fdcfd1c0690f850816ac1f67c">SendError</a>(<span class="keywordtype">id</span>, <span class="stringliteral">&quot;UNKNOWN_CMD&quot;</span>, cmd);</div>
<div class="line"><span class="lineno">  428</span>        }</div>
<div class="line"><span class="lineno">  429</span>    }</div>
<div class="ttc" id="anamespace_klipper_c_l_i_html_a12cef4b97fbfa7cfb7bdb1540e626ae9"><div class="ttname"><a href="#a12cef4b97fbfa7cfb7bdb1540e626ae9">KlipperCLI::HandleMove</a></div><div class="ttdeci">void HandleMove(int id, JsonObject args)</div><div class="ttdoc">Handler for MOVE command.</div><div class="ttdef"><b>Definition</b> <a href="_klipper_c_l_i_8cpp_source.html#l00208">KlipperCLI.cpp:208</a></div></div>
<div class="ttc" id="anamespace_klipper_c_l_i_html_a31ef4dae129916b85fdd8d1612553c77"><div class="ttname"><a href="#a31ef4dae129916b85fdd8d1612553c77">KlipperCLI::HandleSetAutoFeed</a></div><div class="ttdeci">void HandleSetAutoFeed(int id, JsonObject args)</div><div class="ttdoc">Handler for SET_AUTO_FEED command.</div><div class="ttdef"><b>Definition</b> <a href="_klipper_c_l_i_8cpp_source.html#l00288">KlipperCLI.cpp:288</a></div></div>
<div class="ttc" id="anamespace_klipper_c_l_i_html_a5bc1dda1e0b24dccb6fdc1c475930c88"><div class="ttname"><a href="#a5bc1dda1e0b24dccb6fdc1c475930c88">KlipperCLI::HandleStop</a></div><div class="ttdeci">void HandleStop(int id, JsonObject args)</div><div class="ttdoc">Handler for STOP command.</div><div class="ttdef"><b>Definition</b> <a href="_klipper_c_l_i_8cpp_source.html#l00255">KlipperCLI.cpp:255</a></div></div>
<div class="ttc" id="anamespace_klipper_c_l_i_html_a685b6d688593b458b5edafda4adfd4d4"><div class="ttname"><a href="#a685b6d688593b458b5edafda4adfd4d4">KlipperCLI::HandleSelectLane</a></div><div class="ttdeci">void HandleSelectLane(int id, JsonObject args)</div><div class="ttdoc">Handler for SELECT_LANE command.</div><div class="ttdef"><b>Definition</b> <a href="_klipper_c_l_i_8cpp_source.html#l00268">KlipperCLI.cpp:268</a></div></div>
<div class="ttc" id="anamespace_klipper_c_l_i_html_a76547f35e246989843f1870c760ea514"><div class="ttname"><a href="#a76547f35e246989843f1870c760ea514">KlipperCLI::HandleSetFilamentInfo</a></div><div class="ttdeci">void HandleSetFilamentInfo(int id, JsonObject args)</div><div class="ttdoc">Handler for SET_FILAMENT_INFO command.</div><div class="ttdef"><b>Definition</b> <a href="_klipper_c_l_i_8cpp_source.html#l00347">KlipperCLI.cpp:347</a></div></div>
<div class="ttc" id="anamespace_klipper_c_l_i_html_a81f1646e6adb42482d4109a33b9bb9c5"><div class="ttname"><a href="#a81f1646e6adb42482d4109a33b9bb9c5">KlipperCLI::HandlePing</a></div><div class="ttdeci">void HandlePing(int id, JsonObject args)</div><div class="ttdoc">Handler for PING command.</div><div class="ttdef"><b>Definition</b> <a href="_klipper_c_l_i_8cpp_source.html#l00090">KlipperCLI.cpp:90</a></div></div>
<div class="ttc" id="anamespace_klipper_c_l_i_html_a8f239072c1896e64e9f6075edaaea515"><div class="ttname"><a href="#a8f239072c1896e64e9f6075edaaea515">KlipperCLI::HandleStatus</a></div><div class="ttdeci">void HandleStatus(int id, JsonObject args)</div><div class="ttdoc">Handler for STATUS command.</div><div class="ttdef"><b>Definition</b> <a href="_klipper_c_l_i_8cpp_source.html#l00111">KlipperCLI.cpp:111</a></div></div>
<div class="ttc" id="anamespace_klipper_c_l_i_html_ae13dcd8cc2528c12d0a241046fcc304e"><div class="ttname"><a href="#ae13dcd8cc2528c12d0a241046fcc304e">KlipperCLI::HandleGetSensors</a></div><div class="ttdeci">void HandleGetSensors(int id, JsonObject args)</div><div class="ttdoc">Handler for GET_SENSORS command.</div><div class="ttdef"><b>Definition</b> <a href="_klipper_c_l_i_8cpp_source.html#l00185">KlipperCLI.cpp:185</a></div></div>
<div class="ttc" id="anamespace_klipper_c_l_i_html_afeb304003d4b85010afd5e183e1bbf16"><div class="ttname"><a href="#afeb304003d4b85010afd5e183e1bbf16">KlipperCLI::HandleGetFilamentInfo</a></div><div class="ttdeci">void HandleGetFilamentInfo(int id, JsonObject args)</div><div class="ttdoc">Handler for GET_FILAMENT_INFO command.</div><div class="ttdef"><b>Definition</b> <a href="_klipper_c_l_i_8cpp_source.html#l00305">KlipperCLI.cpp:305</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="_klipper_c_l_i_8cpp_source.html#l00024">doc</a>, <a class="el" href="_klipper_c_l_i_8cpp_source.html#l00305">HandleGetFilamentInfo()</a>, <a class="el" href="_klipper_c_l_i_8cpp_source.html#l00185">HandleGetSensors()</a>, <a class="el" href="_klipper_c_l_i_8cpp_source.html#l00208">HandleMove()</a>, <a class="el" href="_klipper_c_l_i_8cpp_source.html#l00090">HandlePing()</a>, <a class="el" href="_klipper_c_l_i_8cpp_source.html#l00268">HandleSelectLane()</a>, <a class="el" href="_klipper_c_l_i_8cpp_source.html#l00288">HandleSetAutoFeed()</a>, <a class="el" href="_klipper_c_l_i_8cpp_source.html#l00347">HandleSetFilamentInfo()</a>, <a class="el" href="_klipper_c_l_i_8cpp_source.html#l00111">HandleStatus()</a>, <a class="el" href="_klipper_c_l_i_8cpp_source.html#l00255">HandleStop()</a>, <a class="el" href="_klipper_c_l_i_8cpp_source.html#l00056">SendError()</a>, and <a class="el" href="_hardware_8cpp_source.html#l00261">Hardware::UART_Send()</a>.</p>

<p class="reference">Referenced by <a class="el" href="_klipper_c_l_i_8cpp_source.html#l00449">Run()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespace_klipper_c_l_i_a6089e6db2e7edddf19fdf095b9826c88_cgraph.png" border="0" usemap="#anamespace_klipper_c_l_i_a6089e6db2e7edddf19fdf095b9826c88_cgraph" loading="lazy" alt=""/></div>
<map name="anamespace_klipper_c_l_i_a6089e6db2e7edddf19fdf095b9826c88_cgraph" id="anamespace_klipper_c_l_i_a6089e6db2e7edddf19fdf095b9826c88_cgraph">
<area shape="rect" title="Parse and Dispatch a JSON Packet." alt="" coords="5,517,185,544"/>
<area shape="rect" href="namespace_klipper_c_l_i.html#afeb304003d4b85010afd5e183e1bbf16" title="Handler for GET_FILAMENT_INFO command." alt="" coords="233,295,457,321"/>
<area shape="poly" title=" " alt="" coords="106,515,158,457,231,386,311,328,308,332,234,390,162,461,110,518"/>
<area shape="rect" href="namespace_klipper_c_l_i.html#ad0e99d2fdcfd1c0690f850816ac1f67c" title="Helper to send an Error response." alt="" coords="530,459,678,485"/>
<area shape="poly" title=" " alt="" coords="163,514,232,503,381,486,517,476,512,479,382,491,233,508,166,519"/>
<area shape="rect" href="namespace_hardware.html#ad3ec7cad074d6d73508844a06a7bea50" title="Send a buffer via UART1." alt="" coords="997,349,1155,376"/>
<area shape="poly" title=" " alt="" coords="107,542,160,600,195,633,234,663,355,745,410,776,462,800,516,814,572,816,633,805,702,780,769,743,831,695,886,640,935,583,977,525,1012,471,1059,392,1063,388,1017,474,982,528,939,586,890,644,834,699,772,747,704,785,635,811,572,821,515,819,460,805,407,781,353,749,231,667,192,637,156,603,107,547"/>
<area shape="rect" href="namespace_klipper_c_l_i.html#ae13dcd8cc2528c12d0a241046fcc304e" title="Handler for GET_SENSORS command." alt="" coords="245,139,445,165"/>
<area shape="poly" title=" " alt="" coords="100,516,150,416,188,348,230,281,275,223,321,175,318,179,280,226,235,284,193,351,155,419,105,518"/>
<area shape="rect" href="namespace_klipper_c_l_i.html#a12cef4b97fbfa7cfb7bdb1540e626ae9" title="Handler for MOVE command." alt="" coords="263,627,426,653"/>
<area shape="poly" title=" " alt="" coords="115,542,169,575,234,608,267,621,262,623,232,613,166,580,116,547"/>
<area shape="rect" href="namespace_klipper_c_l_i.html#a81f1646e6adb42482d4109a33b9bb9c5" title="Handler for PING command." alt="" coords="526,896,683,923"/>
<area shape="poly" title=" " alt="" coords="97,542,105,608,125,702,142,752,165,801,196,845,234,882,268,902,304,916,343,926,382,931,460,931,525,926,531,926,460,937,382,936,342,931,303,922,265,907,231,886,191,849,160,804,137,754,119,703,100,609,96,547"/>
<area shape="rect" href="namespace_klipper_c_l_i.html#a685b6d688593b458b5edafda4adfd4d4" title="Handler for SELECT_LANE command." alt="" coords="247,517,443,544"/>
<area shape="poly" title=" " alt="" coords="184,528,233,529,229,532,186,533"/>
<area shape="rect" href="namespace_klipper_c_l_i.html#a31ef4dae129916b85fdd8d1612553c77" title="Handler for SET_AUTO_FEED command." alt="" coords="241,572,448,599"/>
<area shape="poly" title=" " alt="" coords="159,542,268,567,264,570,160,547"/>
<area shape="rect" href="namespace_klipper_c_l_i.html#a76547f35e246989843f1870c760ea514" title="Handler for SET_FILAMENT_INFO command." alt="" coords="233,400,456,427"/>
<area shape="poly" title=" " alt="" coords="118,515,232,455,293,431,289,435,234,460,122,519"/>
<area shape="rect" href="namespace_klipper_c_l_i.html#a8f239072c1896e64e9f6075edaaea515" title="Handler for STATUS command." alt="" coords="260,88,430,115"/>
<area shape="poly" title=" " alt="" coords="94,517,98,447,105,397,117,341,134,283,158,225,190,171,231,125,247,115,244,119,234,129,194,174,163,227,139,284,122,342,111,398,104,448,99,517"/>
<area shape="rect" href="namespace_klipper_c_l_i.html#a5bc1dda1e0b24dccb6fdc1c475930c88" title="Handler for STOP command." alt="" coords="266,845,424,872"/>
<area shape="poly" title=" " alt="" coords="99,542,113,597,137,673,154,714,176,754,203,792,234,825,254,839,249,839,231,829,199,795,172,757,149,716,132,674,107,598,98,547"/>
<area shape="rect" href="class_unit_state.html#a221a5d98d4e870c593e5bd5ee6621c4c" title="Get the configuration specific to a filament index." alt="" coords="526,189,682,216"/>
<area shape="poly" title=" " alt="" coords="372,292,504,232,544,220,540,223,506,237,375,296"/>
<area shape="poly" title=" " alt="" coords="368,319,413,348,459,386,473,403,482,418,491,431,507,444,518,452,513,453,503,449,487,435,477,421,469,406,455,390,410,353,369,324"/>
<area shape="poly" title=" " alt="" coords="406,292,505,276,604,269,704,276,789,289,873,306,1016,344,1011,345,872,311,788,294,703,281,604,275,505,281,409,296"/>
<area shape="rect" href="namespace_klipper_c_l_i.html#a9ec392d53485800126189969c2c4981a" title="Serialize and send a JSON response." alt="" coords="760,459,940,485"/>
<area shape="poly" title=" " alt="" coords="678,469,747,471,742,473,679,475"/>
<area shape="poly" title=" " alt="" coords="906,456,948,440,999,412,1042,387,1046,384,1001,417,950,445,908,461"/>
<area shape="rect" href="namespace_hardware.html#a0ada30189b8e1d1dbec145140849b778" title="Microsecond Delay." alt="" coords="1436,349,1575,376"/>
<area shape="poly" title=" " alt="" coords="1155,360,1423,362,1418,363,1156,365"/>
<area shape="rect" href="namespace_hardware.html#aaaf02ef3df5811e2ba28dd009eadfaae" title="Send a single byte blocking." alt="" coords="1203,324,1388,351"/>
<area shape="poly" title=" " alt="" coords="1155,351,1190,349,1185,351,1156,356"/>
<area shape="poly" title=" " alt="" coords="1388,346,1424,352,1419,353,1389,351"/>
<area shape="poly" title=" " alt="" coords="444,144,519,142,595,145,661,155,687,164,705,175,730,207,740,240,739,273,733,307,727,341,725,375,732,408,753,441,762,451,757,450,749,444,728,410,720,375,722,340,728,306,734,273,735,240,725,209,702,179,684,169,660,161,595,151,519,147,447,148"/>
<area shape="rect" href="namespace_control_logic.html#a4428a845041ff986ccbf2555a62d0656" title="Get a bitmask of sensor states." alt="" coords="506,88,702,115"/>
<area shape="poly" title=" " alt="" coords="416,136,520,116,516,120,418,140"/>
<area shape="poly" title=" " alt="" coords="425,626,455,609,467,595,474,582,478,554,483,524,491,509,503,495,518,488,514,491,507,499,495,512,488,526,484,554,479,584,471,598,459,613,428,630"/>
<area shape="rect" href="class_unit_state.html#a4833e917e0069069c7f455a24e28a516" title="Get the currently active filament index." alt="" coords="505,728,703,771"/>
<area shape="poly" title=" " alt="" coords="373,651,506,714,523,722,518,722,504,718,372,657"/>
<area shape="rect" href="namespace_control_logic.html#a484eadc314267f8bc9aa0f025c1137d9" title="Manually move an axis (Klipper Primitive)." alt="" coords="524,677,684,704"/>
<area shape="poly" title=" " alt="" coords="417,651,520,673,515,675,417,657"/>
<area shape="rect" href="namespace_klipper_c_l_i.html#a1d7d7986d99cb52ab4feb4826ffc4428" title="Helper to send a Success (OK) response." alt="" coords="536,627,673,653"/>
<area shape="poly" title=" " alt="" coords="426,637,522,639,517,641,428,643"/>
<area shape="poly" title=" " alt="" coords="672,625,702,612,740,586,775,555,827,499,832,496,779,559,744,590,705,617,674,630"/>
<area shape="poly" title=" " alt="" coords="683,894,702,882,740,839,771,789,796,735,814,680,836,577,846,503,849,499,842,578,819,682,801,737,776,791,744,842,705,886,684,899"/>
<area shape="rect" href="namespace_hardware.html#a8ea28b07408691bc126683a81aa220f3" title="Get System Time in Milliseconds." alt="" coords="1008,593,1144,620"/>
<area shape="poly" title=" " alt="" coords="676,893,839,857,909,839,947,824,970,804,991,781,1024,729,1048,677,1064,637,1068,634,1053,679,1029,732,995,784,974,808,950,829,911,844,840,863,677,898"/>
<area shape="rect" href="class_unit_state.html#a745286b33e7a2805f9045e22fc0a49ac" title=" " alt="" coords="776,896,924,923"/>
<area shape="poly" title=" " alt="" coords="683,907,763,909,757,909,683,912"/>
<area shape="rect" href="time64_8cpp.html#a146d483f58902ba0184ce16f728edfb0" title="Get 64&#45;bit System Time in Milliseconds." alt="" coords="1253,593,1338,620"/>
<area shape="poly" title=" " alt="" coords="1144,604,1240,606,1235,607,1144,609"/>
<area shape="poly" title=" " alt="" coords="406,514,529,488,525,491,408,519"/>
<area shape="poly" title=" " alt="" coords="422,542,458,558,474,572,483,586,492,600,506,612,524,623,518,623,504,617,488,603,479,589,470,575,456,562,423,547"/>
<area shape="rect" href="class_unit_state.html#a07223951eecac60709753ce07290477d" title="Set the currently active filament index." alt="" coords="506,509,703,552"/>
<area shape="poly" title=" " alt="" coords="443,528,492,530,487,532,444,533"/>
<area shape="poly" title=" " alt="" coords="423,569,456,554,470,540,479,525,487,510,503,495,518,490,514,493,507,499,492,513,483,528,475,543,458,558,425,574"/>
<area shape="poly" title=" " alt="" coords="411,597,525,622,520,624,412,602"/>
<area shape="rect" href="namespace_control_logic.html#a9db355302a1c9d608e6dd5341151336e" title="Enable/Disable Auto&#45;Feed (Pressure Control) for a lane." alt="" coords="515,576,693,603"/>
<area shape="poly" title=" " alt="" coords="448,584,502,587,497,589,450,590"/>
<area shape="poly" title=" " alt="" coords="367,397,409,368,455,331,479,304,503,277,573,223,569,227,507,281,483,308,459,335,412,373,370,401"/>
<area shape="poly" title=" " alt="" coords="406,425,530,454,525,456,408,430"/>
<area shape="poly" title=" " alt="" coords="368,424,414,458,438,480,459,504,475,535,480,562,487,588,507,613,524,625,519,625,503,617,483,590,475,564,470,536,455,507,434,483,411,462,369,430"/>
<area shape="rect" href="namespace_control_logic.html#a3aed4ef4cb26632467a000c0130b11b4" title="Action helper to update filament metadata." alt="" coords="518,392,690,435"/>
<area shape="poly" title=" " alt="" coords="456,411,505,412,500,415,458,416"/>
<area shape="rect" href="struct_filament_info.html#ac821cbe379c5f19ac753f91adef53851" title="Set the RFID/ID of the filament." alt="" coords="536,341,672,368"/>
<area shape="poly" title=" " alt="" coords="406,397,529,370,525,374,408,402"/>
<area shape="rect" href="struct_filament_info.html#a6bb1d50ec33de9366132999b3a84ff3c" title="Set the Name of the filament." alt="" coords="526,291,682,317"/>
<area shape="poly" title=" " alt="" coords="367,397,428,363,504,327,528,321,523,324,506,332,430,367,370,401"/>
<area shape="rect" href="namespace_control_logic.html#afe90d7f284c20f90f74787274f01c51b" title="Flag that settings need to be saved." alt="" coords="751,404,949,431"/>
<area shape="poly" title=" " alt="" coords="690,412,738,415,733,416,692,417"/>
<area shape="poly" title=" " alt="" coords="917,428,950,444,987,475,1018,511,1063,580,1058,579,1014,515,983,479,947,449,917,434"/>
<area shape="poly" title=" " alt="" coords="418,113,458,124,517,151,570,180,565,182,515,155,456,129,420,118"/>
<area shape="poly" title=" " alt="" coords="365,86,426,52,464,35,504,23,560,10,605,3,650,7,704,23,766,52,824,90,878,133,927,178,1007,267,1060,337,1054,336,1003,271,923,182,875,137,821,94,763,57,702,28,649,12,606,9,561,15,506,28,466,40,428,56,369,89"/>
<area shape="poly" title=" " alt="" coords="429,99,493,100,489,103,431,104"/>
<area shape="rect" href="namespace_control_logic.html#a77da31cf0baa8e886a438b2a9e73a573" title="Get the current motion state of a lane." alt="" coords="509,37,699,64"/>
<area shape="poly" title=" " alt="" coords="416,85,520,66,516,69,418,90"/>
<area shape="poly" title=" " alt="" coords="352,843,372,807,406,758,450,707,476,683,504,663,523,656,519,658,506,668,479,687,454,711,410,761,377,810,355,847"/>
<area shape="rect" href="namespace_control_logic.html#af084200798d6b89c1b448bf41b105d62" title="Stop all motors." alt="" coords="532,845,676,872"/>
<area shape="poly" title=" " alt="" coords="424,856,519,858,514,859,425,861"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespace_klipper_c_l_i_a6089e6db2e7edddf19fdf095b9826c88_icgraph.png" border="0" usemap="#anamespace_klipper_c_l_i_a6089e6db2e7edddf19fdf095b9826c88_icgraph" loading="lazy" alt=""/></div>
<map name="anamespace_klipper_c_l_i_a6089e6db2e7edddf19fdf095b9826c88_icgraph" id="anamespace_klipper_c_l_i_a6089e6db2e7edddf19fdf095b9826c88_icgraph">
<area shape="rect" title="Parse and Dispatch a JSON Packet." alt="" coords="857,13,1036,40"/>
<area shape="rect" href="namespace_klipper_c_l_i.html#afe96c8a3898aa7a50f68ab6d726860c3" title="Main Execution Loop." alt="" coords="695,13,809,40"/>
<area shape="poly" title=" " alt="" coords="839,27,809,29,809,24,844,27"/>
<area shape="rect" href="namespace_command_router.html#a96ff3718682e9322a64815a3d41d001b" title="Main execution loop for the Router." alt="" coords="494,13,647,40"/>
<area shape="poly" title=" " alt="" coords="677,27,647,29,647,24,682,27"/>
<area shape="rect" href="main_8cpp.html#afe461d27b9c48d5921c00d521181f12f" title="Arduino Main Loop." alt="" coords="401,13,446,40"/>
<area shape="poly" title=" " alt="" coords="476,27,447,29,447,24,481,27"/>
<area shape="rect" href="class_adafruit___neo_pixel.html#a4bcda7a15591065570d3598cbf970be7" title="将RAM中的像素数据传输到NeoPixels。" alt="" coords="188,13,353,40"/>
<area shape="poly" title=" " alt="" coords="383,27,353,29,353,24,388,27"/>
<area shape="rect" href="class_adafruit___neo_pixel.html#a61b1bd003a291520a367ab1712d6265c" title="释放Adafruit_NeoPixel对象，将数据引脚恢复为输入模式。" alt="" coords="5,5,140,48"/>
<area shape="poly" title=" " alt="" coords="170,27,140,29,140,24,175,26"/>
</map>
</div>

</div>
</div>
<a id="afe96c8a3898aa7a50f68ab6d726860c3" name="afe96c8a3898aa7a50f68ab6d726860c3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afe96c8a3898aa7a50f68ab6d726860c3">&#9670;&#160;</a></span>Run()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void KlipperCLI::Run </td>
          <td>(</td>
          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Main Execution Loop. </p>
<p>Checks if a full line is received, processes it, and resets the buffer. </p>

<p class="definition">Definition at line <a class="el" href="_klipper_c_l_i_8cpp_source.html#l00449">449</a> of file <a class="el" href="_klipper_c_l_i_8cpp_source.html">KlipperCLI.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  449</span>               {</div>
<div class="line"><span class="lineno">  450</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="#ad3e5a754ec9f201484a7aacea2f41961">packet_ready</a>) {</div>
<div class="line"><span class="lineno">  451</span>             <a class="code hl_function" href="#a6089e6db2e7edddf19fdf095b9826c88">ProcessPacket</a>(<a class="code hl_variable" href="#a5340c0df3b2af2c3a791cc11f143bbf2">rx_buffer</a>);</div>
<div class="line"><span class="lineno">  452</span>             <span class="comment">// Reset buffer</span></div>
<div class="line"><span class="lineno">  453</span>             <a class="code hl_variable" href="#a932aad58ea2cbdf8a45a6835825b21a2">rx_idx</a> = 0;</div>
<div class="line"><span class="lineno">  454</span>             <a class="code hl_variable" href="#ad3e5a754ec9f201484a7aacea2f41961">packet_ready</a> = <span class="keyword">false</span>; </div>
<div class="line"><span class="lineno">  455</span>        }</div>
<div class="line"><span class="lineno">  456</span>    }</div>
<div class="ttc" id="anamespace_klipper_c_l_i_html_a6089e6db2e7edddf19fdf095b9826c88"><div class="ttname"><a href="#a6089e6db2e7edddf19fdf095b9826c88">KlipperCLI::ProcessPacket</a></div><div class="ttdeci">void ProcessPacket(char *json_str)</div><div class="ttdoc">Parse and Dispatch a JSON Packet.</div><div class="ttdef"><b>Definition</b> <a href="_klipper_c_l_i_8cpp_source.html#l00400">KlipperCLI.cpp:400</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="_klipper_c_l_i_8cpp_source.html#l00431">packet_ready</a>, <a class="el" href="_klipper_c_l_i_8cpp_source.html#l00400">ProcessPacket()</a>, <a class="el" href="_klipper_c_l_i_8cpp_source.html#l00019">rx_buffer</a>, and <a class="el" href="_klipper_c_l_i_8cpp_source.html#l00020">rx_idx</a>.</p>

<p class="reference">Referenced by <a class="el" href="_command_router_8cpp_source.html#l00180">CommandRouter::Run()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespace_klipper_c_l_i_afe96c8a3898aa7a50f68ab6d726860c3_cgraph.png" border="0" usemap="#anamespace_klipper_c_l_i_afe96c8a3898aa7a50f68ab6d726860c3_cgraph" loading="lazy" alt=""/></div>
<map name="anamespace_klipper_c_l_i_afe96c8a3898aa7a50f68ab6d726860c3_cgraph" id="anamespace_klipper_c_l_i_afe96c8a3898aa7a50f68ab6d726860c3_cgraph">
<area shape="rect" title="Main Execution Loop." alt="" coords="5,517,120,544"/>
<area shape="rect" href="namespace_klipper_c_l_i.html#a6089e6db2e7edddf19fdf095b9826c88" title="Parse and Dispatch a JSON Packet." alt="" coords="168,517,347,544"/>
<area shape="poly" title=" " alt="" coords="118,528,154,529,150,532,121,533"/>
<area shape="rect" href="namespace_klipper_c_l_i.html#afeb304003d4b85010afd5e183e1bbf16" title="Handler for GET_FILAMENT_INFO command." alt="" coords="395,295,619,321"/>
<area shape="poly" title=" " alt="" coords="268,515,321,457,393,386,474,328,470,332,397,390,324,461,272,519"/>
<area shape="rect" href="namespace_klipper_c_l_i.html#ad0e99d2fdcfd1c0690f850816ac1f67c" title="Helper to send an Error response." alt="" coords="692,459,841,485"/>
<area shape="poly" title=" " alt="" coords="326,514,395,503,543,486,679,476,674,479,544,491,395,508,328,519"/>
<area shape="rect" href="namespace_hardware.html#ad3ec7cad074d6d73508844a06a7bea50" title="Send a buffer via UART1." alt="" coords="1159,349,1317,376"/>
<area shape="poly" title=" " alt="" coords="270,542,322,600,358,633,397,663,518,745,572,776,625,800,678,814,734,816,796,805,865,780,932,743,993,695,1048,640,1097,583,1139,525,1174,471,1221,392,1226,388,1179,474,1144,528,1101,586,1052,644,996,699,934,747,867,785,797,811,735,821,677,819,623,805,569,781,515,749,393,667,354,637,319,603,269,547"/>
<area shape="rect" href="namespace_klipper_c_l_i.html#ae13dcd8cc2528c12d0a241046fcc304e" title="Handler for GET_SENSORS command." alt="" coords="407,139,607,165"/>
<area shape="poly" title=" " alt="" coords="263,516,312,416,350,348,393,281,438,223,484,175,481,179,442,226,397,284,355,351,317,419,267,518"/>
<area shape="rect" href="namespace_klipper_c_l_i.html#a12cef4b97fbfa7cfb7bdb1540e626ae9" title="Handler for MOVE command." alt="" coords="426,627,589,653"/>
<area shape="poly" title=" " alt="" coords="278,542,331,575,396,608,429,621,424,622,394,613,328,580,278,547"/>
<area shape="rect" href="namespace_klipper_c_l_i.html#a81f1646e6adb42482d4109a33b9bb9c5" title="Handler for PING command." alt="" coords="688,896,845,923"/>
<area shape="poly" title=" " alt="" coords="260,542,268,608,287,702,304,752,327,801,358,845,397,882,430,902,467,916,505,926,545,931,622,931,688,926,693,926,622,937,544,936,504,931,465,922,428,907,393,886,354,849,323,804,299,754,282,703,262,609,258,547"/>
<area shape="rect" href="namespace_klipper_c_l_i.html#a685b6d688593b458b5edafda4adfd4d4" title="Handler for SELECT_LANE command." alt="" coords="409,517,605,544"/>
<area shape="poly" title=" " alt="" coords="347,528,396,529,391,532,349,533"/>
<area shape="rect" href="namespace_klipper_c_l_i.html#a31ef4dae129916b85fdd8d1612553c77" title="Handler for SET_AUTO_FEED command." alt="" coords="404,572,611,599"/>
<area shape="poly" title=" " alt="" coords="321,542,431,567,426,569,322,547"/>
<area shape="rect" href="namespace_klipper_c_l_i.html#a76547f35e246989843f1870c760ea514" title="Handler for SET_FILAMENT_INFO command." alt="" coords="396,400,619,427"/>
<area shape="poly" title=" " alt="" coords="281,515,394,455,455,431,451,434,396,460,284,519"/>
<area shape="rect" href="namespace_klipper_c_l_i.html#a8f239072c1896e64e9f6075edaaea515" title="Handler for STATUS command." alt="" coords="422,88,592,115"/>
<area shape="poly" title=" " alt="" coords="256,516,261,447,268,397,279,341,296,283,320,225,352,171,393,125,410,115,406,119,397,129,356,174,325,227,301,284,284,342,273,398,266,448,261,518"/>
<area shape="rect" href="namespace_klipper_c_l_i.html#a5bc1dda1e0b24dccb6fdc1c475930c88" title="Handler for STOP command." alt="" coords="428,845,586,872"/>
<area shape="poly" title=" " alt="" coords="262,542,275,597,299,673,317,714,338,754,365,792,397,825,417,840,411,839,393,829,361,795,334,757,312,716,294,674,270,598,260,547"/>
<area shape="rect" href="class_unit_state.html#a221a5d98d4e870c593e5bd5ee6621c4c" title="Get the configuration specific to a filament index." alt="" coords="689,189,844,216"/>
<area shape="poly" title=" " alt="" coords="535,292,666,232,707,220,702,223,668,237,538,296"/>
<area shape="poly" title=" " alt="" coords="531,319,575,348,621,386,635,403,644,418,653,431,669,444,681,452,675,453,666,449,649,435,640,421,631,406,617,390,572,353,531,324"/>
<area shape="poly" title=" " alt="" coords="568,292,667,276,767,269,866,276,951,289,1036,306,1178,344,1173,345,1034,311,950,294,865,281,767,275,668,281,571,296"/>
<area shape="rect" href="namespace_klipper_c_l_i.html#a9ec392d53485800126189969c2c4981a" title="Serialize and send a JSON response." alt="" coords="923,459,1102,485"/>
<area shape="poly" title=" " alt="" coords="840,469,910,471,904,473,841,475"/>
<area shape="poly" title=" " alt="" coords="1068,456,1110,440,1161,412,1204,387,1209,384,1164,417,1112,445,1070,461"/>
<area shape="rect" href="namespace_hardware.html#a0ada30189b8e1d1dbec145140849b778" title="Microsecond Delay." alt="" coords="1599,349,1737,376"/>
<area shape="poly" title=" " alt="" coords="1317,360,1585,362,1580,363,1318,365"/>
<area shape="rect" href="namespace_hardware.html#aaaf02ef3df5811e2ba28dd009eadfaae" title="Send a single byte blocking." alt="" coords="1365,324,1551,351"/>
<area shape="poly" title=" " alt="" coords="1317,351,1352,349,1347,351,1319,356"/>
<area shape="poly" title=" " alt="" coords="1551,346,1586,352,1581,353,1551,351"/>
<area shape="poly" title=" " alt="" coords="607,143,682,142,758,145,823,155,849,164,867,175,892,207,902,240,902,273,896,307,890,341,888,375,895,408,916,441,925,451,919,450,912,444,890,410,882,375,884,340,891,306,896,273,897,240,888,209,864,179,847,169,822,161,757,151,682,147,609,148"/>
<area shape="rect" href="namespace_control_logic.html#a4428a845041ff986ccbf2555a62d0656" title="Get a bitmask of sensor states." alt="" coords="669,88,864,115"/>
<area shape="poly" title=" " alt="" coords="578,136,682,117,678,120,581,140"/>
<area shape="poly" title=" " alt="" coords="588,626,618,609,629,595,636,582,641,554,646,524,653,509,666,495,676,491,680,488,669,499,657,512,651,526,646,554,641,584,634,598,621,613,590,630"/>
<area shape="rect" href="class_unit_state.html#a4833e917e0069069c7f455a24e28a516" title="Get the currently active filament index." alt="" coords="667,728,866,771"/>
<area shape="poly" title=" " alt="" coords="535,651,668,714,686,722,680,722,666,718,535,657"/>
<area shape="rect" href="namespace_control_logic.html#a484eadc314267f8bc9aa0f025c1137d9" title="Manually move an axis (Klipper Primitive)." alt="" coords="686,677,847,704"/>
<area shape="poly" title=" " alt="" coords="579,651,683,673,677,674,579,657"/>
<area shape="rect" href="namespace_klipper_c_l_i.html#a1d7d7986d99cb52ab4feb4826ffc4428" title="Helper to send a Success (OK) response." alt="" coords="698,627,835,653"/>
<area shape="poly" title=" " alt="" coords="589,637,685,639,679,641,590,643"/>
<area shape="poly" title=" " alt="" coords="834,625,864,612,903,586,937,555,990,499,994,496,941,559,906,590,867,617,836,630"/>
<area shape="poly" title=" " alt="" coords="845,894,864,882,903,839,934,789,958,735,976,680,999,577,1008,503,1011,499,1004,578,982,682,963,737,938,791,907,842,867,886,847,899"/>
<area shape="rect" href="namespace_hardware.html#a8ea28b07408691bc126683a81aa220f3" title="Get System Time in Milliseconds." alt="" coords="1170,593,1306,620"/>
<area shape="poly" title=" " alt="" coords="838,893,1001,857,1072,839,1110,824,1132,804,1153,781,1187,729,1211,677,1227,637,1231,634,1216,679,1191,732,1157,784,1136,808,1112,829,1073,844,1003,863,839,898"/>
<area shape="rect" href="class_unit_state.html#a745286b33e7a2805f9045e22fc0a49ac" title=" " alt="" coords="938,896,1086,923"/>
<area shape="poly" title=" " alt="" coords="846,907,925,909,920,909,846,912"/>
<area shape="rect" href="time64_8cpp.html#a146d483f58902ba0184ce16f728edfb0" title="Get 64&#45;bit System Time in Milliseconds." alt="" coords="1415,593,1501,620"/>
<area shape="poly" title=" " alt="" coords="1306,604,1402,606,1397,607,1307,609"/>
<area shape="poly" title=" " alt="" coords="568,514,692,488,687,491,570,519"/>
<area shape="poly" title=" " alt="" coords="585,542,621,558,637,572,646,586,654,600,669,612,686,623,681,623,666,617,650,603,641,589,633,575,618,562,585,547"/>
<area shape="rect" href="class_unit_state.html#a07223951eecac60709753ce07290477d" title="Set the currently active filament index." alt="" coords="668,509,865,552"/>
<area shape="poly" title=" " alt="" coords="605,528,655,530,650,531,607,533"/>
<area shape="poly" title=" " alt="" coords="585,569,618,554,633,540,641,525,650,510,666,495,680,490,676,493,669,499,654,513,646,528,637,543,621,558,588,574"/>
<area shape="poly" title=" " alt="" coords="574,597,688,622,682,624,574,602"/>
<area shape="rect" href="namespace_control_logic.html#a9db355302a1c9d608e6dd5341151336e" title="Enable/Disable Auto&#45;Feed (Pressure Control) for a lane." alt="" coords="677,576,856,603"/>
<area shape="poly" title=" " alt="" coords="611,584,664,587,659,588,612,590"/>
<area shape="poly" title=" " alt="" coords="529,397,572,368,617,331,641,304,665,277,735,223,731,227,669,281,645,308,621,335,575,373,533,401"/>
<area shape="poly" title=" " alt="" coords="569,425,692,454,687,456,570,430"/>
<area shape="poly" title=" " alt="" coords="531,424,577,458,600,480,622,504,637,535,643,562,650,588,669,613,686,625,681,625,666,617,645,590,638,564,632,536,617,507,596,483,573,462,531,430"/>
<area shape="rect" href="namespace_control_logic.html#a3aed4ef4cb26632467a000c0130b11b4" title="Action helper to update filament metadata." alt="" coords="680,392,853,435"/>
<area shape="poly" title=" " alt="" coords="618,411,667,412,662,414,620,416"/>
<area shape="rect" href="struct_filament_info.html#ac821cbe379c5f19ac753f91adef53851" title="Set the RFID/ID of the filament." alt="" coords="699,341,834,368"/>
<area shape="poly" title=" " alt="" coords="568,397,692,371,687,373,570,402"/>
<area shape="rect" href="struct_filament_info.html#a6bb1d50ec33de9366132999b3a84ff3c" title="Set the Name of the filament." alt="" coords="688,291,845,317"/>
<area shape="poly" title=" " alt="" coords="529,397,590,363,666,327,690,321,686,324,668,332,593,367,532,402"/>
<area shape="rect" href="namespace_control_logic.html#afe90d7f284c20f90f74787274f01c51b" title="Flag that settings need to be saved." alt="" coords="914,404,1111,431"/>
<area shape="poly" title=" " alt="" coords="853,412,901,415,896,416,854,417"/>
<area shape="poly" title=" " alt="" coords="1080,428,1112,444,1149,475,1181,511,1225,580,1220,579,1176,515,1145,479,1110,449,1079,434"/>
<area shape="poly" title=" " alt="" coords="581,113,620,124,680,151,732,180,727,181,677,155,618,129,582,118"/>
<area shape="poly" title=" " alt="" coords="528,86,588,52,627,35,667,23,723,10,768,3,813,7,867,23,928,52,986,90,1040,133,1089,178,1170,267,1222,337,1217,336,1165,271,1086,182,1037,137,983,94,926,57,865,28,812,12,768,9,724,15,668,28,629,40,591,56,531,89"/>
<area shape="poly" title=" " alt="" coords="591,99,656,100,651,103,593,104"/>
<area shape="rect" href="namespace_control_logic.html#a77da31cf0baa8e886a438b2a9e73a573" title="Get the current motion state of a lane." alt="" coords="671,37,862,64"/>
<area shape="poly" title=" " alt="" coords="578,85,682,66,678,69,581,90"/>
<area shape="poly" title=" " alt="" coords="514,843,535,807,568,758,613,707,638,683,666,663,681,658,686,656,669,668,642,687,616,711,573,761,539,810,517,847"/>
<area shape="rect" href="namespace_control_logic.html#af084200798d6b89c1b448bf41b105d62" title="Stop all motors." alt="" coords="694,845,839,872"/>
<area shape="poly" title=" " alt="" coords="587,856,681,858,676,859,587,861"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespace_klipper_c_l_i_afe96c8a3898aa7a50f68ab6d726860c3_icgraph.png" border="0" usemap="#anamespace_klipper_c_l_i_afe96c8a3898aa7a50f68ab6d726860c3_icgraph" loading="lazy" alt=""/></div>
<map name="anamespace_klipper_c_l_i_afe96c8a3898aa7a50f68ab6d726860c3_icgraph" id="anamespace_klipper_c_l_i_afe96c8a3898aa7a50f68ab6d726860c3_icgraph">
<area shape="rect" title="Main Execution Loop." alt="" coords="695,13,809,40"/>
<area shape="rect" href="namespace_command_router.html#a96ff3718682e9322a64815a3d41d001b" title="Main execution loop for the Router." alt="" coords="494,13,647,40"/>
<area shape="poly" title=" " alt="" coords="677,27,647,29,647,24,682,27"/>
<area shape="rect" href="main_8cpp.html#afe461d27b9c48d5921c00d521181f12f" title="Arduino Main Loop." alt="" coords="401,13,446,40"/>
<area shape="poly" title=" " alt="" coords="476,27,447,29,447,24,481,27"/>
<area shape="rect" href="class_adafruit___neo_pixel.html#a4bcda7a15591065570d3598cbf970be7" title="将RAM中的像素数据传输到NeoPixels。" alt="" coords="188,13,353,40"/>
<area shape="poly" title=" " alt="" coords="383,27,353,29,353,24,388,27"/>
<area shape="rect" href="class_adafruit___neo_pixel.html#a61b1bd003a291520a367ab1712d6265c" title="释放Adafruit_NeoPixel对象，将数据引脚恢复为输入模式。" alt="" coords="5,5,140,48"/>
<area shape="poly" title=" " alt="" coords="170,27,140,29,140,24,175,26"/>
</map>
</div>

</div>
</div>
<a id="ad0e99d2fdcfd1c0690f850816ac1f67c" name="ad0e99d2fdcfd1c0690f850816ac1f67c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad0e99d2fdcfd1c0690f850816ac1f67c">&#9670;&#160;</a></span>SendError()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void KlipperCLI::SendError </td>
          <td>(</td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>id</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *</td>          <td class="paramname"><span class="paramname"><em>code</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *</td>          <td class="paramname"><span class="paramname"><em>msg</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Helper to send an Error response. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">id</td><td>Request ID. </td></tr>
    <tr><td class="paramname">code</td><td>Error Code String. </td></tr>
    <tr><td class="paramname">msg</td><td>Descriptive Message. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="_klipper_c_l_i_8cpp_source.html#l00056">56</a> of file <a class="el" href="_klipper_c_l_i_8cpp_source.html">KlipperCLI.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   56</span>                                                              {</div>
<div class="line"><span class="lineno">   57</span>        <a class="code hl_variable" href="#adf80752c24e066ed02f3864069ff9707">doc</a>.clear();</div>
<div class="line"><span class="lineno">   58</span>        <a class="code hl_variable" href="#adf80752c24e066ed02f3864069ff9707">doc</a>[<span class="stringliteral">&quot;id&quot;</span>] = id;</div>
<div class="line"><span class="lineno">   59</span>        <a class="code hl_variable" href="#adf80752c24e066ed02f3864069ff9707">doc</a>[<span class="stringliteral">&quot;ok&quot;</span>] = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno">   60</span>        <a class="code hl_variable" href="#adf80752c24e066ed02f3864069ff9707">doc</a>[<span class="stringliteral">&quot;code&quot;</span>] = code;</div>
<div class="line"><span class="lineno">   61</span>        <a class="code hl_variable" href="#adf80752c24e066ed02f3864069ff9707">doc</a>[<span class="stringliteral">&quot;msg&quot;</span>] = msg;</div>
<div class="line"><span class="lineno">   62</span>        <a class="code hl_function" href="#a9ec392d53485800126189969c2c4981a">SendResponse</a>(<a class="code hl_variable" href="#adf80752c24e066ed02f3864069ff9707">doc</a>);</div>
<div class="line"><span class="lineno">   63</span>    }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="_klipper_c_l_i_8cpp_source.html#l00024">doc</a>, and <a class="el" href="_klipper_c_l_i_8cpp_source.html#l00035">SendResponse()</a>.</p>

<p class="reference">Referenced by <a class="el" href="_klipper_c_l_i_8cpp_source.html#l00305">HandleGetFilamentInfo()</a>, <a class="el" href="_klipper_c_l_i_8cpp_source.html#l00208">HandleMove()</a>, <a class="el" href="_klipper_c_l_i_8cpp_source.html#l00268">HandleSelectLane()</a>, <a class="el" href="_klipper_c_l_i_8cpp_source.html#l00288">HandleSetAutoFeed()</a>, <a class="el" href="_klipper_c_l_i_8cpp_source.html#l00347">HandleSetFilamentInfo()</a>, and <a class="el" href="_klipper_c_l_i_8cpp_source.html#l00400">ProcessPacket()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespace_klipper_c_l_i_ad0e99d2fdcfd1c0690f850816ac1f67c_cgraph.png" border="0" usemap="#anamespace_klipper_c_l_i_ad0e99d2fdcfd1c0690f850816ac1f67c_cgraph" loading="lazy" alt=""/></div>
<map name="anamespace_klipper_c_l_i_ad0e99d2fdcfd1c0690f850816ac1f67c_cgraph" id="anamespace_klipper_c_l_i_ad0e99d2fdcfd1c0690f850816ac1f67c_cgraph">
<area shape="rect" title="Helper to send an Error response." alt="" coords="5,5,154,32"/>
<area shape="rect" href="namespace_klipper_c_l_i.html#a9ec392d53485800126189969c2c4981a" title="Serialize and send a JSON response." alt="" coords="202,5,381,32"/>
<area shape="poly" title=" " alt="" coords="154,16,189,18,183,19,154,21"/>
<area shape="rect" href="namespace_hardware.html#ad3ec7cad074d6d73508844a06a7bea50" title="Send a buffer via UART1." alt="" coords="429,5,587,32"/>
<area shape="poly" title=" " alt="" coords="382,16,416,19,411,19,382,21"/>
<area shape="rect" href="namespace_hardware.html#a0ada30189b8e1d1dbec145140849b778" title="Microsecond Delay." alt="" coords="869,5,1007,32"/>
<area shape="poly" title=" " alt="" coords="588,16,856,19,850,19,588,21"/>
<area shape="rect" href="namespace_hardware.html#aaaf02ef3df5811e2ba28dd009eadfaae" title="Send a single byte blocking." alt="" coords="635,31,821,57"/>
<area shape="poly" title=" " alt="" coords="588,25,622,32,617,31,588,30"/>
<area shape="poly" title=" " alt="" coords="821,30,851,29,856,29,821,35"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespace_klipper_c_l_i_ad0e99d2fdcfd1c0690f850816ac1f67c_icgraph.png" border="0" usemap="#anamespace_klipper_c_l_i_ad0e99d2fdcfd1c0690f850816ac1f67c_icgraph" loading="lazy" alt=""/></div>
<map name="anamespace_klipper_c_l_i_ad0e99d2fdcfd1c0690f850816ac1f67c_icgraph" id="anamespace_klipper_c_l_i_ad0e99d2fdcfd1c0690f850816ac1f67c_icgraph">
<area shape="rect" title="Helper to send an Error response." alt="" coords="1357,132,1505,159"/>
<area shape="rect" href="namespace_klipper_c_l_i.html#afeb304003d4b85010afd5e183e1bbf16" title="Handler for GET_FILAMENT_INFO command." alt="" coords="1084,5,1309,32"/>
<area shape="poly" title=" " alt="" coords="1402,120,1360,87,1307,53,1261,35,1262,30,1310,48,1363,83,1407,122"/>
<area shape="rect" href="namespace_klipper_c_l_i.html#a6089e6db2e7edddf19fdf095b9826c88" title="Parse and Dispatch a JSON Packet." alt="" coords="857,132,1036,159"/>
<area shape="poly" title=" " alt="" coords="1388,124,1351,110,1308,97,1246,87,1197,83,1147,87,1085,97,1027,113,977,134,976,129,1025,108,1084,92,1147,82,1197,78,1246,81,1309,92,1353,105,1394,125"/>
<area shape="rect" href="namespace_klipper_c_l_i.html#a12cef4b97fbfa7cfb7bdb1540e626ae9" title="Handler for MOVE command." alt="" coords="1115,107,1278,133"/>
<area shape="poly" title=" " alt="" coords="1339,136,1279,132,1279,126,1344,136"/>
<area shape="rect" href="namespace_klipper_c_l_i.html#a685b6d688593b458b5edafda4adfd4d4" title="Handler for SELECT_LANE command." alt="" coords="1098,157,1295,184"/>
<area shape="poly" title=" " alt="" coords="1344,155,1296,163,1295,157,1339,155"/>
<area shape="rect" href="namespace_klipper_c_l_i.html#a31ef4dae129916b85fdd8d1612553c77" title="Handler for SET_AUTO_FEED command." alt="" coords="1093,208,1300,235"/>
<area shape="poly" title=" " alt="" coords="1389,165,1310,199,1268,210,1267,205,1308,193,1384,166"/>
<area shape="rect" href="namespace_klipper_c_l_i.html#a76547f35e246989843f1870c760ea514" title="Handler for SET_FILAMENT_INFO command." alt="" coords="1085,259,1308,285"/>
<area shape="poly" title=" " alt="" coords="1409,169,1365,212,1339,232,1310,249,1280,261,1279,255,1308,244,1336,228,1362,208,1404,171"/>
<area shape="poly" title=" " alt="" coords="1122,36,1086,53,1017,94,965,134,963,129,1014,90,1083,48,1117,38"/>
<area shape="rect" href="namespace_klipper_c_l_i.html#afe96c8a3898aa7a50f68ab6d726860c3" title="Main Execution Loop." alt="" coords="695,132,809,159"/>
<area shape="poly" title=" " alt="" coords="839,146,809,148,809,143,844,145"/>
<area shape="rect" href="namespace_command_router.html#a96ff3718682e9322a64815a3d41d001b" title="Main execution loop for the Router." alt="" coords="494,132,647,159"/>
<area shape="poly" title=" " alt="" coords="677,146,648,148,647,143,682,145"/>
<area shape="rect" href="main_8cpp.html#afe461d27b9c48d5921c00d521181f12f" title="Arduino Main Loop." alt="" coords="401,132,446,159"/>
<area shape="poly" title=" " alt="" coords="476,146,447,148,447,143,481,145"/>
<area shape="rect" href="class_adafruit___neo_pixel.html#a4bcda7a15591065570d3598cbf970be7" title="将RAM中的像素数据传输到NeoPixels。" alt="" coords="188,132,353,159"/>
<area shape="poly" title=" " alt="" coords="383,146,354,148,353,143,388,145"/>
<area shape="rect" href="class_adafruit___neo_pixel.html#a61b1bd003a291520a367ab1712d6265c" title="释放Adafruit_NeoPixel对象，将数据引脚恢复为输入模式。" alt="" coords="5,124,140,167"/>
<area shape="poly" title=" " alt="" coords="170,147,141,148,139,143,175,144"/>
<area shape="poly" title=" " alt="" coords="1097,130,1037,139,1036,134,1102,129"/>
<area shape="poly" title=" " alt="" coords="1080,159,1037,157,1037,152,1085,159"/>
<area shape="poly" title=" " alt="" coords="1111,204,1084,199,981,162,982,157,1085,193,1116,204"/>
<area shape="poly" title=" " alt="" coords="1099,253,1083,249,1046,229,1012,205,961,162,963,157,1015,200,1049,224,1085,244,1104,254"/>
</map>
</div>

</div>
</div>
<a id="a1d7d7986d99cb52ab4feb4826ffc4428" name="a1d7d7986d99cb52ab4feb4826ffc4428"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1d7d7986d99cb52ab4feb4826ffc4428">&#9670;&#160;</a></span>SendOk()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void KlipperCLI::SendOk </td>
          <td>(</td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>id</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *</td>          <td class="paramname"><span class="paramname"><em>code</em></span><span class="paramdefsep"> = </span><span class="paramdefval">nullptr</span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *</td>          <td class="paramname"><span class="paramname"><em>msg</em></span><span class="paramdefsep"> = </span><span class="paramdefval">nullptr</span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Helper to send a Success (OK) response. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">id</td><td>Request ID. </td></tr>
    <tr><td class="paramname">code</td><td>Optional code. </td></tr>
    <tr><td class="paramname">msg</td><td>Optional message. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="_klipper_c_l_i_8cpp_source.html#l00073">73</a> of file <a class="el" href="_klipper_c_l_i_8cpp_source.html">KlipperCLI.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   73</span>                                                                               {</div>
<div class="line"><span class="lineno">   74</span>        <a class="code hl_variable" href="#adf80752c24e066ed02f3864069ff9707">doc</a>.clear();</div>
<div class="line"><span class="lineno">   75</span>        <a class="code hl_variable" href="#adf80752c24e066ed02f3864069ff9707">doc</a>[<span class="stringliteral">&quot;id&quot;</span>] = id;</div>
<div class="line"><span class="lineno">   76</span>        <a class="code hl_variable" href="#adf80752c24e066ed02f3864069ff9707">doc</a>[<span class="stringliteral">&quot;ok&quot;</span>] = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno">   77</span>        <span class="keywordflow">if</span>(code) <a class="code hl_variable" href="#adf80752c24e066ed02f3864069ff9707">doc</a>[<span class="stringliteral">&quot;code&quot;</span>] = code;</div>
<div class="line"><span class="lineno">   78</span>        <span class="keywordflow">if</span>(msg) <a class="code hl_variable" href="#adf80752c24e066ed02f3864069ff9707">doc</a>[<span class="stringliteral">&quot;msg&quot;</span>] = msg;</div>
<div class="line"><span class="lineno">   79</span>        <a class="code hl_function" href="#a9ec392d53485800126189969c2c4981a">SendResponse</a>(<a class="code hl_variable" href="#adf80752c24e066ed02f3864069ff9707">doc</a>);</div>
<div class="line"><span class="lineno">   80</span>    }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="_klipper_c_l_i_8cpp_source.html#l00024">doc</a>, and <a class="el" href="_klipper_c_l_i_8cpp_source.html#l00035">SendResponse()</a>.</p>

<p class="reference">Referenced by <a class="el" href="_klipper_c_l_i_8cpp_source.html#l00208">HandleMove()</a>, <a class="el" href="_klipper_c_l_i_8cpp_source.html#l00268">HandleSelectLane()</a>, <a class="el" href="_klipper_c_l_i_8cpp_source.html#l00288">HandleSetAutoFeed()</a>, <a class="el" href="_klipper_c_l_i_8cpp_source.html#l00347">HandleSetFilamentInfo()</a>, and <a class="el" href="_klipper_c_l_i_8cpp_source.html#l00255">HandleStop()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespace_klipper_c_l_i_a1d7d7986d99cb52ab4feb4826ffc4428_cgraph.png" border="0" usemap="#anamespace_klipper_c_l_i_a1d7d7986d99cb52ab4feb4826ffc4428_cgraph" loading="lazy" alt=""/></div>
<map name="anamespace_klipper_c_l_i_a1d7d7986d99cb52ab4feb4826ffc4428_cgraph" id="anamespace_klipper_c_l_i_a1d7d7986d99cb52ab4feb4826ffc4428_cgraph">
<area shape="rect" title="Helper to send a Success (OK) response." alt="" coords="5,5,143,32"/>
<area shape="rect" href="namespace_klipper_c_l_i.html#a9ec392d53485800126189969c2c4981a" title="Serialize and send a JSON response." alt="" coords="191,5,370,32"/>
<area shape="poly" title=" " alt="" coords="143,16,178,18,172,19,143,21"/>
<area shape="rect" href="namespace_hardware.html#ad3ec7cad074d6d73508844a06a7bea50" title="Send a buffer via UART1." alt="" coords="418,5,576,32"/>
<area shape="poly" title=" " alt="" coords="371,16,405,19,400,19,371,21"/>
<area shape="rect" href="namespace_hardware.html#a0ada30189b8e1d1dbec145140849b778" title="Microsecond Delay." alt="" coords="858,5,996,32"/>
<area shape="poly" title=" " alt="" coords="577,16,845,18,839,19,577,21"/>
<area shape="rect" href="namespace_hardware.html#aaaf02ef3df5811e2ba28dd009eadfaae" title="Send a single byte blocking." alt="" coords="624,31,810,57"/>
<area shape="poly" title=" " alt="" coords="577,25,611,32,606,31,577,30"/>
<area shape="poly" title=" " alt="" coords="810,30,840,29,845,29,810,35"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespace_klipper_c_l_i_a1d7d7986d99cb52ab4feb4826ffc4428_icgraph.png" border="0" usemap="#anamespace_klipper_c_l_i_a1d7d7986d99cb52ab4feb4826ffc4428_icgraph" loading="lazy" alt=""/></div>
<map name="anamespace_klipper_c_l_i_a1d7d7986d99cb52ab4feb4826ffc4428_icgraph" id="anamespace_klipper_c_l_i_a1d7d7986d99cb52ab4feb4826ffc4428_icgraph">
<area shape="rect" title="Helper to send a Success (OK) response." alt="" coords="1356,107,1493,133"/>
<area shape="rect" href="namespace_klipper_c_l_i.html#a12cef4b97fbfa7cfb7bdb1540e626ae9" title="Handler for MOVE command." alt="" coords="1114,5,1278,32"/>
<area shape="poly" title=" " alt="" coords="1392,96,1353,71,1307,46,1274,35,1275,30,1309,42,1356,67,1397,97"/>
<area shape="rect" href="namespace_klipper_c_l_i.html#a685b6d688593b458b5edafda4adfd4d4" title="Handler for SELECT_LANE command." alt="" coords="1098,56,1294,83"/>
<area shape="poly" title=" " alt="" coords="1343,103,1259,86,1260,81,1349,103"/>
<area shape="rect" href="namespace_klipper_c_l_i.html#a31ef4dae129916b85fdd8d1612553c77" title="Handler for SET_AUTO_FEED command." alt="" coords="1092,107,1300,133"/>
<area shape="poly" title=" " alt="" coords="1338,120,1300,123,1300,117,1343,120"/>
<area shape="rect" href="namespace_klipper_c_l_i.html#a76547f35e246989843f1870c760ea514" title="Handler for SET_FILAMENT_INFO command." alt="" coords="1084,157,1308,184"/>
<area shape="poly" title=" " alt="" coords="1349,137,1260,159,1259,154,1343,138"/>
<area shape="rect" href="namespace_klipper_c_l_i.html#a5bc1dda1e0b24dccb6fdc1c475930c88" title="Handler for STOP command." alt="" coords="1117,208,1275,235"/>
<area shape="poly" title=" " alt="" coords="1397,142,1356,173,1309,198,1275,210,1274,205,1307,194,1353,169,1392,144"/>
<area shape="rect" href="namespace_klipper_c_l_i.html#a6089e6db2e7edddf19fdf095b9826c88" title="Parse and Dispatch a JSON Packet." alt="" coords="857,107,1036,133"/>
<area shape="poly" title=" " alt="" coords="1109,36,1085,46,1021,77,969,109,967,104,1018,73,1083,42,1104,37"/>
<area shape="rect" href="namespace_klipper_c_l_i.html#afe96c8a3898aa7a50f68ab6d726860c3" title="Main Execution Loop." alt="" coords="695,107,809,133"/>
<area shape="poly" title=" " alt="" coords="839,120,809,123,809,117,844,120"/>
<area shape="rect" href="namespace_command_router.html#a96ff3718682e9322a64815a3d41d001b" title="Main execution loop for the Router." alt="" coords="494,107,647,133"/>
<area shape="poly" title=" " alt="" coords="677,120,648,123,647,117,682,120"/>
<area shape="rect" href="main_8cpp.html#afe461d27b9c48d5921c00d521181f12f" title="Arduino Main Loop." alt="" coords="401,107,446,133"/>
<area shape="poly" title=" " alt="" coords="476,120,447,123,447,117,481,120"/>
<area shape="rect" href="class_adafruit___neo_pixel.html#a4bcda7a15591065570d3598cbf970be7" title="将RAM中的像素数据传输到NeoPixels。" alt="" coords="188,107,353,133"/>
<area shape="poly" title=" " alt="" coords="383,120,354,123,353,117,388,120"/>
<area shape="rect" href="class_adafruit___neo_pixel.html#a61b1bd003a291520a367ab1712d6265c" title="释放Adafruit_NeoPixel对象，将数据引脚恢复为输入模式。" alt="" coords="5,99,140,141"/>
<area shape="poly" title=" " alt="" coords="170,121,140,123,139,117,175,119"/>
<area shape="poly" title=" " alt="" coords="1114,86,1016,109,1015,103,1109,87"/>
<area shape="poly" title=" " alt="" coords="1074,120,1037,123,1037,117,1079,120"/>
<area shape="poly" title=" " alt="" coords="1109,154,1016,137,1016,131,1114,154"/>
<area shape="poly" title=" " alt="" coords="1104,203,1083,198,1018,167,968,136,969,131,1021,163,1085,194,1109,204"/>
</map>
</div>

</div>
</div>
<a id="a9ec392d53485800126189969c2c4981a" name="a9ec392d53485800126189969c2c4981a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9ec392d53485800126189969c2c4981a">&#9670;&#160;</a></span>SendResponse()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void KlipperCLI::SendResponse </td>
          <td>(</td>
          <td class="paramtype">JsonDocument &amp;</td>          <td class="paramname"><span class="paramname"><em>d</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Serialize and send a JSON response. </p>
<p>Serializes the document to a buffer, appends CR/LF, and sends via UART.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">d</td><td>The JSON Document to serialize. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="_klipper_c_l_i_8cpp_source.html#l00035">35</a> of file <a class="el" href="_klipper_c_l_i_8cpp_source.html">KlipperCLI.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   35</span>                                       {</div>
<div class="line"><span class="lineno">   36</span>        <span class="comment">// Serialize to buffer</span></div>
<div class="line"><span class="lineno">   37</span>        <span class="keyword">static</span> <span class="keywordtype">char</span> output[1200]; <span class="comment">// Increased buffer slightly</span></div>
<div class="line"><span class="lineno">   38</span>        <span class="keywordtype">size_t</span> len = serializeJson(d, output, <span class="keyword">sizeof</span>(output) - 2);</div>
<div class="line"><span class="lineno">   39</span>        </div>
<div class="line"><span class="lineno">   40</span>        <span class="comment">// Append Newline</span></div>
<div class="line"><span class="lineno">   41</span>        output[len++] = <span class="charliteral">&#39;\r&#39;</span>;</div>
<div class="line"><span class="lineno">   42</span>        output[len++] = <span class="charliteral">&#39;\n&#39;</span>;</div>
<div class="line"><span class="lineno">   43</span>        </div>
<div class="line"><span class="lineno">   44</span>        <span class="comment">// Send via Hardware UART</span></div>
<div class="line"><span class="lineno">   45</span>        <a class="code hl_function" href="namespace_hardware.html#ad3ec7cad074d6d73508844a06a7bea50">Hardware::UART_Send</a>((<span class="keyword">const</span> uint8_t*)output, len);</div>
<div class="line"><span class="lineno">   46</span>    }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="_hardware_8cpp_source.html#l00261">Hardware::UART_Send()</a>.</p>

<p class="reference">Referenced by <a class="el" href="_klipper_c_l_i_8cpp_source.html#l00185">HandleGetSensors()</a>, <a class="el" href="_klipper_c_l_i_8cpp_source.html#l00090">HandlePing()</a>, <a class="el" href="_klipper_c_l_i_8cpp_source.html#l00056">SendError()</a>, and <a class="el" href="_klipper_c_l_i_8cpp_source.html#l00073">SendOk()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespace_klipper_c_l_i_a9ec392d53485800126189969c2c4981a_cgraph.png" border="0" usemap="#anamespace_klipper_c_l_i_a9ec392d53485800126189969c2c4981a_cgraph" loading="lazy" alt=""/></div>
<map name="anamespace_klipper_c_l_i_a9ec392d53485800126189969c2c4981a_cgraph" id="anamespace_klipper_c_l_i_a9ec392d53485800126189969c2c4981a_cgraph">
<area shape="rect" title="Serialize and send a JSON response." alt="" coords="5,5,185,32"/>
<area shape="rect" href="namespace_hardware.html#ad3ec7cad074d6d73508844a06a7bea50" title="Send a buffer via UART1." alt="" coords="233,5,391,32"/>
<area shape="poly" title=" " alt="" coords="185,16,220,18,214,19,186,21"/>
<area shape="rect" href="namespace_hardware.html#a0ada30189b8e1d1dbec145140849b778" title="Microsecond Delay." alt="" coords="672,5,811,32"/>
<area shape="poly" title=" " alt="" coords="391,16,659,18,654,19,392,21"/>
<area shape="rect" href="namespace_hardware.html#aaaf02ef3df5811e2ba28dd009eadfaae" title="Send a single byte blocking." alt="" coords="439,31,624,57"/>
<area shape="poly" title=" " alt="" coords="392,25,426,32,421,31,391,30"/>
<area shape="poly" title=" " alt="" coords="624,30,655,29,660,29,625,35"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespace_klipper_c_l_i_a9ec392d53485800126189969c2c4981a_icgraph.png" border="0" usemap="#anamespace_klipper_c_l_i_a9ec392d53485800126189969c2c4981a_icgraph" loading="lazy" alt=""/></div>
<map name="anamespace_klipper_c_l_i_a9ec392d53485800126189969c2c4981a_icgraph" id="anamespace_klipper_c_l_i_a9ec392d53485800126189969c2c4981a_icgraph">
<area shape="rect" title="Serialize and send a JSON response." alt="" coords="1605,162,1784,188"/>
<area shape="rect" href="namespace_klipper_c_l_i.html#ae13dcd8cc2528c12d0a241046fcc304e" title="Handler for GET_SENSORS command." alt="" coords="1357,10,1557,36"/>
<area shape="poly" title=" " alt="" coords="1662,151,1614,116,1556,76,1488,39,1489,34,1558,71,1617,111,1667,152"/>
<area shape="rect" href="namespace_klipper_c_l_i.html#a81f1646e6adb42482d4109a33b9bb9c5" title="Handler for PING command." alt="" coords="1378,86,1536,112"/>
<area shape="poly" title=" " alt="" coords="1633,156,1501,116,1502,110,1638,156"/>
<area shape="rect" href="namespace_klipper_c_l_i.html#ad0e99d2fdcfd1c0690f850816ac1f67c" title="Helper to send an Error response." alt="" coords="1383,187,1531,214"/>
<area shape="poly" title=" " alt="" coords="1587,186,1532,195,1531,190,1592,186"/>
<area shape="rect" href="namespace_klipper_c_l_i.html#a1d7d7986d99cb52ab4feb4826ffc4428" title="Helper to send a Success (OK) response." alt="" coords="1388,263,1526,290"/>
<area shape="poly" title=" " alt="" coords="1650,194,1491,265,1490,260,1645,195"/>
<area shape="rect" href="namespace_klipper_c_l_i.html#a6089e6db2e7edddf19fdf095b9826c88" title="Parse and Dispatch a JSON Packet." alt="" coords="857,187,1036,214"/>
<area shape="poly" title=" " alt="" coords="1344,8,1285,8,1217,12,1149,24,1085,47,1062,60,1041,77,1004,117,975,157,957,189,953,185,971,154,999,114,1037,74,1059,56,1083,42,1148,18,1217,6,1285,3,1349,7"/>
<area shape="rect" href="namespace_klipper_c_l_i.html#afe96c8a3898aa7a50f68ab6d726860c3" title="Main Execution Loop." alt="" coords="695,187,809,214"/>
<area shape="poly" title=" " alt="" coords="839,201,810,203,809,198,844,200"/>
<area shape="rect" href="namespace_command_router.html#a96ff3718682e9322a64815a3d41d001b" title="Main execution loop for the Router." alt="" coords="494,187,647,214"/>
<area shape="poly" title=" " alt="" coords="677,201,648,203,647,198,682,200"/>
<area shape="rect" href="main_8cpp.html#afe461d27b9c48d5921c00d521181f12f" title="Arduino Main Loop." alt="" coords="401,187,446,214"/>
<area shape="poly" title=" " alt="" coords="476,201,447,203,446,198,481,200"/>
<area shape="rect" href="class_adafruit___neo_pixel.html#a4bcda7a15591065570d3598cbf970be7" title="将RAM中的像素数据传输到NeoPixels。" alt="" coords="188,187,353,214"/>
<area shape="poly" title=" " alt="" coords="383,201,354,203,353,198,388,200"/>
<area shape="rect" href="class_adafruit___neo_pixel.html#a61b1bd003a291520a367ab1712d6265c" title="释放Adafruit_NeoPixel对象，将数据引脚恢复为输入模式。" alt="" coords="5,179,140,222"/>
<area shape="poly" title=" " alt="" coords="170,202,141,203,139,198,175,199"/>
<area shape="poly" title=" " alt="" coords="1397,81,1333,67,1253,56,1211,55,1168,57,1126,64,1085,76,1044,99,1008,130,979,162,959,189,956,184,975,159,1004,126,1041,95,1083,71,1124,59,1167,52,1211,49,1254,51,1334,62,1402,81"/>
<area shape="poly" title=" " alt="" coords="1371,184,1308,178,1196,171,1085,178,1010,189,1009,184,1084,172,1196,166,1309,172,1377,184"/>
<area shape="rect" href="namespace_klipper_c_l_i.html#afeb304003d4b85010afd5e183e1bbf16" title="Handler for GET_FILAMENT_INFO command." alt="" coords="1084,86,1309,112"/>
<area shape="poly" title=" " alt="" coords="1414,179,1308,133,1252,116,1253,110,1310,128,1419,180"/>
<area shape="rect" href="namespace_klipper_c_l_i.html#a12cef4b97fbfa7cfb7bdb1540e626ae9" title="Handler for MOVE command." alt="" coords="1115,238,1278,264"/>
<area shape="poly" title=" " alt="" coords="1372,217,1269,240,1268,234,1367,218"/>
<area shape="rect" href="namespace_klipper_c_l_i.html#a685b6d688593b458b5edafda4adfd4d4" title="Handler for SELECT_LANE command." alt="" coords="1098,288,1295,315"/>
<area shape="poly" title=" " alt="" coords="1417,220,1358,253,1334,267,1310,279,1272,290,1271,285,1308,274,1332,262,1355,249,1412,222"/>
<area shape="rect" href="namespace_klipper_c_l_i.html#a31ef4dae129916b85fdd8d1612553c77" title="Handler for SET_AUTO_FEED command." alt="" coords="1093,339,1300,366"/>
<area shape="poly" title=" " alt="" coords="1406,220,1381,236,1359,253,1344,272,1336,291,1328,311,1310,329,1288,341,1287,336,1307,325,1324,308,1331,289,1339,270,1355,249,1378,232,1401,221"/>
<area shape="rect" href="namespace_klipper_c_l_i.html#a76547f35e246989843f1870c760ea514" title="Handler for SET_FILAMENT_INFO command." alt="" coords="1085,187,1308,214"/>
<area shape="poly" title=" " alt="" coords="1365,201,1309,203,1308,198,1370,200"/>
<area shape="poly" title=" " alt="" coords="1127,116,1085,133,1024,161,973,189,971,184,1022,157,1083,128,1122,118"/>
<area shape="poly" title=" " alt="" coords="1109,234,1016,217,1016,212,1115,234"/>
<area shape="poly" title=" " alt="" coords="1104,283,1083,279,1018,248,968,217,969,211,1021,243,1085,274,1109,284"/>
<area shape="poly" title=" " alt="" coords="1095,333,1083,329,1043,303,1007,271,958,217,960,212,1011,268,1046,299,1086,325,1101,334"/>
<area shape="poly" title=" " alt="" coords="1066,201,1037,203,1036,198,1072,200"/>
<area shape="poly" title=" " alt="" coords="1370,268,1279,262,1279,256,1376,268"/>
<area shape="poly" title=" " alt="" coords="1375,284,1295,295,1295,289,1370,285"/>
<area shape="poly" title=" " alt="" coords="1407,295,1309,330,1265,341,1264,336,1308,324,1402,296"/>
<area shape="poly" title=" " alt="" coords="1402,257,1308,228,1264,217,1265,212,1309,223,1407,257"/>
<area shape="rect" href="namespace_klipper_c_l_i.html#a5bc1dda1e0b24dccb6fdc1c475930c88" title="Handler for STOP command." alt="" coords="1117,390,1276,416"/>
<area shape="poly" title=" " alt="" coords="1431,299,1377,342,1310,380,1276,392,1275,386,1308,375,1374,338,1426,301"/>
<area shape="poly" title=" " alt="" coords="1100,386,1083,380,1036,341,998,294,970,249,953,216,956,212,974,246,1003,291,1040,337,1086,375,1105,388"/>
</map>
</div>

</div>
</div>
<a name="doc-var-members" id="doc-var-members"></a><h2 id="header-doc-var-members" class="groupheader">Variable Documentation</h2>
<a id="adf80752c24e066ed02f3864069ff9707" name="adf80752c24e066ed02f3864069ff9707"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adf80752c24e066ed02f3864069ff9707">&#9670;&#160;</a></span>doc</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">JsonDocument KlipperCLI::doc</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel static">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="_klipper_c_l_i_8cpp_source.html#l00024">24</a> of file <a class="el" href="_klipper_c_l_i_8cpp_source.html">KlipperCLI.cpp</a>.</p>

<p class="reference">Referenced by <a class="el" href="_klipper_c_l_i_8cpp_source.html#l00185">HandleGetSensors()</a>, <a class="el" href="_klipper_c_l_i_8cpp_source.html#l00090">HandlePing()</a>, <a class="el" href="_klipper_c_l_i_8cpp_source.html#l00400">ProcessPacket()</a>, <a class="el" href="_klipper_c_l_i_8cpp_source.html#l00056">SendError()</a>, and <a class="el" href="_klipper_c_l_i_8cpp_source.html#l00073">SendOk()</a>.</p>

</div>
</div>
<a id="ad3e5a754ec9f201484a7aacea2f41961" name="ad3e5a754ec9f201484a7aacea2f41961"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad3e5a754ec9f201484a7aacea2f41961">&#9670;&#160;</a></span>packet_ready</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">volatile bool KlipperCLI::packet_ready = false</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel static">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="_klipper_c_l_i_8cpp_source.html#l00431">431</a> of file <a class="el" href="_klipper_c_l_i_8cpp_source.html">KlipperCLI.cpp</a>.</p>

<p class="reference">Referenced by <a class="el" href="_klipper_c_l_i_8cpp_source.html#l00467">FeedByte()</a>, and <a class="el" href="_klipper_c_l_i_8cpp_source.html#l00449">Run()</a>.</p>

</div>
</div>
<a id="a5340c0df3b2af2c3a791cc11f143bbf2" name="a5340c0df3b2af2c3a791cc11f143bbf2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5340c0df3b2af2c3a791cc11f143bbf2">&#9670;&#160;</a></span>rx_buffer</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">char KlipperCLI::rx_buffer[1024]</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel static">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="_klipper_c_l_i_8cpp_source.html#l00019">19</a> of file <a class="el" href="_klipper_c_l_i_8cpp_source.html">KlipperCLI.cpp</a>.</p>

<p class="reference">Referenced by <a class="el" href="_klipper_c_l_i_8cpp_source.html#l00467">FeedByte()</a>, and <a class="el" href="_klipper_c_l_i_8cpp_source.html#l00449">Run()</a>.</p>

</div>
</div>
<a id="a932aad58ea2cbdf8a45a6835825b21a2" name="a932aad58ea2cbdf8a45a6835825b21a2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a932aad58ea2cbdf8a45a6835825b21a2">&#9670;&#160;</a></span>rx_idx</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int KlipperCLI::rx_idx = 0</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel static">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="_klipper_c_l_i_8cpp_source.html#l00020">20</a> of file <a class="el" href="_klipper_c_l_i_8cpp_source.html">KlipperCLI.cpp</a>.</p>

<p class="reference">Referenced by <a class="el" href="_klipper_c_l_i_8cpp_source.html#l00467">FeedByte()</a>, and <a class="el" href="_klipper_c_l_i_8cpp_source.html#l00449">Run()</a>.</p>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<div id="page-nav" class="page-nav-panel">
<div id="page-nav-resize-handle"></div>
<div id="page-nav-tree">
<div id="page-nav-contents">
</div><!-- page-nav-contents -->
</div><!-- page-nav-tree -->
</div><!-- page-nav -->
</div><!-- container -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a href="namespace_klipper_c_l_i.html">KlipperCLI</a></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.15.0 </li>
  </ul>
</div>
</body>
</html>
